<!DOCTYPE html>
<html>
  <head>
    <title>SSE Test</title>
  </head>
  <body>
    <p id="message">
    </p>
    <script type="text/javascript">
      var source = new EventSource("/time");
      source.onopen = function(e)
      {
        document.getElementById("message").innerHTML = "open";
        console.log("open", e);
      }
      source.onmessage = function(e)
      {
        document.getElementById("message").innerHTML = e.data;
        console.log("message", e);
      }
      source.onerror = function(e)
      {
        document.getElementById("message").innerHTML = "error";
        console.log("error", e);
        if(source.readyState == EventSource.CLOSED)
        {
          document.getElementById("message").innerHTML = "closed";
          console.log("closed");
        }
      }
    </script>
  </body>
</html>
