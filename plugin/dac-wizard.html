<!-- DAC wizard template, modeled on the CCA wizard

S. Martin
4/6/2017

-->

<div class="modal-header">
    <button type="button" class="close" data-bind="click: cancel" data-dismiss="modal" aria-label="Close">
        <span aria-hidden="true">&times;</span>
    </button>
    <h3 class="modal-title">New Dial-A-Cluster Model</h3>
</div>

<!-- Organizes the tabs in the input wizard. -->
<div class="modal-body">
    <ul class="nav nav-pills">
        <li data-bind="css:{active:tab() == 0}" class="btn-secondary"><a>Data Format</a></li>
        <li data-bind="css:{active:tab() == 1}, visible: dac_format() == 'dac-gen'"><a>Upload Data</a></li>
        <li data-bind="css:{active:tab() == 2}, visible: dac_format() == 'pts'"><a>Upload Data</a></li>
        <li data-bind="css:{active:tab() == 3}, visible: dac_format() == 'pts'"><a>Process Data</a></li>
        <li data-bind="css:{active:tab() == 4}"><a>Select Metadata</a></li>
        <li data-bind="css:{active:tab() == 5}"><a>Select Variables</a></li>
        <li data-bind="css:{active:tab() == 6}"><a>Name Model</a></li>
    </ul>

    <!-- This tab lets the user select whether or not the file to upload is on the local
       computer or a remote computer. -->
    <div class="tab-content">
    <div data-bind="visible:tab() == 0">
        <div class="radio" style="margin-left: 15px;">
        <label>
            <input type="radio" name="local-or-remote-radios" id="local-radio" value="dac-gen" data-bind="checked: dac_format">
            Dial-A-Cluster Generic Format
        </label>
        </div>
        <div class="radio" style="margin-left: 15px;">
        <label>
            <input type="radio" name="local-or-remote-radios" id="remote-radio" value="pts" data-bind="checked: dac_format">
            PTS CSV/META Format
        </label>
        </div>
    </div>

    <!-- This tab loads data from the local host, in DAC Generic Format, using the slycat-parser-controls to
         load a dac-table type table. -->
    <div data-bind="visible:tab() == 1" class="form-horizontal">

        <div style="margin-top: 40px;">
        <label>Select .dac meta-data file:</label>
        <slycat-local-browser params="
            selection:browser_dac_file.selection,
            progress:browser_dac_file.progress,
            progress_status:browser_dac_file.progress_status"></slycat-local-browser>
        <slycat-parser-controls params="parser:parser_dac_file,category:'dac-index-file'"></slycat-parser-controls>
        </div>

        <div style="margin-top: 40px;">
        <label>Select all .var variable files (plus variables.meta file):</label>
        <slycat-local-browser params="
            selection:browser_var_files.selection,
            multiple:true,
            progress:browser_var_files.progress"></slycat-local-browser>
        <slycat-parser-controls params="parser:parser_var_files,category:'dac-var-files'"></slycat-parser-controls>
        </div>

        <div style="margin-top: 40px;">
        <label>Select all .time time point files:</label>
        <slycat-local-browser params="
            selection:browser_time_files.selection,
            multiple:true,
            progress:browser_time_files.progress"></slycat-local-browser>
        <slycat-parser-controls params="parser:parser_time_files,category:'dac-time-files'"></slycat-parser-controls>
        </div>

        <div style="margin-top: 40px;">
        <label>Select all .dist pairwise distance files:</label>
        <slycat-local-browser params="
            selection:browser_dist_files.selection,
            multiple:true,
            progress:browser_dist_files.progress"></slycat-local-browser>
        <slycat-parser-controls params="parser:parser_dist_files,category:'dac-dist-files'"></slycat-parser-controls>
        </div>

    </div>

    <!-- This tab is for loading the CSV/META files.  The slycat-parser-controls
         tag indicates which type of table to load, which in our case is 'dac-table' -->
    <div data-bind="visible:tab() == 2" class="form-horizontal">

        <div style="margin-top: 40px;">
        <label>Select all files in CSV directory:</label>
        <slycat-local-browser params="
            selection:browser_csv_files.selection,
            multiple:true,
            progress:browser_csv_files.progress"></slycat-local-browser>
        <slycat-parser-controls params="parser:parser_csv_files,category:'dac-csv-files'"></slycat-parser-controls>
        </div>

        <div style="margin-top: 40px;">
        <label>Select all files in META directory:</label>
        <slycat-local-browser params="
            selection:browser_meta_files.selection,
            multiple:true,
            progress:browser_meta_files.progress"></slycat-local-browser>
        <slycat-parser-controls params="parser:parser_meta_files,category:'dac-meta-files'"></slycat-parser-controls>
        </div>

    </div>

    <!-- This tab is for processing the CSV/META files, including minimum number of digitizers,
         and showing the error log. -->
    <div data-bind="visible:tab() == 3" class="form-horizontal">

        <div style="margin-top: 40px; margin-left:15px">
          <label>Minimum number of time points in a CSV file:</label>
          <input class="form-control" type="number" min="2" data-bind="value: csv_min_size">
        </div>

        <div style="margin-top: 40px; margin-left: 15px">
          <label>Minimum number of digitizers in a test:</label>
          <input class="form-control" type="number" min="2" data-bind="value: min_num_dig">
        </div>

        <div style="margin-top: 40px; margin-left: 15px">
          <label>Process Results:</label>
          <textarea class="form-control" rows="15" readonly id="dac-wizard-process-results">
          </textarea>
        </div>


    </div>

    <!-- The slycat-table-ingestion tag indicates what to name columns (name: ) and whether
         the columns are checkboxes (bool) or radio buttons (select).  Here we have one
         column include or not include in the meta-data table. -->
    <div data-bind="visible:tab() == 4">
        <slycat-table-ingestion params="
            variables: meta_attributes,
            properties: [{name: 'Include', type: 'bool'}]
        "></slycat-table-ingestion>
    </div>

    <!-- The slycat-table-ingestion tag indicates what to name columns (name: ) and whether
     the columns are checkboxes (bool) or radio buttons (select).  Here we have one
     column include or not include in the meta-data table. -->
    <div data-bind="visible:tab() == 5">
        <slycat-table-ingestion params="
            variables: var_attributes,
            properties: [{name: 'Include', type: 'bool'}]
        "></slycat-table-ingestion>
    </div>

    <!-- Inputs the name of the model (final tab). -->
    <div data-bind="visible:tab() == 6">
        <form class="form-horizontal" role="form" onsubmit="return false">
            <slycat-model-controls params="name:model.name,description:model.description,marking:model.marking"></slycat-model-controls>
        </form>
    </div>

    </div>
</div>

<!-- The following organizes the buttons at the bottom of the tabs and tells which javascript functions
     to call when the buttons are pressed. -->
<div class="modal-footer">
    <button class="btn btn-default pull-left" data-bind="visible: [0].indexOf(tab()) == -1, click: back">Back</button>
    <button class="btn btn-primary" data-bind="visible:tab() == 0,click:select_type">Continue</button>
    <button class="btn btn-primary dac-gen-browser-continue browser-continue"
            data-bind="visible:tab() == 1,click:upload_dac_format"><i class="fa fa-spinner fa-pulse"></i> Continue</button>
    <button class="btn btn-primary pts-browser-continue browser-continue"
            data-bind="visible:tab() == 2,click:upload_pts_format"><i class="fa fa-spinner fa-pulse"></i> Continue</button>
    <button class="btn btn-primary pts-browser-continue browser-continue"
            data-bind="visible:tab() == 3,click:process_pts_format"><i class="fa fa-spinner fa-pulse"></i> Process</button>
    <button class="btn btn-primary pts-browser-continue browser-continue"
            data-bind="visible:tab() == 3,click:process_pts_format"><i class="fa fa-spinner fa-pulse"></i> Continue</button>
    <button class="btn btn-primary" data-bind="visible:tab() == 4,click:include_variables">Continue</button>
    <button class="btn btn-primary" data-bind="visible:tab() == 5,click:finish">Continue</button>
    <button class="btn btn-primary" data-bind="visible:tab() == 6,click:name_model">Finish & Go To Model</button>
</div>
