{"version":3,"sources":["webpack:///./web-server/plugins/slycat-parameter-image-plus-model/js/ui.js","webpack:///./web-server/js/chunker.js","webpack:///./web-server/css/slycat-additions.css?c97b","webpack:///./web-server/css/slycat-additions.css","webpack:///./web-server/js/slycat-remotes.js","webpack:///./web-server/img/image-light.png","webpack:///./web-server/img/image-gray.png","webpack:///./web-server/img/y-light.png","webpack:///./web-server/img/y-gray.png","webpack:///./web-server/img/x-light.png","webpack:///./web-server/img/x-gray.png","webpack:///./web-server/templates/slycat-remote-login.html","webpack:///./web-server/js/slycat-login-controls.js","webpack:///./web-server/templates/slycat-login-controls.html","webpack:///./web-server/img/sort-dendrogram.png","webpack:///./web-server/img/sort-dendrogram-selected.png","webpack:///./web-server/js/slycat-job-checker.js","webpack:///./web-server/templates/slycat-job-checker.html","webpack:///./web-server/plugins/slycat-parameter-image-plus-model/css/ui.css?a8ad","webpack:///./web-server/plugins/slycat-parameter-image-plus-model/css/ui.css","webpack:///./web-server/plugins/slycat-parameter-image-plus-model/js/parameter-image-scatterplot.js","webpack:///./web-server/plugins/slycat-parameter-image-plus-model/img/pin.png","webpack:///./web-server/plugins/slycat-parameter-image-plus-model/js/parameter-controls.js","webpack:///./web-server/plugins/slycat-parameter-image-plus-model/js/parameter-image-dendrogram.js","webpack:///./web-server/plugins/slycat-parameter-image-plus-model/js/parameter-image-table.js","webpack:///./web-server/plugins/slycat-parameter-image-plus-model/js/color-switcher.js"],"names":["__webpack_require__","dialog","chunker","$","document","ready","model","default_image","model_id","_urijs2","default","window","location","segment","input_columns","output_columns","image_columns","rating_columns","category_columns","bookmarker","bookmark","clusters","cluster_index","clusters_data","table_metadata","table_statistics","indices","x_index","y_index","v_index","images_index","x","y","v","images","selected_simulations","hidden_simulations","colorscale","auto_scale","filtered_v","table_ready","scatterplot_ready","controls_ready","dendrogram_ready","cluster_ready","cache_references","createElement","login_dialog","autoOpen","width","height","modal","close","this","val","open","keypress","event","keyCode","parent","find","trigger","layout","north","size","resizable","center","west","resizeWhileDragging","onresize","dendrogram","south","css","table","scatterplot","ajax","type","url","api_root","success","result","bookmark_manager","create","project","_id","undefined","show_checkjob","text","contentType","Array","length","retrieve_current_cluster","setup_controls","setup_dendrogram","error","artifact_missing","metadata","max","min","load_table_statistics","d3","range","metadata_loaded","getState","state","colormap","colorswitcher","bind","update_current_colorscale","background-color","toString","gradient","updateState","selected_colormap_changed","setup_colorswitcher","model_loaded","request","status","reason_phrase","alert","jc","children","$jc","detach","remove","append","ko","dataFor","set_jid","title","message","build_dendrogram_node_options","dendrogram_options","cluster","collapsed_nodes","expanded_nodes","selected_nodes","highlight","cluster_data","setup_table","count","Int32Array","i","numeric_variables","indexOf","push","Number","get_model_array_attribute","mid","aid","array","attribute","setup_scatterplot","Float64Array","console","log","color_array","dendrogram_sort_order","parameters","node","skip_bookmarking","getNodeIndexes","selection","selected_node_changed","visible_simulations","pop","index","update_widgets_when_hidden_simulations_change","nodes","cluster_state","expanded","collapsed","expanded_collapsed_nodes_changed","node_toggled","controls","selected_simulations_changed","other_columns","inArray","table_options","statistics","inputs","outputs","others","ratings","categories","image-variable","x-variable","y-variable","row-selection","variable","order","sort-variable","sort-order","variable_sort_changed","x_selection_changed","y_selection_changed","temp","handle_color_variable_change","open_images","x_label","y_label","v_label","x_string","y_string","v_string","auto-scale","update_scatterplot_x","update_scatterplot_y","handle_image_variable_change","open-images-selection","open_images_changed","axes_variables","color_variables","color_variable","model_name","x_variables","y_variables","image_variables","rating_variables","category_variables","color-variable","args","value","hyperslices","data","blob","Blob","formdata","FormData","processData","results","update_v","jqXHR","textStatus","errorThrown","writeData","auto_scale_option_changed","splice","simulations_to_pin","indexName","node_indexes","node_index","update_widgets_after_color_variable_change","variable-selection","update_dendrogram","images-selection","images_selection_changed","cluster-index","cluster_selection_changed","skip_dendrogram_update","hidden-simulations","v_type","source","sort","ascending","filtered","apply","cloneArrayBuffer","filterValues","uniqueValues","set","values","simulation-selection","x-selection","y-selection","auto_scale_value","columns","callback","client","get_model_arrayset_metadata","join","is_little_endian","get_model_array_attribute_metadata","cast_array_buffer","dfd","Deferred","metadataSuccess","retrieve_model_array_attribute","ranges","isStringAttribute","attributes","byteorder","dimension","dimensions","begin","end","XMLHttpRequest","responseType","onload","e","buffer","response","JSON","parse","responseText","row_count","column_count","resolve","send","arrayset_metadata_cache","Uint32Array","Uint8Array","arrays","always","offset","Int16Array","Int8Array","Uint16Array","Float32Array","content","module","options","hmr","transform","insertInto","locals","exports","login","create_pool","remotes","pool","params","get_remotes","hostname","get_remote","check_remote","get_remote_params","sid","cancel","delete_remote","component","container","remote","enable","status_type","post_remotes","username","password","focus","observable","mapping","fromJS","extend","notify","parseHTML","template","appendTo","ispasswordrequired","on","applyBindings","get","components","register","viewModel","createViewModel","component_info","status_classes","pureComputed","classes","localStorage","getItem","subscribe","setItem","username_input","element","eq","password_input","setSelectionRange","keydown","which","activate","slycatLoginControls","vm","session_exists","jid","output","iid","previous_state","connect","removeAttr","checkjob","attr","cancel_pull","routine","get_checkjob","errors","s","repeated_state","clearInterval","reload","pullDataFromHpc","pullHPCData","get_model_command","command","setInterval","preventDefault","stopPropagation","delete_job","slycatJobChecker","escape","widget","pick_distance","drag_threshold","scale","linear","domain","border","filtered_indices","filtered_selection","filtered_x","filtered_y","scale_x","scale_y","scale_v","canvas_square_size","canvas_square_border_size","canvas_selected_square_size","canvas_selected_square_border_size","pinned_width","pinned_height","hover_time","image_cache","_create","self","login_open","_filterValues","hover_timer","close_hover_timer","hover_timer_canvas","opening_image","start_drag","current_drag","end_drag","svg","select","x_axis_layer","y_axis_layer","legend_layer","legend_axis_layer","datum_layer","selected_layer","canvas_datum","style","position","canvas_datum_layer","getContext","canvas_selected","canvas_selected_layer","selection_layer","image_layer","updates","update_timer","_schedule_update","update_indices","update_width","update_height","update_x","update_y","update_x_label","update_y_label","render_data","render_selection","render_legend","update_legend_colors","update_legend_position","update_legend_axis","update_v_label","call","behavior","drag","theElement","transx","transy","dx","dy","sourceEvent","mousedown","_offsetX","_offsetY","mousemove","target","nodeName","_schedule_hover_canvas","selectAll","Math","abs","mouseout","_cancel_hover_canvas","mouseup","ctrlKey","metaKey","x_coord","y_coord","x1","x2","y1","y2","x_scale","y_scale","_filterIndices","slice","_cloneArrayBuffer","_validateValue","selectionIndex","clone","_createScale","string","reverse","ordinal","rangePoints","_getDefaultXPosition","imageIndex","imageWidth","rangeLast","relx","parseInt","_getDefaultYPosition","imageHeight","target_y","isNaN","trim","_setOption","key","_close_hidden_simulations","update_leaders","update_color_scale_and_v","setTimeout","_update","total_width","total_height","width_offset","left","height_offset","top","range_canvas","x_scale_canvas","x_axis_offset","x_axis","axis","orient","y_axis_offset","y_scale_canvas","y_axis","inverse_indices","getBBox","canvas","n","square_size","half_border_width","border_width","fillHeight","fillWidth","strokeHeight","strokeWidth","time","Date","performance","start","now","clearRect","strokeStyle","lineWidth","color","fillStyle","cx","round","cy","fillRect","strokeRect","forEach","image","uri","image_class","rely","target_x","_open_images","each","frame","image_index","classed","stop","exit","enter","d","rectHeight","y_axis_layer_width","legend_scale","legend_axis","_sync_open_images","empty","leader","sourceEventTarget","clearTimeout","classList","contains","parentNode","_hover_timeout","image_url","URL","webkitURL","createObjectURL","resize_handle","newWidth","newHeight","theImage","theRectangle","theHandle","theLine","thePin","ratio","close_button","pin","no_sync","pathname","xhr","array_buffer_view","getResponseHeader","getAllResponseHeaders","hint","statusText","filter","_open_hover_canvas","shift","selected_square_size","selected_shift","_open_first_match","xvalues","yvalues","_open_hover","_schedule_hover","_cancel_hover","_close_hover","hover_width","hover_height","_is_hovering","hoverEmpty","circleEmpty","selectedCircleEmpty","pageX","currentTarget","getBoundingClientRect","scrollLeft","pageY","scrollTop","simulations","loop_index","x_select","change","y_select","images_label","images_select","color_label","color_select","selection_label","selection_select","selectedOption","label","variableLabel","variableIndex","openSetValueDialog","openClearValueDialog","selectedIndex","show_all_button","click","checked","auto_scale_label","csv_button","_write_data_table","txt","visibleRows","buttons","save_choice_buttons","openCSVSaveChoiceDialog","Apply","numeric","valueValid","Cancel","Clear","NaN","Save The Whole Table","Save Visible Rows","Save Selected Rows","_set_x_variables","_set_y_variables","_set_image_variables","_set_color_variables","_set_auto_scale","_set_selection_control","_set_show_all","selectionList","_stringify2","hyperchunks","_write_csv","_convert_to_csv","csvData","defaultFilename","D","a","href","encodeURIComponent","setAttribute","innerHTML","body","appendChild","createEvent","initMouseEvent","dispatchEvent","removeChild","sl","r","c","numRows","numCols","rowMajorOutput","prop","optgroup","scatterplotOptgroup","_set_selection","_set_selected_x","_set_selected_y","_set_selected_image","_set_selected_color","toggleClass","noneHidden","titleText","data_table_index_array","square_border_size","selected_square_border_size","hover_timeout","preview","_clear_hover_timer","_close_preview","preview_image","_set_cluster","linkage","input_indices","exemplars","subtrees","node-index","leaves","exemplar","selected","image-index","data-table-index","diagram_width","diagram_height","separation","sortControl","hasClass","_set_dendrogram_sort_order_state","vis","root","x0","y0","max_depth","depth","toggle","_children","select_node","_style_selected_nodes","_color_links","find_selected_nodes","path","context","select_subtree","_getNodeIndexes","update_subtree","duration","altKey","expandUpToLevel","level","node_enter","node_subtree","node_glyph","unselect_subtree","prune_tree","selected_state","child_selected_state","subtree","unselect_node","node_square","_handle_highlight","_set_highlight","node_update","transition","_open_preview","node_exit","link","links","insert","o","findExpandedAndCollapsedNodes","image_uri","target_image","hide","show","_display_image","immediate","close_preview","_set_color","selected_offset","trans","trans_selected","checkChildren","data_table_indexes","getDataTableIndexesFromChildren","concat","_set_hidden_simulations","update_selected_nodes","resize_canvas","value_formatter","replace","cell_formatter","row","cell","columnDef","dataContext","hcl","l","editable_cell_formatter","set_sort","column","get_indices","sorted_rows","grid","invalidate","trigger_row_selection","setSelectedRows","resetActiveCell","scrollRowToTop","make_column","column_index","header_class","cell_class","formatter","id","field","name","toolTip","sortable","headerCssClass","cssClass","header","tooltip","_data_provider","sort_column","sort_order","indexOfIndex","Slick","Grid","explicitInitialization","enableColumnReorder","editable","editCommandHandler","_editCommandHandler","onDataLoaded","from","to","invalidateRow","render","header_buttons","Plugins","HeaderButtons","onCommand","button","updateColumnHeader","getColumnIndex","registerPlugin","AutoTooltips","enableForHeaderCells","setSelectionModel","RowSelectionModel","onSelectedRowsChanged","rows","unsorted_rows","onHeaderClick","_array_equal","_color_variables","init","resizeCanvas","update_data","variables","getColumns","split","item","editCommand","execute","analysis_columns","ranked_indices","pages","pages_in_progress","page_size","Event","getLength","column_end","page","floor","page_begin","row_begin","row_end","j","getItemMetadata","cssClasses","direction","plain_array","b","not","color_maps","night","background","rgb","null_color","opacity","colors","day","rainbow","rainbow_day","addClass","html","getAttribute","removeClass","get_background","get_null_color","get_opacity","get_color_scale","domain_scale","get_color_map","get_color_scale_ordinal","tempOrdinal","tempColorscale","rgbRange","get_color_map_ordinal","get_gradient_data","setUpColorMapsForAllColumns","colorMap","columnMin","columnMax"],"mappings":"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","file":"ui_parameter_image_plus_module.js","sourcesContent":["/* Copyright (c) 2013, 2018 National Technology and Engineering Solutions of Sandia, LLC . Under the terms of Contract  DE-NA0003525 with National Technology and Engineering Solutions of Sandia, LLC, the U.S. Government  retains certain rights in this software. */\n\nimport jquery_ui_css from \"jquery-ui/themes/base/jquery-ui.css\";\nimport slick_grid_css from \"css/slickgrid/slick.grid.css\";\nimport slick_default_theme_css from \"css/slickgrid/slick-default-theme.css\";\nimport slick_headerbuttons_css from \"css/slickgrid/slick.headerbuttons.css\";\nimport slick_slycat_theme_css from \"css/slick-slycat-theme.css\";\nimport slycat_additions_css from \"css/slycat-additions.css\";\nimport ui_css from \"../css/ui.css\";\n\nimport api_root from \"js/slycat-api-root\";\nimport ko from \"knockout\";\nimport client from \"js/slycat-web-client\";\nimport bookmark_manager from \"js/slycat-bookmark-manager\";\nimport * as dialog from \"js/slycat-dialog\";\nimport d3 from \"js/d3.min\";\nimport URI from \"urijs\";\nimport * as chunker from \"js/chunker\";\n\nimport \"js/slycat-job-checker\";\nimport \"./parameter-image-scatterplot\";\nimport \"./parameter-controls\";\nimport \"./parameter-image-dendrogram\";\nimport \"./parameter-image-table\";\nimport \"./color-switcher\";\nimport \"jquery-ui\";\nimport \"js/jquery.layout-latest.min\";\nimport \"js/slycat-navbar\"\n\n// Wait for document ready\n$(document).ready(function() {\n\n  //////////////////////////////////////////////////////////////////////////////////////////\n  // Setup global variables.\n  //////////////////////////////////////////////////////////////////////////////////////////\n\n  var model = null;\n  var default_image = null;\n  var model_id = URI(window.location).segment(-1);\n  var input_columns = null;\n  var output_columns = null;\n  var image_columns = null;\n  var rating_columns = null;\n  var category_columns = null;\n\n  var bookmarker = null;\n  var bookmark = null;\n\n  var clusters = null; // This is just the list of cluster names\n  var cluster_index = null; // This is the index of the currently selected cluster\n  var clusters_data = null; // This holds data for each cluster\n\n  var table_metadata = null;\n  var table_statistics = null;\n  var indices = null;\n  var x_index = null;\n  var y_index = null;\n  var v_index = null;\n  var images_index = null;\n  var x = null;\n  var y = null;\n  var v = null;\n  var images = null;\n  var selected_simulations = null;\n  var hidden_simulations = null;\n  var colormap = null;\n  var colorscale = null;\n  var auto_scale = null;\n  var filtered_v = null;\n\n  var table_ready = false;\n  var scatterplot_ready = false;\n  var controls_ready = false;\n  var dendrogram_ready = false;\n  var cluster_ready = false;\n\n  var image_uri = document.createElement(\"a\");\n  var grid_pane = \"#parameter-image-plus-layout\";\n  // image_cache needs to be shared between dendrogram and scatterplot, thus it is passed inside an array to keep it in sync.\n  // http://api.jqueryui.com/jquery.widget/\n  // All options passed on init are deep-copied to ensure the objects can be modified later without affecting the widget.\n  // Arrays are the only exception, they are referenced as-is.\n  // This exception is in place to support data-binding, where the data source has to be kept as a reference.\n  var image_cache = {};\n  var cache_references = [ image_cache ];\n\n  var login_dialog = $(\"#remote-login-dialog\");\n\n  //////////////////////////////////////////////////////////////////////////////////////////\n  // Setup page layout.\n  //////////////////////////////////////////////////////////////////////////////////////////\n\n  login_dialog.dialog({\n    autoOpen: false,\n    width: 700,\n    height: 300,\n    modal: true,\n    close: function()\n    {\n      $(\"#remote-password\", this).val(\"\");\n    },\n    open: function()\n    {\n      // Neither of these work on the first instantiation of the dialog.\n      // $(\"#remote-username\", this).focus();\n      // setTimeout(function(){\n      //   $(\"#remote-username\").focus();\n      // },1);\n    },\n  });\n\n  // Enter key in password field triggers click on Login button\n  $(\"#remote-password\", login_dialog).keypress(function(event){\n    if(event.keyCode == 13)\n    {\n      $('.ui-dialog-buttonset', login_dialog.parent()).find('button:contains(Login)').trigger('click');\n    }\n  });\n\n  $(\"#parameter-image-plus-layout\").layout(\n  {\n    north:\n    {\n      size: 28,\n      resizable: false,\n    },\n    center:\n    {\n      // resizeWhileDragging: false,\n      // onresize: function() {\n      //   $(\"#scatterplot\").scatterplot(\"option\", {\n      //     width: $(\"#scatterplot-pane\").width(),\n      //     height: $(\"#scatterplot-pane\").height()\n      //   });\n      // },\n    },\n    west:\n    {\n      size: $(\"#parameter-image-plus-layout\").width() / 2,\n      resizeWhileDragging : false,\n      onresize: function()\n      {\n        $(\"#dendrogram-viewer\").dendrogram(\"resize_canvas\");\n      }\n    },\n    south:\n    {\n      size: $(\"#parameter-image-plus-layout\").height() / 4,\n      resizeWhileDragging: false,\n      onresize: function()\n      {\n        $(\"#table\").css(\"height\", $(\"#table-pane\").height());\n        $(\"#table\").table(\"resize_canvas\");\n      }\n    },\n  });\n\n  $(\"#model-pane\").layout(\n  {\n    center:\n    {\n      resizeWhileDragging: false,\n      onresize: function() {\n        $(\"#scatterplot\").scatterplot(\"option\", {\n          width: $(\"#scatterplot-pane\").width(),\n          height: $(\"#scatterplot-pane\").height()\n        });\n      },\n    }\n  });\n\n  //////////////////////////////////////////////////////////////////////////////////////////\n  // Load the model\n  //////////////////////////////////////////////////////////////////////////////////////////\n\n  $.ajax(\n  {\n    type : \"GET\",\n    url : api_root + \"models/\" + model_id,\n    success : function(result)\n    {\n      model = result;\n      bookmarker = bookmark_manager.create(model.project, model._id);\n      input_columns = model[\"artifact:input-columns\"];\n      output_columns = model[\"artifact:output-columns\"];\n      image_columns = model[\"artifact:image-columns\"];\n      rating_columns = model[\"artifact:rating-columns\"] == undefined ? [] : model[\"artifact:rating-columns\"];\n      category_columns = model[\"artifact:category-columns\"] == undefined ? [] : model[\"artifact:category-columns\"];\n      default_image = model[\"artifact:default-image\"];\n\n      if (default_image === null || default_image === undefined)\n        default_image = 0;\n\n      model_loaded();\n    },\n    error: function(request, status, reason_phrase)\n    {\n      window.alert(\"Error retrieving model: \" + reason_phrase);\n    }\n  });\n\n  //////////////////////////////////////////////////////////////////////////////////////////\n  // Once the model has been loaded, retrieve metadata / bookmarked state\n  //////////////////////////////////////////////////////////////////////////////////////////\n\n  var show_checkjob = function() {\n    var jc = $('#parameter-image-plus-layout').children()[0];\n    var $jc = $(jc);\n    $jc.detach();\n\n    $($('#parameter-image-plus-layout').children()).remove();\n    $('#parameter-image-plus-layout').append($jc);\n\n    var vm = ko.dataFor($('.slycat-job-checker')[0]);\n    vm.set_jid(model['artifact:jid']);\n  };\n\n  function model_loaded()\n  {\n    // If the model isn't ready or failed, we're done.\n    if(model[\"state\"] == \"waiting\" || model[\"state\"] == \"running\") {\n      show_checkjob();\n      return;\n    }\n    if(model[\"state\"] == \"closed\" && model[\"result\"] === null)\n      return;\n    if(model[\"result\"] == \"failed\")\n      return;\n\n    // Display progress as the load happens ...\n    $(\".load-status\").text(\"Loading data.\");\n\n    // Load list of clusters.\n    $.ajax({\n      url : api_root + \"models/\" + model_id + \"/files/clusters\",\n      contentType : \"application/json\",\n      success: function(result) {\n        clusters = result;\n        clusters_data = new Array(clusters.length);\n        retrieve_current_cluster();\n        setup_controls();\n        setup_dendrogram();\n      },\n      error: artifact_missing\n    });\n\n    // Load data table metadata.\n    $.ajax({\n      url : api_root + \"models/\" + model_id + \"/tables/data-table/arrays/0/metadata?index=Index\",\n      contentType : \"application/json\",\n      success: function(metadata) {\n        table_metadata = metadata;\n        table_statistics = new Array(metadata[\"column-count\"]);\n        table_statistics[metadata[\"column-count\"]-1] = {\"max\": metadata[\"row-count\"]-1, \"min\": 0};\n        load_table_statistics(d3.range(metadata[\"column-count\"]-1), metadata_loaded);\n      },\n      error: artifact_missing\n    });\n\n    // Retrieve bookmarked state information ...\n    bookmarker.getState(function(state)\n    {\n      bookmark = state;\n      cluster_index = bookmark[\"cluster-index\"] !== undefined ? bookmark[\"cluster-index\"] : 0;\n      retrieve_current_cluster();\n      setup_controls();\n      setup_colorswitcher();\n      metadata_loaded();\n    });\n  }\n\n  function artifact_missing()\n  {\n    $(\".load-status\").css(\"display\", \"none\");\n\n    dialog.dialog(\n    {\n      title: \"Load Error\",\n      message: \"Oops, there was a problem retrieving data from the model. This likely means that there was a problem during computation.\",\n    });\n  }\n\n  //////////////////////////////////////////////////////////////////////////////////////////\n  // Setup the rest of the UI as data is received.\n  //////////////////////////////////////////////////////////////////////////////////////////\n\n  function build_dendrogram_node_options(cluster_index)\n  {\n    var dendrogram_options = {\n      cluster: cluster_index,\n    };\n\n    dendrogram_options.collapsed_nodes = bookmark[cluster_index  + \"-collapsed-nodes\"];\n    dendrogram_options.expanded_nodes = bookmark[cluster_index  + \"-expanded-nodes\"];\n    dendrogram_options.selected_nodes = bookmark[cluster_index  + \"-selected-nodes\"];\n    dendrogram_options.highlight = bookmark[cluster_index  + \"-selected-row-simulations\"];\n\n    return dendrogram_options;\n  }\n\n  function retrieve_current_cluster()\n  {\n    if(!cluster_ready && cluster_index != null && clusters != null)\n    {\n      cluster_ready = true;\n\n      $.ajax(\n      {\n        url : api_root + \"models/\" + model_id + \"/files/cluster-\" + clusters[cluster_index],\n        contentType : \"application/json\",\n        success : function(cluster_data)\n        {\n          clusters_data[cluster_index] = cluster_data;\n          setup_dendrogram();\n        },\n        error: artifact_missing\n      });\n    }\n  }\n\n  function setup_colorswitcher()\n  {\n    var colormap = bookmark[\"colormap\"] !== undefined ? bookmark[\"colormap\"] : \"night\";\n\n    $(\"#color-switcher\").colorswitcher({colormap:colormap});\n\n    $(\"#color-switcher\").bind(\"colormap-changed\", function(event, colormap)\n    {\n      selected_colormap_changed(colormap);\n    });\n  }\n\n  function metadata_loaded()\n  {\n    setup_table();\n\n    if(!indices && table_metadata)\n    {\n      var count = table_metadata[\"row-count\"];\n      indices = new Int32Array(count);\n      for(var i = 0; i != count; ++i)\n        indices[i] = i;\n    }\n\n    setup_controls();\n\n    if(table_metadata && bookmark)\n    {\n      // Choose some columns for the X and Y axes.\n      var numeric_variables = [];\n      for(var i = 0; i < table_metadata[\"column-count\"]-1; i++)\n      {\n        // Only use non-string columns that are not used for ratings or categories\n        if(table_metadata[\"column-types\"][i] != 'string' && rating_columns.indexOf(i) == -1 && category_columns.indexOf(i) == -1)\n          numeric_variables.push(i);\n      }\n\n      x_index = numeric_variables[0];\n      y_index = numeric_variables[1 % numeric_variables.length];\n      if(\"x-selection\" in bookmark)\n        x_index = Number(bookmark[\"x-selection\"]);\n      if(\"y-selection\" in bookmark)\n        y_index = Number(bookmark[\"y-selection\"]);\n      auto_scale = true;\n      if(\"auto-scale\" in bookmark)\n      {\n        auto_scale = bookmark[\"auto-scale\"];\n      }\n\n      // Set state of selected and hidden simulations\n      selected_simulations = [];\n      if(\"simulation-selection\" in bookmark)\n        selected_simulations = bookmark[\"simulation-selection\"];\n      hidden_simulations = [];\n      if(\"hidden-simulations\" in bookmark)\n        hidden_simulations = bookmark[\"hidden-simulations\"];\n\n      chunker.get_model_array_attribute({\n        api_root : api_root,\n        mid : model_id,\n        aid : \"data-table\",\n        array : 0,\n        attribute : x_index,\n        success : function(result)\n        {\n          x = result;\n          if(table_metadata[\"column-types\"][x_index]==\"string\")\n          {\n            x = x[0];\n          }\n          setup_scatterplot();\n          setup_table();\n        },\n        error : artifact_missing\n      });\n\n      chunker.get_model_array_attribute({\n        api_root : api_root,\n        mid : model_id,\n        aid : \"data-table\",\n        array : 0,\n        attribute : y_index,\n        success : function(result)\n        {\n          y = result;\n          if(table_metadata[\"column-types\"][y_index]==\"string\")\n          {\n            y = y[0];\n          }\n          setup_scatterplot();\n          setup_table();\n        },\n        error : artifact_missing\n      });\n\n      v_index = table_metadata[\"column-count\"] - 1;\n      if(\"variable-selection\" in bookmark)\n        v_index = Number(bookmark[\"variable-selection\"]);\n\n      if(v_index == table_metadata[\"column-count\"] - 1)\n      {\n        var count = table_metadata[\"row-count\"];\n        v = new Float64Array(count);\n        for(var i = 0; i != count; ++i)\n          v[i] = i;\n        update_current_colorscale();\n        setup_scatterplot();\n        setup_table();\n        setup_dendrogram();\n      }\n      else\n      {\n        chunker.get_model_array_attribute({\n          api_root : api_root,\n          mid : model_id,\n          aid : \"data-table\",\n          array : 0,\n          attribute : v_index,\n          success : function(result)\n          {\n            v = result;\n            if(table_metadata[\"column-types\"][v_index]==\"string\")\n            {\n              v = v[0];\n            }\n            update_current_colorscale();\n            setup_scatterplot();\n            setup_table();\n            setup_dendrogram();\n          },\n          error : artifact_missing\n        });\n      }\n\n      images_index = image_columns[default_image];\n      if(\"images-selection\" in bookmark)\n        images_index = bookmark[\"images-selection\"];\n      setup_table();\n      if(image_columns.length > 0)\n      {\n        $.ajax(\n        {\n          type : \"GET\",\n          url : api_root + \"models/\" + model_id + \"/arraysets/data-table/data?hyperchunks=0/\" + images_index + \"/0:\" + table_metadata[\"row-count\"],\n          success : function(result)\n          {\n            images = result[0];\n            setup_scatterplot();\n            setup_dendrogram();\n            //setup_table();\n          },\n          error: artifact_missing\n        });\n      }\n      else\n      {\n        images = undefined;\n        setup_scatterplot();\n        setup_dendrogram();\n      }\n      setup_controls();\n    }\n  }\n\n  function setup_dendrogram()\n  {\n    if(!dendrogram_ready && bookmark && clusters != null && cluster_index != null && clusters_data != null\n      && clusters_data[cluster_index] !== undefined && colorscale && v && selected_simulations != null\n      && images !== null\n      )\n    {\n      dendrogram_ready = true;\n      console.log(\"dendrogram ready to be initiated.\");\n\n      $(\"#dendrogram-pane .load-status\").css(\"display\", \"none\");\n\n      $(\"#dendrogram-leaf-backdrop\").css({\n        \"background-color\" : $(\"#color-switcher\").colorswitcher(\"get_background\").toString(),\n      });\n\n      var dendrogram_options = build_dendrogram_node_options(cluster_index);\n      dendrogram_options.clusters = clusters;\n      dendrogram_options.cluster_data = clusters_data[cluster_index];\n      dendrogram_options.colorscale = colorscale;\n      dendrogram_options.color_array = v;\n      dendrogram_options.images = images;\n      dendrogram_options.cache_references = cache_references;\n      dendrogram_options.login_dialog = login_dialog;\n\n      if(bookmark[\"sort-variable\"] != undefined) {\n        dendrogram_options.dendrogram_sort_order = false;\n      }\n\n      dendrogram_options[\"highlight\"] = selected_simulations;\n\n      $(\"#dendrogram-viewer\").dendrogram(dendrogram_options);\n\n      // Log and bookmark changes to the node selection ...\n      $(\"#dendrogram-viewer\").bind(\"node-selection-changed\", function(event, parameters)\n      {\n        selected_node_changed(parameters);\n      });\n\n      // Changing the selected dendrogram node updates the waveform plot ...\n      $(\"#dendrogram-viewer\").bind(\"node-selection-changed\", function(event, parameters)\n      {\n        // Only want to update the waveform plot if the user changed the selected node. It's automatically set at dendrogram creation time, and we want to avoid updating the waveform plot at that time.\n        if(parameters.skip_bookmarking != true) {\n          // $(\"#waveform-viewer\").waveformplot(\"option\", \"selection\", getWaveformIndexes(parameters.selection));\n\n          // if(bookmark[$(\"#cluster-viewer\").cluster(\"option\", \"cluster\") + \"-selected-row-simulations\"] !== undefined)\n          //   $(\"#waveform-viewer\").waveformplot(\"option\", \"highlight\", bookmark[$(\"#cluster-viewer\").cluster(\"option\", \"cluster\") + \"-selected-row-simulations\"]);\n\n          var visible_simulations = getNodeIndexes(parameters.selection, \"image-index\");\n\n          while(hidden_simulations.length > 0) {\n            hidden_simulations.pop();\n          }\n\n          for(var i = 0; i < indices.length; i++)\n          {\n            var index = indices[i];\n            if(visible_simulations.indexOf(index) < 0)\n            {\n              hidden_simulations.push(index);\n            }\n          }\n          update_widgets_when_hidden_simulations_change(true);\n        }\n      });\n\n      // Bookmark changes to expanded and collapsed nodes ...\n      $(\"#dendrogram-viewer\").bind(\"expanded-collapsed-nodes-changed\", function(event, nodes)\n      {\n        expanded_collapsed_nodes_changed(nodes);\n      });\n\n      // Log changes to node toggle ...\n      $(\"#dendrogram-viewer\").bind(\"node-toggled\", function(event, node)\n      {\n        node_toggled(node);\n      });\n\n      // Changing the scatterplot selection updates the table row selection and controls ..\n      $(\"#dendrogram-viewer\").bind(\"selection-changed\", function(event, selection)\n      {\n        $(\"#table\").table(\"option\", \"row-selection\", selection);\n        $(\"#controls\").controls(\"option\", \"selection\", selection);\n        $(\"#scatterplot\").scatterplot(\"option\", \"selection\", selection);\n        selected_simulations_changed(selection);\n      });\n    }\n  }\n\n  function setup_table()\n  {\n    if( !table_ready && table_metadata && (table_statistics.length == table_metadata[\"column-count\"]) && colorscale\n      && bookmark && (x_index != null) && (y_index != null) && (images_index !== null)\n      && (selected_simulations != null) && (hidden_simulations != null) )\n    {\n      table_ready = true;\n\n      $(\"#table-pane .load-status\").css(\"display\", \"none\");\n\n      var other_columns = [];\n      for(var i = 0; i != table_metadata[\"column-count\"] - 1; ++i)\n      {\n        if($.inArray(i, input_columns) == -1 && $.inArray(i, output_columns) == -1\n          && $.inArray(i, rating_columns) == -1 && $.inArray(i, category_columns) == -1)\n          other_columns.push(i);\n      }\n\n      var table_options =\n      {\n        api_root : api_root,\n        mid : model_id,\n        aid : \"data-table\",\n        metadata : table_metadata,\n        statistics : table_statistics,\n        inputs : input_columns,\n        outputs : output_columns,\n        others : other_columns,\n        images : image_columns,\n        ratings : rating_columns,\n        categories : category_columns,\n        \"image-variable\" : images_index,\n        \"x-variable\" : x_index,\n        \"y-variable\" : y_index,\n        \"row-selection\" : selected_simulations,\n        hidden_simulations : hidden_simulations,\n      };\n\n      var colormap = bookmark[\"colormap\"] !== undefined ? bookmark[\"colormap\"] : \"night\";\n      table_options.colorscale = colorscale;\n\n      if(\"sort-variable\" in bookmark && \"sort-order\" in bookmark)\n      {\n        table_options[\"sort-variable\"] = bookmark[\"sort-variable\"];\n        table_options[\"sort-order\"] = bookmark[\"sort-order\"];\n      }\n\n      if(\"variable-selection\" in bookmark)\n      {\n        table_options[\"variable-selection\"] = [bookmark[\"variable-selection\"]];\n      }\n      else\n      {\n        table_options[\"variable-selection\"] = [table_metadata[\"column-count\"] - 1];\n      }\n\n      $(\"#table\").table(table_options);\n\n      // Log changes to the table sort order ...\n      $(\"#table\").bind(\"variable-sort-changed\", function(event, variable, order)\n      {\n        variable_sort_changed(variable, order);\n      });\n\n      // Log changes to the x variable ...\n      $(\"#table\").bind(\"x-selection-changed\", function(event, variable)\n      {\n        x_selection_changed(variable);\n      });\n\n      // Log changes to the y variable ...\n      $(\"#table\").bind(\"y-selection-changed\", function(event, variable)\n      {\n        y_selection_changed(variable);\n      });\n\n      // Changing the table row selection updates the scatterplot and controls ...\n      // Log changes to the table row selection ...\n      $(\"#table\").bind(\"row-selection-changed\", function(event, selection)\n      {\n        // The table selection is an array buffer which can't be\n        // serialized as JSON, so convert it to an array.\n        var temp = [];\n        for(var i = 0; i != selection.length; ++i)\n          temp.push(selection[i]);\n\n        selected_simulations_changed(temp);\n        $(\"#scatterplot\").scatterplot(\"option\", \"selection\",  temp);\n        $(\"#controls\").controls(\"option\", \"selection\",  temp);\n        $(\"#dendrogram-viewer\").dendrogram(\"option\", \"highlight\", temp);\n      });\n\n      // Changing the scatterplot selection updates the table row selection and controls ..\n      $(\"#scatterplot\").bind(\"selection-changed\", function(event, selection)\n      {\n        $(\"#table\").table(\"option\", \"row-selection\", selection);\n        $(\"#controls\").controls(\"option\", \"selection\", selection);\n        $(\"#dendrogram-viewer\").dendrogram(\"option\", \"highlight\", selection);\n      });\n\n      // Changing the x variable updates the table ...\n      $(\"#controls\").bind(\"x-selection-changed\", function(event, variable)\n      {\n        $(\"#table\").table(\"option\", \"x-variable\", variable);\n      });\n\n      // Changing the y variable updates the table ...\n      $(\"#controls\").bind(\"y-selection-changed\", function(event, variable)\n      {\n        $(\"#table\").table(\"option\", \"y-variable\", variable);\n      });\n\n      // Changing the image variable updates the table ...\n      $(\"#controls\").bind(\"images-selection-changed\", function(event, variable)\n      {\n        $(\"#table\").table(\"option\", \"image-variable\", variable);\n      });\n\n      // Handle table variable selection ...\n      $(\"#table\").bind(\"variable-selection-changed\", function(event, selection)\n      {\n        // Changing the table variable updates the controls ...\n        $(\"#controls\").controls(\"option\", \"color-variable\", selection[0]);\n\n        // Handle changes to the table variable selection ...\n        handle_color_variable_change(selection[0]);\n      });\n\n      // Handle color variable selection ...\n      $(\"#controls\").bind(\"color-selection-changed\", function(event, variable)\n      {\n        // Changing the color variable updates the table ...\n        $(\"#table\").table(\"option\", \"variable-selection\", [Number(variable)]);\n\n        // Handle changes to the color variable ...\n        handle_color_variable_change(variable);\n      });\n    }\n  }\n\n  function setup_scatterplot()\n  {\n    // Setup the scatterplot ...\n    if(!scatterplot_ready && bookmark && indices && x && y && v && images !== null && colorscale\n      && (selected_simulations != null) && (hidden_simulations != null) && auto_scale != null\n      )\n    {\n      scatterplot_ready = true;\n\n      $(\"#scatterplot-pane .load-status\").css(\"display\", \"none\");\n\n      var colormap = bookmark[\"colormap\"] !== undefined ? bookmark[\"colormap\"] : \"night\";\n\n      $(\"#scatterplot-pane\").css(\"background\", $(\"#color-switcher\").colorswitcher(\"get_background\", colormap).toString());\n\n      var open_images = [];\n      if(\"open-images-selection\" in bookmark)\n      {\n        open_images = bookmark[\"open-images-selection\"];\n      }\n\n      $(\"#scatterplot\").scatterplot({\n        indices: indices,\n        x_label: table_metadata[\"column-names\"][x_index],\n        y_label: table_metadata[\"column-names\"][y_index],\n        v_label: table_metadata[\"column-names\"][v_index],\n        x: x,\n        y: y,\n        v: v,\n        x_string: table_metadata[\"column-types\"][x_index]==\"string\",\n        y_string: table_metadata[\"column-types\"][y_index]==\"string\",\n        v_string: table_metadata[\"column-types\"][v_index]==\"string\",\n        images: images,\n        width: $(\"#scatterplot-pane\").width(),\n        height: $(\"#scatterplot-pane\").height(),\n        colorscale: colorscale,\n        selection: selected_simulations,\n        open_images: open_images,\n        gradient: $(\"#color-switcher\").colorswitcher(\"get_gradient_data\", colormap),\n        hidden_simulations: hidden_simulations,\n        \"auto-scale\" : auto_scale,\n        cache_references : cache_references,\n        login_dialog : login_dialog,\n        });\n\n      $(\"#scatterplot\").bind(\"selection-changed\", function(event, selection)\n      {\n        selected_simulations_changed(selection);\n      });\n\n      // Changing the x variable updates the scatterplot ...\n      $(\"#table\").bind(\"x-selection-changed\", function(event, variable)\n      {\n        update_scatterplot_x(variable);\n      });\n      $(\"#controls\").bind(\"x-selection-changed\", function(event, variable)\n      {\n        update_scatterplot_x(variable);\n      });\n\n      // Changing the y variable updates the scatterplot ...\n      $(\"#table\").bind(\"y-selection-changed\", function(event, variable)\n      {\n        update_scatterplot_y(variable);\n      });\n      $(\"#controls\").bind(\"y-selection-changed\", function(event, variable)\n      {\n        update_scatterplot_y(variable);\n      });\n\n      // Changing the images variable updates the scatterplot ...\n      $(\"#table\").bind(\"images-selection-changed\", function(event, variable)\n      {\n        handle_image_variable_change(variable);\n      });\n      $(\"#controls\").bind(\"images-selection-changed\", function(event, variable)\n      {\n        handle_image_variable_change(variable);\n      });\n\n      // Log changes to open images ...\n      $(\"#scatterplot\").bind(\"open-images-changed\", function(event, selection)\n      {\n        open_images_changed(selection);\n      });\n    }\n  }\n\n  function setup_controls()\n  {\n    if( !controls_ready && table_metadata && (image_columns !== null) && (rating_columns != null)\n      && (category_columns != null) && (x_index != null) && (y_index != null) && auto_scale != null\n      && (images_index !== null) && (selected_simulations != null) && (hidden_simulations != null)\n      && indices\n      // && (cluster_index != null) && (clusters != null)\n      )\n    {\n      controls_ready = true;\n      var numeric_variables = [];\n      var axes_variables = [];\n      var color_variables = [];\n\n      for(var i = 0; i < table_metadata[\"column-count\"]; i++)\n      {\n        if(table_metadata[\"column-types\"][i] != 'string')\n        {\n          numeric_variables.push(i);\n        }\n        if( image_columns.indexOf(i) == -1 && table_metadata[\"column-count\"]-1 > i )\n        {\n          axes_variables.push(i);\n        }\n        if( image_columns.indexOf(i) == -1 )\n        {\n          color_variables.push(i);\n        }\n      }\n\n      var color_variable = table_metadata[\"column-count\"] - 1;\n      if(\"variable-selection\" in bookmark)\n      {\n        color_variable = [bookmark[\"variable-selection\"]];\n      }\n\n      $(\"#controls\").controls({\n        mid : model_id,\n        model_name: window.model_name,\n        aid : \"data-table\",\n        metadata: table_metadata,\n        // clusters : clusters,\n        x_variables: axes_variables,\n        y_variables: axes_variables,\n        image_variables: image_columns,\n        color_variables: color_variables,\n        rating_variables : rating_columns,\n        category_variables : category_columns,\n        selection : selected_simulations,\n        // cluster_index : cluster_index,\n        \"x-variable\" : x_index,\n        \"y-variable\" : y_index,\n        \"image-variable\" : images_index,\n        \"color-variable\" : color_variable,\n        \"auto-scale\" : auto_scale,\n        hidden_simulations : hidden_simulations,\n        indices : indices,\n      });\n\n      // Changing the x variable updates the controls ...\n      $(\"#table\").bind(\"x-selection-changed\", function(event, variable)\n      {\n        $(\"#controls\").controls(\"option\", \"x-variable\", variable);\n      });\n\n      // Changing the y variable updates the controls ...\n      $(\"#table\").bind(\"y-selection-changed\", function(event, variable)\n      {\n        $(\"#controls\").controls(\"option\", \"y-variable\", variable);\n      });\n\n      // Changing the image variable updates the controls ...\n      $(\"#table\").bind(\"images-selection-changed\", function(event, variable)\n      {\n        $(\"#controls\").controls(\"option\", \"image-variable\", variable);\n      });\n\n      // Changing the value of a variable updates the database, table, and scatterplot ...\n      $(\"#controls\").bind(\"set-value\", function(event, args)\n      {\n        writeData(args.selection, args.variable, args.value);\n        function writeData(selection, variable, value)\n        {\n          var hyperslices = \"\";\n          var data = \"[\";\n          for(var i=0; i<selection.length; i++)\n          {\n            if(i>0)\n            {\n              hyperslices += \"|\";\n              data += \",\";\n            }\n            hyperslices += selection[i];\n            data += \"[\" + value + \"]\";\n          }\n          data += \"]\";\n          var blob = new Blob([data], {type: \"text/html\"});\n          var formdata = new FormData();\n          formdata.append(\"data\", blob);\n          formdata.append(\"hyperchunks\", 0 + \"/\" + variable + \"/\" + hyperslices);\n\n          $.ajax({\n            type: \"PUT\",\n            url : api_root + \"models/\" + model_id + \"/arraysets/data-table/data\",\n            data : formdata,\n            processData: false,\n            contentType: false,\n            success : function(results)\n            {\n              $(\"#table\").table(\"update_data\");\n\n              if(variable == x_index)\n                update_scatterplot_x(variable);\n              if(variable == y_index)\n                update_scatterplot_y(variable);\n\n              load_table_statistics([variable], function(){\n                $(\"#table\").table(\"option\", \"statistics\", table_statistics);\n                if(variable == v_index)\n                {\n                  update_v(variable);\n                }\n              });\n            },\n            error : function(jqXHR, textStatus, errorThrown)\n            {\n              console.log(\"writing array data error\");\n            },\n          });\n        }\n      });\n\n      // Log changes to the cluster variable ...\n      // $(\"#controls\").bind(\"cluster-selection-changed\", function(event, variable)\n      // {\n      //   variable = parseInt(variable);\n      //   cluster_selection_changed(variable);\n      //   update_dendrogram(variable);\n      // });\n\n      // Log changes to the x variable ...\n      $(\"#controls\").bind(\"x-selection-changed\", function(event, variable)\n      {\n        x_selection_changed(variable);\n      });\n\n      // Log changes to the y variable ...\n      $(\"#controls\").bind(\"y-selection-changed\", function(event, variable)\n      {\n        y_selection_changed(variable);\n      });\n\n      // Changing the auto scale option updates the scatterplot and logs it ...\n      $(\"#controls\").bind(\"auto-scale\", function(event, auto_scale)\n      {\n        auto_scale_option_changed(auto_scale);\n      });\n\n      // Log changes to hidden selection ...\n      $(\"#controls\").bind(\"hide-selection\", function(event, selection)\n      {\n        for(var i=0; i<selected_simulations.length; i++){\n          if($.inArray(selected_simulations[i], hidden_simulations) == -1) {\n            hidden_simulations.push(selected_simulations[i]);\n          }\n        }\n        update_widgets_when_hidden_simulations_change();\n      });\n\n      // Log changes to hidden selection ...\n      $(\"#controls\").bind(\"show-selection\", function(event, selection)\n      {\n        for(var i=0; i<selected_simulations.length; i++){\n          var index = $.inArray(selected_simulations[i], hidden_simulations);\n          if(index != -1) {\n            hidden_simulations.splice(index, 1);\n          }\n        }\n        update_widgets_when_hidden_simulations_change();\n      });\n\n      // Log changes to hidden selection ...\n      $(\"#controls\").bind(\"pin-selection\", function(event, selection)\n      {\n        // Removing any hidden simulations from those that will be pinned\n        var simulations_to_pin = [];\n        for(var i=0; i<selected_simulations.length; i++){\n          var index = $.inArray(selected_simulations[i], hidden_simulations);\n          if(index == -1) {\n            simulations_to_pin.push(selected_simulations[i]);\n          }\n        }\n        $(\"#scatterplot\").scatterplot(\"pin\", simulations_to_pin);\n      });\n\n      // Log changes to hidden selection ...\n      $(\"#controls\").bind(\"show-all\", function(event, selection)\n      {\n        while(hidden_simulations.length > 0) {\n          hidden_simulations.pop();\n        }\n        update_widgets_when_hidden_simulations_change();\n      });\n    }\n  }\n\n  //////////////////////////////////////////////////////////////////////////////////////////\n  // Event handlers.\n  //////////////////////////////////////////////////////////////////////////////////////////\n\n  function selected_node_changed(parameters)\n  {\n    if(parameters.node != null && parameters.node[\"node-index\"] != null)\n    {\n      $.ajax(\n      {\n        type : \"POST\",\n        url : api_root + \"events/models/\" + model_id + \"/select/node/\" + parameters.node[\"node-index\"]\n      });\n    }\n    if(parameters.skip_bookmarking != true)\n    {\n      var state = {};\n      state[ cluster_index + \"-selected-nodes\" ] = getNodeIndexes(parameters.selection, \"node-index\");\n      state[ cluster_index + \"-selected-image-indexes\" ] = getNodeIndexes(parameters.selection, \"image-index\");\n      bookmarker.updateState(state);\n    }\n  }\n\n  function getNodeIndexes(nodes, indexName)\n  {\n    var node_indexes = [];\n    var node_index = null;\n\n    for(var i=0; i<nodes.length; i++)\n    {\n      node_index = nodes[i][indexName];\n      if(node_index != null)\n        node_indexes.push(node_index);\n    }\n\n    return node_indexes;\n  }\n\n  function expanded_collapsed_nodes_changed(nodes){\n    var cluster_state = {};\n    cluster_state[ cluster_index + \"-expanded-nodes\"] = nodes.expanded;\n    cluster_state[ cluster_index + \"-collapsed-nodes\"] = nodes.collapsed;\n    bookmarker.updateState(cluster_state);\n  }\n\n  function node_toggled(node){\n    $.ajax(\n    {\n      type : \"POST\",\n      url : api_root + \"events/models/\" + model_id + \"/toggle/node/\" + node[\"node-index\"],\n    });\n  }\n\n  function selected_colormap_changed(colormap)\n  {\n    update_current_colorscale();\n\n    // Changing the color map updates the dendrogram with a new color scale and new backdrop ...\n    $(\"#dendrogram-viewer\").dendrogram(\"option\", \"colorscale\", colorscale);\n    $(\"#dendrogram-leaf-backdrop\").css({\n      \"background-color\" : $(\"#color-switcher\").colorswitcher(\"get_background\").toString(),\n    });\n\n    // Changing the color map updates the table with a new color scale ...\n    $(\"#table\").table(\"option\", \"colorscale\", colorscale);\n\n    // Changing the color scale updates the scatterplot ...\n    $(\"#scatterplot-pane\").css(\"background\", $(\"#color-switcher\").colorswitcher(\"get_background\", colormap).toString());\n    $(\"#scatterplot\").scatterplot(\"option\", {\n      colorscale:    colorscale,\n      gradient: $(\"#color-switcher\").colorswitcher(\"get_gradient_data\", colormap),\n    });\n\n    $.ajax(\n    {\n      type : \"POST\",\n      url : api_root + \"events/models/\" + model_id + \"/select/colormap/\" + colormap\n    });\n\n    bookmarker.updateState({\"colormap\" : colormap});\n  }\n\n  function handle_color_variable_change(variable)\n  {\n    v_index = Number(variable);\n\n    if(v_index == table_metadata[\"column-count\"] - 1)\n    {\n      var count = table_metadata[\"row-count\"];\n      for(var i = 0; i != count; ++i)\n        v[i] = i;\n      update_widgets_after_color_variable_change();\n    }\n    else\n    {\n      update_v(variable);\n    }\n\n    $.ajax(\n    {\n      type : \"POST\",\n      url : api_root + \"events/models/\" + model_id + \"/select/variable/\" + variable\n    });\n\n    bookmarker.updateState({\"variable-selection\" : variable});\n  }\n\n  function handle_image_variable_change(variable)\n  {\n    images_index = Number(variable);\n\n    // Determine cluster variable from image variable\n    // TODO this needs improvement because we are not guaranteed unique variable names. List of clusters should provide indexes on the variables, instead of just names.\n    cluster_index = clusters.indexOf( table_metadata[\"column-names\"][images_index] );\n\n    // Get entire data column for current image variable and pass it to scatterplot and dendrogram\n    $.ajax(\n    {\n      type : \"GET\",\n      url : api_root + \"models/\" + model_id + \"/arraysets/data-table/data?hyperchunks=0/\" + images_index + \"/0:\" + table_metadata[\"row-count\"],\n      success : function(result)\n      {\n        images = result[0];\n        // Passing new images to both scatterplot and dendrogram\n        $(\"#scatterplot\").scatterplot(\"option\", \"images\", images);\n        $(\"#dendrogram-viewer\").dendrogram(\"option\", \"images\", images);\n        // Updating dendrogram with new cluster data, which will trigger refresh and thus render new images too\n        update_dendrogram(cluster_index);\n      },\n      error: artifact_missing\n    });\n\n    // Log changes to and bookmark the images variable ...\n    images_selection_changed(images_index);\n    // Log changes to and bookmark the cluster variable ...\n    cluster_selection_changed(cluster_index);\n  }\n\n  function images_selection_changed(variable)\n  {\n    $.ajax(\n    {\n      type : \"POST\",\n      url : api_root + \"events/models/\" + model_id + \"/select/images/\" + variable\n    });\n    bookmarker.updateState( {\"images-selection\" : variable} );\n  }\n\n  function update_v(variable)\n  {\n    chunker.get_model_array_attribute({\n      api_root : api_root,\n      mid : model_id,\n      aid : \"data-table\",\n      array : 0,\n      attribute : variable,\n      success : function(result)\n      {\n        v = result;\n        if(table_metadata[\"column-types\"][variable]==\"string\")\n        {\n          v = v[0];\n        }\n        update_widgets_after_color_variable_change();\n      },\n      error : artifact_missing\n    });\n  }\n\n  function update_widgets_after_color_variable_change()\n  {\n    update_current_colorscale();\n    $(\"#table\").table(\"option\", \"colorscale\", colorscale);\n    $(\"#scatterplot\").scatterplot(\"update_color_scale_and_v\", {\n      v : v,\n      v_string : table_metadata[\"column-types\"][v_index]==\"string\",\n      colorscale : colorscale\n    });\n    $(\"#scatterplot\").scatterplot(\"option\", \"v_label\", table_metadata[\"column-names\"][v_index]);\n    $(\"#dendrogram-viewer\").dendrogram(\"option\", \"color-options\", {color_array : v, colorscale : colorscale});\n  }\n\n  function update_widgets_when_hidden_simulations_change(skip_dendrogram_update)\n  {\n    hidden_simulations_changed();\n    if(auto_scale)\n    {\n      update_current_colorscale();\n      $(\"#table\").table(\"option\", {hidden_simulations : hidden_simulations, colorscale : colorscale});\n      // TODO this will result in 2 updates to canvas, one to redraw points according to hidden simulations and another to color them according to new colorscale. Need to combine this to a single update when converting to canvas.\n      $(\"#scatterplot\").scatterplot(\"option\", {hidden_simulations : hidden_simulations, colorscale : colorscale});\n      if(!skip_dendrogram_update)\n      {\n        $(\"#dendrogram-viewer\").dendrogram(\"option\", {hidden_simulations : hidden_simulations, colorscale : colorscale})\n      }\n    }\n    else\n    {\n      $(\"#table\").table(\"option\", \"hidden_simulations\", hidden_simulations);\n      $(\"#scatterplot\").scatterplot(\"option\", \"hidden_simulations\", hidden_simulations);\n      if(!skip_dendrogram_update)\n      {\n        $(\"#dendrogram-viewer\").dendrogram(\"option\", \"hidden_simulations\", hidden_simulations)\n      }\n    }\n    $(\"#controls\").controls(\"option\", \"hidden_simulations\", hidden_simulations);\n  }\n\n  function update_current_colorscale()\n  {\n    // Check if numeric or string variable\n    var v_type = table_metadata[\"column-types\"][v_index];\n    if(auto_scale)\n      filtered_v = filterValues(v);\n    else\n      filtered_v = v;\n\n    if(v_type != \"string\")\n    {\n      colorscale = $(\"#color-switcher\").colorswitcher(\"get_color_scale\", undefined, d3.min(filtered_v), d3.max(filtered_v));\n    }\n    else\n    {\n      var uniqueValues = d3.set(filtered_v).values().sort();\n      colorscale = $(\"#color-switcher\").colorswitcher(\"get_color_scale_ordinal\", undefined, uniqueValues);;\n    }\n  }\n\n  // Filters source values by removing hidden_simulations\n  function filterValues(source)\n  {\n    var self = this;\n    hidden_simulations.sort(d3.ascending);\n    var length = hidden_simulations.length;\n\n    var filtered = cloneArrayBuffer(source);\n\n    for(var i=length-1; i>=0; i--)\n    {\n      filtered.splice(hidden_simulations[i], 1);\n    }\n\n    return filtered;\n  }\n\n  // Clones an ArrayBuffer or Array\n  function cloneArrayBuffer(source)\n  {\n    if(source.length > 1)\n    {\n      return Array.apply( [], source );\n    }\n    else if(source.length == 1)\n    {\n      return [source[0]];\n    }\n    return [];\n  }\n\n  function variable_sort_changed(variable, order)\n  {\n    $.ajax(\n    {\n      type : \"POST\",\n      url : api_root + \"events/models/\" + model_id + \"/select/sort-order/\" + variable + \"/\" + order\n    });\n    bookmarker.updateState( {\"sort-variable\" : variable, \"sort-order\" : order} );\n  }\n\n  function selected_simulations_changed(selection)\n  {\n    // Logging every selected item is too slow, so just log the count instead.\n    $.ajax(\n    {\n      type : \"POST\",\n      url : api_root + \"events/models/\" + model_id + \"/select/simulation/count/\" + selection.length\n    });\n    bookmarker.updateState( {\"simulation-selection\" : selection} );\n    selected_simulations = selection;\n  }\n\n  function cluster_selection_changed(variable)\n  {\n    $.ajax(\n    {\n      type : \"POST\",\n      url : api_root + \"events/models/\" + model_id + \"/select/cluster/\" + variable\n    });\n    bookmarker.updateState( {\"cluster-index\" : variable} );\n  }\n\n  function update_dendrogram(cluster_index)\n  {\n    // Retrieve cluster data if it's not already in the cache\n    if(clusters_data[cluster_index] === undefined) {\n       $.ajax(\n      {\n        url : api_root + \"models/\" + model_id + \"/files/cluster-\" + clusters[cluster_index],\n        contentType : \"application/json\",\n        success : function(cluster_data)\n        {\n          clusters_data[cluster_index] = cluster_data;\n          var dendrogram_options = build_dendrogram_node_options(cluster_index);\n          dendrogram_options.cluster_data = clusters_data[cluster_index];\n          $(\"#dendrogram-viewer\").dendrogram(\"option\", dendrogram_options);\n        },\n        error: artifact_missing\n      });\n    } else {\n      var dendrogram_options = build_dendrogram_node_options(cluster_index);\n      dendrogram_options.cluster_data = clusters_data[cluster_index];\n      $(\"#dendrogram-viewer\").dendrogram(\"option\", dendrogram_options);\n    }\n  }\n\n  function x_selection_changed(variable)\n  {\n    $.ajax(\n    {\n      type : \"POST\",\n      url : api_root + \"events/models/\" + model_id + \"/select/x/\" + variable\n    });\n    bookmarker.updateState( {\"x-selection\" : variable} );\n    x_index = Number(variable);\n  }\n\n  function y_selection_changed(variable)\n  {\n    $.ajax(\n    {\n      type : \"POST\",\n      url : api_root + \"events/models/\" + model_id + \"/select/y/\" + variable\n    });\n    bookmarker.updateState( {\"y-selection\" : variable} );\n    y_index = Number(variable);\n  }\n\n  function auto_scale_option_changed(auto_scale_value)\n  {\n    auto_scale = auto_scale_value;\n    if(hidden_simulations.length > 0)\n    {\n      update_current_colorscale();\n      $(\"#dendrogram-viewer\").dendrogram(\"option\", \"colorscale\", colorscale);\n      $(\"#table\").table(\"option\", \"colorscale\", colorscale);\n      // TODO this will result in 2 updates to canvas, one to redraw points accourding to scale and another to color them according to new colorscale. Need to combine this to a single update when converting to canvas.\n      $(\"#scatterplot\").scatterplot(\"option\", {colorscale : colorscale, 'auto-scale' : auto_scale});\n    }\n    else\n    {\n      $(\"#scatterplot\").scatterplot(\"option\", \"auto-scale\", auto_scale);\n    }\n    $.ajax(\n    {\n      type : \"POST\",\n      url : api_root + \"events/models/\" + model_id + \"/auto-scale/\" + auto_scale\n    });\n    bookmarker.updateState( {\"auto-scale\" : auto_scale} );\n  }\n\n  function open_images_changed(selection)\n  {\n    // Logging every open image is too slow, so just log the count instead.\n    $.ajax(\n    {\n      type : \"POST\",\n      url : api_root + \"events/models/\" + model_id + \"/select/openimages/count/\" + selection.length\n    });\n    bookmarker.updateState( {\"open-images-selection\" : selection} );\n  }\n\n  function hidden_simulations_changed()\n  {\n    // Logging every hidden simulation is too slow, so just log the count instead.\n    $.ajax(\n    {\n      type : \"POST\",\n      url : api_root + \"events/models/\" + model_id + \"/hidden/count/\" + hidden_simulations.length\n    });\n    bookmarker.updateState( {\"hidden-simulations\" : hidden_simulations} );\n  }\n\n  function update_scatterplot_x(variable)\n  {\n    chunker.get_model_array_attribute({\n      api_root : api_root,\n      mid : model_id,\n      aid : \"data-table\",\n      array : 0,\n      attribute : variable,\n      success : function(result)\n      {\n        $(\"#scatterplot\").scatterplot(\"option\", {\n          x_string: table_metadata[\"column-types\"][variable]==\"string\",\n          x: table_metadata[\"column-types\"][variable]==\"string\" ? result[0] : result,\n          x_label:table_metadata[\"column-names\"][variable]\n        });\n      },\n      error : artifact_missing\n    });\n  }\n\n  function update_scatterplot_y(variable)\n  {\n    chunker.get_model_array_attribute({\n      api_root : api_root,\n      mid : model_id,\n      aid : \"data-table\",\n      array : 0,\n      attribute : variable,\n      success : function(result)\n      {\n        $(\"#scatterplot\").scatterplot(\"option\", {\n          y_string: table_metadata[\"column-types\"][variable]==\"string\",\n          y: table_metadata[\"column-types\"][variable]==\"string\" ? result[0] : result,\n          y_label:table_metadata[\"column-names\"][variable]\n        });\n      },\n      error : artifact_missing\n    });\n  }\n\n  function load_table_statistics(columns, callback)\n  {\n    client.get_model_arrayset_metadata(\n    {\n      mid: model_id,\n      aid: \"data-table\",\n      statistics: \"0/\" + columns.join(\"|\"),\n      success: function(metadata)\n      {\n        var statistics = metadata.statistics;\n        for(var i = 0; i != statistics.length; ++i)\n          table_statistics[statistics[i].attribute] = {min: statistics[i].min, max: statistics[i].max};\n        callback();\n      }\n    });\n  }\n\n});\n","/* Copyright (c) 2013, 2018 National Technology and Engineering Solutions of Sandia, LLC . Under the terms of Contract  DE-NA0003525 with National Technology and Engineering Solutions of Sandia, LLC, the U.S. Government  retains certain rights in this software. */\n \nexport var arrayset_metadata_cache = {};\n\nexport function is_little_endian()\n{\n  if(window.result === undefined)\n    window.result = ((new Uint32Array((new Uint8Array([1,2,3,4])).buffer))[0] === 0x04030201);\n  return window.result;\n}\n\n// Retrieve an array attribute's metadata asynchronously, calling a callback when it's ready ...\nexport function get_model_array_attribute_metadata(parameters, dfd)\n{\n  return $.ajax({\n    url : parameters.api_root + \"models/\" + parameters.mid + \"/arraysets/\" + parameters.aid + \"/metadata?arrays=\" + parameters.array,\n    contentType : \"application/json\",\n    success: function(result)\n    {\n      parameters.metadata = result.arrays[0];\n      if(parameters.metadataSuccess !== undefined) {\n        parameters.metadataSuccess(parameters);\n      } else {\n        parameters.success(parameters);\n      }\n    },\n    error: function(request, status, reason_phrase)\n    {\n      if(parameters.error)\n        parameters.error(request, status, reason_phrase);\n    },\n    always: function() {\n      dfd.resolve();\n    }\n  });\n}\n\n// Cast a generic arraybuffer to a typed array, with an optional offset and\n// count.  Note that offset and count are measured in elements, not bytes.\nexport function cast_array_buffer(buffer, type, offset, count)\n{\n  if(type == \"int32\")\n  {\n    if(offset !== undefined)\n      return new Int32Array(buffer, offset*4, count);\n    else\n      return new Int32Array(buffer);\n  }\n  else if(type == \"int16\")\n  {\n    if(offset !== undefined)\n      return new Int16Array(buffer, offset*2, count);\n    else\n      return new Int16Array(buffer);\n  }\n  else if(type == \"int8\")\n  {\n    if(offset !== undefined)\n      return new Int8Array(buffer, offset, count);\n    else\n      return new Int8Array(buffer);\n  }\n  else if(type == \"uint32\")\n  {\n    if(offset !== undefined)\n      return new Uint32Array(buffer, offset*4, count);\n    else\n      return new Uint32Array(buffer);\n  }\n  else if(type == \"uint16\")\n  {\n    if(offset !== undefined)\n      return new Uint16Array(buffer, offset*2, count);\n    else\n      return new Uint16Array(buffer);\n  }\n  else if(type == \"uint8\")\n  {\n    if(offset !== undefined)\n      return new Uint8Array(buffer, offset, count);\n    else\n      return new Uint8Array(buffer);\n  }\n  else if(type == \"float64\")\n  {\n    if(offset !== undefined)\n      return new Float64Array(buffer, offset*8, count);\n    else\n      return new Float64Array(buffer);\n  }\n  else if(type == \"float32\")\n  {\n    if(offset !== undefined)\n      return new Float32Array(buffer, offset*4, count);\n    else\n      return new Float32Array(buffer);\n  }\n  else\n    console.error(\"Unknown array buffer type: \" + type);\n}\n\n// Retrieve an array attribute asynchronously, calling a callback when it's ready ...\nexport function get_model_array_attribute(parameters) {\n  var dfd = $.Deferred();\n  if(parameters.metadata === undefined) {\n    parameters.metadataSuccess = retrieve_model_array_attribute;\n    get_model_array_attribute_metadata(parameters, dfd);\n  }\n  else {\n    retrieve_model_array_attribute(parameters);\n  }\n  return dfd;\n\n  function retrieve_model_array_attribute(parameters) {\n    var ranges = [];\n    var range = '';\n    var metadata = parameters.metadata;\n    var attribute = parameters.attribute;\n    var isStringAttribute = metadata.attributes[attribute].type == \"string\";\n    var byteorder = \"&byteorder=\" + (is_little_endian() ? \"little\" : \"big\");\n    if(isStringAttribute)\n    {\n      byteorder = \"\";\n    }\n\n    for(var dimension in metadata.dimensions)\n    {\n      range = '';\n      range += metadata.dimensions[dimension].begin;\n      range += ':';\n      range += metadata.dimensions[dimension].end;\n      ranges.push(range);\n    }\n    ranges = ranges.join(\"|\");\n\n    var request = new XMLHttpRequest();\n    request.open(\"GET\", parameters.api_root + \"models/\" + parameters.mid + \"/arraysets/\" + parameters.aid + \"/data?hyperchunks=\" + parameters.array + \"/\" + parameters.attribute + \"/\" + ranges + byteorder);\n    if(!isStringAttribute)\n    {\n      request.responseType = \"arraybuffer\";\n    }\n    request.success = parameters.success;\n    request.attribute = parameters.attribute;\n    request.metadata = metadata;\n    request.isStringAttribute = isStringAttribute;\n    request.onload = function(e)\n    {\n      var buffer = this.response;\n      var metadata = this.metadata;\n      var attribute = this.metadata.attributes[this.attribute];\n      var result;\n\n      if(metadata.dimensions.length == 1)\n      {\n        if(!this.isStringAttribute)\n        {\n          result = cast_array_buffer(buffer, attribute.type);\n        }\n        else\n        {\n          result = JSON.parse(this.responseText);\n        }\n      }\n      else if(metadata.dimensions.length == 2)\n      {\n        var row_count = metadata.dimensions[0].end - metadata.dimensions[0].begin;\n        var column_count = metadata.dimensions[1].end - metadata.dimensions[1].begin;\n        var result = [];\n        for(var i = 0; i != row_count; ++i)\n        {\n          result.push(cast_array_buffer(buffer, attribute.type, i * column_count, column_count));\n        }\n      }\n      else\n      {\n        window.alert(\"Can't handle array with \" + metadata.dimensions.length + \" dimensions.\");\n      }\n      this.success(result);\n      dfd.resolve();\n    }\n    request.send();\n  }\n}\n\n","\nvar content = require(\"!!../../node_modules/css-loader/index.js!./slycat-additions.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../node_modules/css-loader/index.js!./slycat-additions.css\", function() {\n\t\tvar newContent = require(\"!!../../node_modules/css-loader/index.js!./slycat-additions.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \"/* Copyright (c) 2013, 2018 National Technology and Engineering Solutions of Sandia, LLC . Under the terms of Contract\\n DE-NA0003525 with National Technology and Engineering Solutions of Sandia, LLC, the U.S. Government\\n retains certain rights in this software. */\\n\\n.vertical {\\n  -ms-transform: rotate(-90deg);\\n  -webkit-transform: rotate(-90deg);\\n  transform: rotate(-90deg);\\n}\\n\\n.unvertical {\\n  -ms-transform: rotate(90deg);\\n  -webkit-transform: rotate(90deg);\\n  transform: rotate(90deg);\\n}\\n\\n.light-border-right {\\n  border-right: 2px solid rgb(231, 231, 231);\\n}\\n\\n.affix-top-right {\\n  position: absolute;\\n  top: 0px;\\n  right: 0px;\\n}\\n\\n.fill-parent-height {\\n  height: 100%;\\n}\\n\\n.fill-parent-width {\\n  width: 100%;\\n}\\n\\n.link-cursor {\\n  cursor: pointer;\\n}\\n\\n.default-cursor {\\n  cursor: inherit;\\n}\\n\\n.info-panel {\\n  border-left: 2px solid #1b809e !important;\\n}\\n\\n.vertical-toggle-pane-resizer {\\n  right-border: 2px solid rgb(231,231,231);\\n}\\n\\n.fill-parent-height {\\n  height: 100%;\\n}\\n\", \"\"]);\n\n// exports\n","/* Copyright (c) 2013, 2018 National Technology and Engineering Solutions of Sandia, LLC . Under the terms of Contract\n DE-NA0003525 with National Technology and Engineering Solutions of Sandia, LLC, the U.S. Government\n retains certain rights in this software. */\n\nimport client from 'js/slycat-web-client';\nimport ko from 'knockout';\nimport mapping from 'knockout-mapping';\nimport ispasswordrequired from 'js/slycat-server-ispasswordrequired';\nimport template from 'templates/slycat-remote-login.html';\nimport \"bootstrap\";\n\nexport function login(params)\n{\n  var component = {};\n  component.cancel = function()\n  {\n    component.container.children().modal(\"hide\");\n    if(params.cancel)\n      params.cancel();\n  }\n  component.login = function()\n  {\n    component.remote.enable(false);\n    component.remote.status_type(\"info\");\n    component.remote.status(\"Connecting ...\");\n    client.post_remotes(\n    {\n      hostname: params.hostname,\n      username: component.remote.username(),\n      password: component.remote.password(),\n      success: function(sid)\n      {\n        component.container.children().modal(\"hide\");\n        if(params.success)\n          params.success(sid);\n      },\n      error: function(request, status, reason_phrase)\n      {\n        component.remote.enable(true);\n        component.remote.status_type(\"danger\");\n        component.remote.status(reason_phrase);\n        component.remote.focus(\"password\");\n      },\n    });\n  }\n  component.title = ko.observable(params.title || \"Login\");\n  component.message = ko.observable(params.message || \"\");\n  component.remote = mapping.fromJS({username: null, password: null, status: null, enable: true, focus: false, status_type: null});\n  component.remote.focus.extend({notify: \"always\"});\n  component.container = $($.parseHTML(template)).appendTo($(\"body\"));\n  component.ispasswordrequired = ispasswordrequired;\n  component.container.children().on(\"shown.bs.modal\", function()\n  {\n    component.remote.focus(true);\n  });\n  component.container.children().on(\"hidden.bs.modal\", function()\n  {\n    component.container.remove();\n  });\n  ko.applyBindings(component, component.container.get(0));\n  component.container.children().modal(\"show\");\n}\n\nexport function create_pool()\n{\n  var remotes = {};\n\n  var pool = {};\n\n  pool.check_remote = function(params)\n  {\n    client.get_remotes({\n      hostname: params.hostname,\n      success: function(result)\n      {\n        if(params.success)\n          params.success(result);\n      },\n      error: function(request, status, reason_phrase)\n      {\n        if(params.error)\n          params.error(request, status, reason_phrase);\n      }\n    });\n  }\n\n  pool.get_remote = function(params)\n  {\n    pool.check_remote({\n      hostname: params.hostname,\n      get_remote_params: params,\n      success: function(result)\n      {\n        if(result.status)\n        {\n          if(params.success)\n            params.success(params.hostname);\n          return;\n        }\n        else\n        {\n          login(\n          {\n            hostname: params.hostname,\n            title: params.title,\n            message: params.message,\n            success: function(sid)\n            {\n              if(params.success)\n                params.success(params.hostname);\n            },\n            cancel: function()\n            {\n              if(params.cancel)\n                params.cancel();\n            },\n          });\n        }\n      },\n      error: function(request, status, reason_phrase)\n      {\n        console.log(\"Unable to check status of remote session.\");\n        return;\n      }\n    });\n  }\n\n  pool.delete_remote = function(hostname)\n  {\n    if(hostname in remotes)\n    {\n      // Ignore any errors, the sid could have expired.\n      client.delete_remote(\n      {\n        sid: remotes[hostname],\n      });\n      delete remotes[hostname];\n    }\n  }\n\n  return pool;\n}","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAAHCAYAAADam2dgAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB94GGxcdCupowjYAAAA4SURBVBjTjY45DgAgAMKq8VP8f+izdHLxiDZhg4YCoHYuJCmVD+q6AmbOJZUkTxPqVmqLqT8/3RjLHw4SIwEXjwAAAABJRU5ErkJggg==\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAAHCAYAAADam2dgAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB94GGxcnLB3MmbIAAAA8SURBVBjTjYyxDYAwEMT8EUvfBB47aQChiEe4ucbnAlAnDUlq8IOxv4A6911SSYL6WbrFJ8dWmlexLXUsiHoUEn+eNQQAAAAASUVORK5CYII=\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAAHCAYAAADam2dgAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB94GGxcGKw83GfIAAABrSURBVBjTjcqxEUFhFEThj0qI1HBTow5tSIRGKHgV6IGRiTcT6kNghCT/wyBwkr2794Ak0yT3JPPWN0luGoP+SHLABDOc0VXVAoZeLDHCEVes+8dTqqoTthhjVVWXL6mxa7l/Hz+ln/wlPQBR6h1u6Vo8IwAAAABJRU5ErkJggg==\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAAHCAYAAADam2dgAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB94GGxcDGiOe7Y0AAAB5SURBVBjTjcoxDkFREIbRczUvdkFlH2Ifau1rZBKlmE5hBWILRGcLSvtQqK/mPREUvmaS+U+BzJzignlEHDJzi0VEDKHoyswzJqWUWa31hl1ELGHQo6ZpVhjVWi94YNNvL9S27RV7jLGOiPsX6jp29/T+/EQ/+ws9AcDpHx8wCF0cAAAAAElFTkSuQmCC\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAAHCAYAAADam2dgAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB94GGxcIEs6xvHQAAACESURBVBjTVc4xDgFxEMXhb1W04g5a7VxFo3cBichGK0J0ShpxEclcQCNxBIlCo1T4r6xpZjLvze9NBZm5wBxDPHDDJSLG0PGtTRFXmGFQOqiaITMnOOKNdUTUjdaQ4IwXuji09n+mKXp4tqN+cZnZxx2n8vQOo4i4tkl1OVhiX4zbhvQBmakeJ1ciCYkAAAAASUVORK5CYII=\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAAHCAYAAADam2dgAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB94GGxcHNnUqRGoAAACISURBVBjTTc4xDkFREIXhj4pW7EFrPRq9DciIvOhuPCE6JY3YiCVoJJYgUWg0N1G4T95p5iRn5j/TgZTSEguM8MQd14iYQNdP2xKuMcewTNBpTF3X05zzCR9sIqJqsoYk53zBGz0ctdRt+Rn6eLWr/nUppQEeOJen9xhHxK1NqsrBCoeyuGtIXwQvJB7uu+OBAAAAAElFTkSuQmCC\"","module.exports = \"<div class=\\\"bootstrap-styles\\\">\\n  <div class=\\\"modal fade\\\" data-backdrop=\\\"static\\\">\\n    <div class=\\\"modal-dialog\\\">\\n      <div class=\\\"modal-content\\\">\\n        <div class=\\\"modal-header\\\">\\n          <button type=\\\"button\\\" class=\\\"close\\\" data-bind=\\\"click:cancel\\\" data-dismiss=\\\"modal\\\" aria-label=\\\"Close\\\">\\n            <span aria-hidden=\\\"true\\\">&times;</span>\\n          </button>\\n          <h3 class=\\\"modal-title\\\" data-bind=\\\"text:title\\\"></h3>\\n        </div>\\n        <div class=\\\"modal-body\\\">\\n          <p data-bind=\\\"visible:message, text:message\\\"></p>\\n          <!-- ko if: ispasswordrequired.ssh_passwordrequired -->\\n          <form class=\\\"form-horizontal\\\" role=\\\"form\\\">\\n            <slycat-login-controls params=\\\"username:remote.username,password:remote.password,status:remote.status,status_type:remote.status_type,enable:remote.enable,focus:remote.focus,activate:login\\\"></slycat-login-controls>\\n          </form>\\n          <!-- /ko -->\\n        </div>\\n        <div class=\\\"modal-footer\\\">\\n          <button class=\\\"btn btn-default\\\" data-bind=\\\"click:login,enable:remote.enable\\\">Login</button>\\n        </div>\\n      </div>\\n    </div>\\n  </div>\\n</div>\\n\";","/* Copyright (c) 2013, 2018 National Technology and Engineering Solutions of Sandia, LLC . Under the terms of Contract\n DE-NA0003525 with National Technology and Engineering Solutions of Sandia, LLC, the U.S. Government\n retains certain rights in this software. */\n\nimport ko from \"knockout\";\nimport slycatLoginControls from \"templates/slycat-login-controls.html\";\n\nko.components.register(\"slycat-login-controls\",\n{\n  viewModel:\n  {\n    createViewModel: function(params, component_info)\n    {\n      var component = {};\n      component.username = params.username;\n      component.password = params.password;\n      component.status = params.status || ko.observable(null);\n      component.status_type = params.status_type || ko.observable(null);\n      component.enable = params.enable || ko.observable(true);\n      component.focus = params.focus || ko.observable(false);\n\n      component.status_classes = ko.pureComputed(function()\n      {\n        var classes = [];\n        if(component.status())\n          classes.push(\"in\");\n        if(component.status_type())\n          classes.push(\"alert-\" + component.status_type());\n        return classes.join(\" \");\n      });\n\n      if(!component.username())\n        component.username(localStorage.getItem(\"slycat-login-controls-username\"));\n\n      component.username.subscribe(function(value)\n      {\n        localStorage.setItem(\"slycat-login-controls-username\", value);\n        component.status(null);\n      });\n\n      component.password.subscribe(function(value)\n      {\n        component.status(null);\n      });\n\n      component.focus.subscribe(function(value)\n      {\n        var username = component.username();\n        var password = component.password();\n        var username_input = $(component_info.element).find(\"input\").eq(0);\n        var password_input = $(component_info.element).find(\"input\").eq(1);\n\n        if(value == true)\n        {\n          if(component.username())\n          {\n            value = \"password\";\n          }\n          else\n          {\n            value = \"username\";\n          }\n        }\n\n        if(value == \"username\")\n        {\n          username_input.focus();\n          if(username)\n            username_input.get(0).setSelectionRange(0, username.length);\n        }\n        if(value == \"password\")\n        {\n          password_input.focus();\n          if(password)\n            password_input.get(0).setSelectionRange(0, password.length);\n        }\n      });\n\n      $(component_info.element).find(\"input\").keydown(function(e)\n      {\n        if(e.which == 13 && params.activate)\n          params.activate();\n      });\n\n      return component;\n    },\n  },\n  template: slycatLoginControls\n});","module.exports = \"<div class=\\\"form-group\\\">\\n  <label for=\\\"slycat-login-username\\\" class=\\\"col-sm-2 control-label\\\">Username</label>\\n  <div class=\\\"col-sm-10\\\">\\n    <input id=\\\"slycat-login-username\\\" class=\\\"form-control\\\" type=\\\"text\\\" data-bind=\\\"enable:enable, textInput:username\\\"></input>\\n  </div>\\n</div>\\n<div class=\\\"form-group\\\">\\n  <label for=\\\"slycat-login-password\\\" class=\\\"col-sm-2 control-label\\\">Password</label>\\n  <div class=\\\"col-sm-10\\\">\\n    <input id=\\\"slycat-login-password\\\" class=\\\"form-control\\\" type=\\\"password\\\" data-bind=\\\"enable:enable, textInput:password\\\"></input>\\n  </div>\\n</div>\\n<div class=\\\"row\\\">\\n  <div class=\\\"col-sm-offset-2 col-sm-10\\\">\\n    <div class=\\\"alert fade\\\" role=\\\"alert\\\" data-bind=\\\"css:status_classes,text:status\\\"></div>\\n  </div>\\n</div>\\n\";","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAARCAYAAAA7bUf6AAAAAXNSR0IArs4c6QAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB94EHhESC1NkMY8AAABaSURBVDjLY2AYkiAtLRSrOCMBTf8JGTxr1mpGFiIcwDhr1mq4K2bNWo2hgIkIQ4RwaSbakFmzVr8jpIaJlIDF5RoWYgOQkiglynAmalg2eAyhSoqlSt4ZPAAAhK0aFjM865EAAAAASUVORK5CYII=\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAARCAYAAAA7bUf6AAAAAXNSR0IArs4c6QAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB94EHhEOMAQYhfYAAABcSURBVDjL1ZM7DoBACERn1rXxCN7/mCbPxsKChJVoslIBgRm+0i8FWCK/kyQyYNvOmAH2SzewVsoH6Dc7ZG0D5R6j7ZdnIkn9SXB1pUPg7Q2yeUC+v9gAdJv7u0+kGjIYZ1Y9RwAAAABJRU5ErkJggg==\"","/* Copyright (c) 2013, 2018 National Technology and Engineering Solutions of Sandia, LLC . Under the terms of Contract\n DE-NA0003525 with National Technology and Engineering Solutions of Sandia, LLC, the U.S. Government\n retains certain rights in this software. */\n\nimport client from \"js/slycat-web-client\";\nimport * as dialog from \"js/slycat-dialog\";\nimport ko from \"knockout\";\nimport mapping from \"knockout-mapping\";\nimport URI from \"urijs\";\nimport slycatJobChecker from \"templates/slycat-job-checker.html\";\n\nko.components.register('slycat-job-checker', {\n  viewModel: function(params) {\n    var model = { _id: URI(window.location).segment(-1) };\n    var vm = this;\n    vm.remote = mapping.fromJS({ hostname: null, username: null, password: null, status: null, status_type: null, enable: true, focus: false, sid: null, session_exists: false });\n    vm.remote.focus.extend({ notify: 'always'  });\n    vm.jid = ko.observable(-1);\n    vm.output = ko.observable('Output for the current job will be posted here...');\n    var iid = -1; // window.setInterval() ID\n    var previous_state = '';\n\n    vm.connect = function() {\n      vm.remote.enable(false);\n      vm.remote.status_type('info');\n      vm.remote.status('Connecting...');\n      if(vm.remote.session_exists())\n      {\n        vm.remote.enable(true);\n        vm.remote.status_type(null);\n        vm.remote.status(null);\n        $('#slycat-job-checker-connect-modal').modal('hide');\n        $('#slycat-job-checker-cancel').removeAttr('disabled');\n        vm.checkjob();\n      }\n      else{\n          client.post_remotes({\n            hostname: vm.remote.hostname(),\n            username: vm.remote.username(),\n            password: vm.remote.password(),\n            success: function(sid) {\n              vm.remote.session_exists(true);\n              vm.remote.sid(sid);\n              vm.remote.enable(true);\n              vm.remote.status_type(null);\n              vm.remote.status(null);\n              $('#slycat-job-checker-connect-modal').modal('hide');\n              $('#slycat-job-checker-cancel').removeAttr('disabled');\n              vm.checkjob();\n            },\n            error: function(request, status, reason_phrase) {\n              $('#slycat-job-checker-cancel').attr('disabled');\n              vm.remote.enable(true);\n              vm.remote.status_type('danger');\n              vm.remote.status(reason_phrase);\n              vm.remote.focus('password');\n            }\n          });\n      }\n    };\n\n    vm.cancel = function() {\n      vm.remote.password('');\n      $('#slycat-job-checker-connect-modal').modal('hide');\n      vm.output(vm.output() + '\\n' + 'Please reload the page to check job ' + vm.jid() + '\\'s status.');\n    };\n\n    vm.cancel_pull = function() {\n      vm.remote.password('');\n      console.log(\"cancel\");\n      $('#slycat-pull-job-connect-modal').modal('hide');\n      vm.output(vm.output() + '\\n' + 'Please reload the page to check job ' + vm.jid() + '\\'s status.');\n    };\n    var get_job_output = function() {\n      vm.output(vm.output() + '\\n\\n' + 'Please reload to view model.');\n      window.location.reload(true);\n    };\n\n    var repeated_state = function(state) {\n      return previous_state === state ? true : false;\n    };\n\n    var routine = function(jid) {\n  client.get_checkjob({\n        hostname: vm.remote.hostname(),\n        jid: vm.jid(),\n        success: function(results) {\n          if (results.errors) {\n            vm.output(vm.output() + '\\n' + '[Error] Could not check job iD=' + vm.jid() + ' status: ' + results.errors);\n            return void 0;\n          }\n\n          var s = results.status.state;\n\n          if (!repeated_state(s))\n            vm.output(vm.output() + '\\n' + 'Job ID=' + vm.jid() + ' is ' + s);\n          else\n            vm.output(vm.output() + '.');\n\n          if (s === 'COMPLETED' || s === 'FAILED') {\n            clearInterval(iid);\n            get_job_output();\n            previous_state = '';\n          }\n\n          if (s === 'CANCELLED' || s === 'REMOVED') {\n            clearInterval(iid);\n            previous_state = '';\n          }\n\n          previous_state = s;\n        },\n        error: function(request, status, reason_phrase) {\n          vm.output(vm.output() + '\\n' + '[Error] Could not check job status: ' + status + ' :' + reason_phrase);\n        }\n      });\n    };\n\n    vm.pullDataFromHpc = function() {\n      console.log(\"1\");\n      vm.remote.enable(false);\n      vm.remote.status_type('info');\n      vm.remote.status('Connecting...');\n      if(vm.remote.session_exists())\n      {\n        console.log(\"got session\");\n        vm.remote.enable(true);\n        vm.remote.status_type(null);\n        vm.remote.status(null);\n        $('#slycat-pull-job-connect-modal').modal('hide');\n        vm.pullHPCData();\n      }\n      else{\n          client.post_remotes({\n            hostname: vm.remote.hostname(),\n            username: vm.remote.username(),\n            password: vm.remote.password(),\n            success: function(sid) {\n              vm.remote.session_exists(true);\n              vm.remote.sid(sid);\n              vm.remote.enable(true);\n              vm.remote.status_type(null);\n              vm.remote.status(null);\n              $('#slycat-pull-job-connect-modal').modal('hide');\n              vm.checkjob();\n            },\n            error: function(request, status, reason_phrase) {\n              $('#slycat-job-checker-cancel').attr('disabled');\n              vm.remote.enable(true);\n              vm.remote.status_type('danger');\n              vm.remote.status(reason_phrase);\n              vm.remote.focus('password');\n            }\n          });\n      }\n    };\n    vm.pullHPCData = function() {\n      console.log(\"2\");\n  client.get_model_command({\n        mid: model._id,\n        type: \"timeseries\",\n        command: \"pull_data\",\n        success: function(results) {\n          vm.output(vm.output() + '\\n' + 'started pull status :' + results.errors);\n        },\n        error: function(request, status, reason_phrase) {\n          vm.output(vm.output() + '\\n' + 'pull status: ' + status + ' :' + reason_phrase);\n        }\n      });\n    };\n\n    vm.checkjob = function() {\n      previous_state = '';\n      iid = setInterval(routine, 1000);\n    };\n\n    vm.set_jid = function(jid) {\n      vm.jid(jid);\n    };\n\n    $('#slycat-job-checker-connect').on('click', function(e) {\n      e.preventDefault();\n      e.stopPropagation();\n\n      $('#slycat-job-checker-connect-modal').modal();\n    });\n\n    $('#slycat-job-pull').on('click', function(e) {\n      e.preventDefault();\n      e.stopPropagation();\n\n      $('#slycat-pull-job-connect-modal').modal();\n    });\n\n  $('#slycat-job-checker-clear').on('click', function(e) {\n      e.preventDefault();\n      e.stopPropagation();\n\n      vm.output('');\n    });\n\n    $('#slycat-job-checker-cancel').on('click', function(e) {\n      e.preventDefault();\n      e.stopPropagation();\n\n      client.delete_job({\n        hostname: vm.remote.hostname(),\n        jid: vm.jid()\n      });\n    });\n  },\n  template: slycatJobChecker\n})","module.exports = \"<div class=\\\"slycat-job-checker bootstrap-styles\\\">\\n  <div class=\\\"slycat-job-checker-controls\\\">\\n    <button id=\\\"slycat-job-checker-connect\\\" class=\\\"btn btn-default\\\">Connect To View Job Output</button>\\n    <button id=\\\"slycat-job-checker-clear\\\" class=\\\"btn btn-default\\\">Clear Output</button>\\n    <button id=\\\"slycat-job-pull\\\" class=\\\"btn btn-default\\\">Pull data</button>\\n    <button id=\\\"slycat-job-checker-cancel\\\" class=\\\"btn btn-danger\\\" disabled>Cancel Job</button>\\n  </div>\\n  <div class=\\\"slycat-job-checker-output\\\" data-bind=\\\"text: output\\\"></div>\\n\\n  <div id=\\\"slycat-job-checker-connect-modal\\\" class=\\\"modal fade\\\" data-backdrop=\\\"static\\\">\\n    <div class=\\\"modal-dialog\\\">\\n      <div class=\\\"modal-content zoom-sensitive\\\">\\n        <div class=\\\"modal-header\\\">\\n          <h4 class=\\\"modal-title\\\">Connect to host...</h4>\\n        </div>\\n        <div class=\\\"modal-body\\\">\\n          <form class=\\\"form-horizontal\\\" role=\\\"form\\\">\\n            <slycat-remote-controls params=\\\"hostname:remote.hostname,username:remote.username,password:remote.password,status:remote.status,status_type:remote.status_type,enable:remote.enable,focus:remote.focus,activate:connect,session_exists:remote.session_exists\\\"></slycat-remote-controls>\\n          </form>\\n        </div>\\n        <div class=\\\"modal-footer\\\">\\n          <button class=\\\"btn btn-primary\\\" data-bind=\\\"click:connect,enable:remote.enable\\\">Connect</button>\\n          <button class=\\\"btn btn-default pull-left\\\" data-bind=\\\"click:cancel\\\">Cancel</button>\\n        </div>\\n      </div>\\n    </div>\\n  </div>\\n\\n  <div id=\\\"slycat-pull-job-connect-modal\\\" class=\\\"modal fade\\\" data-backdrop=\\\"static\\\">\\n    <div class=\\\"modal-dialog\\\">\\n      <div class=\\\"modal-content zoom-sensitive\\\">\\n        <div class=\\\"modal-header\\\">\\n          <h4 class=\\\"modal-title\\\">Connect to host...</h4>\\n        </div>\\n        <div class=\\\"modal-body\\\">\\n          <form class=\\\"form-horizontal\\\" role=\\\"form\\\">\\n            <slycat-remote-controls params=\\\"hostname:remote.hostname,username:remote.username,password:remote.password,status:remote.status,status_type:remote.status_type,enable:remote.enable,focus:remote.focus,activate:connect,session_exists:remote.session_exists\\\"></slycat-remote-controls>\\n          </form>\\n        </div>\\n        <div class=\\\"modal-footer\\\">\\n          <button class=\\\"btn btn-primary\\\" data-bind=\\\"click:pullDataFromHpc,enable:remote.enable\\\">Connect</button>\\n          <button class=\\\"btn btn-default pull-left\\\" data-bind=\\\"click:cancel_pull\\\">Cancel</button>\\n        </div>\\n      </div>\\n    </div>\\n  </div>\\n</div>\\n\\n\";","\nvar content = require(\"!!../../../../node_modules/css-loader/index.js!./ui.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../node_modules/css-loader/index.js!./ui.css\", function() {\n\t\tvar newContent = require(\"!!../../../../node_modules/css-loader/index.js!./ui.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","var escape = require(\"../../../../node_modules/css-loader/lib/url/escape.js\");\nexports = module.exports = require(\"../../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \"/* Copyright (c) 2013, 2018 National Technology and Engineering Solutions of Sandia, LLC . Under the terms of Contract  DE-NA0003525 with National Technology and Engineering Solutions of Sandia, LLC, the U.S. Government  retains certain rights in this software. */\\n\\n/* Page header */\\n\\n#edit-model-button\\n{\\n  float: right;\\n}\\n\\n#table\\n{\\n\\tposition: absolute;\\n\\ttop: 0;\\n\\tleft: 0;\\n\\tright: 0;\\n\\tbottom: 0;\\n}\\n\\n.x-axis,\\n.y-axis\\n{\\n  -moz-user-select: none;\\n  -webkit-user-select: none;\\n  -ms-user-select: none;\\n  user-select: none;\\n  shape-rendering: crispEdges;\\n}\\n\\n.x-axis path,\\n.y-axis path\\n{\\n  fill: none;\\n  stroke: black;\\n}\\n\\n#remote-error\\n{\\n  background-color: red;\\n  color: yellow;\\n  padding: 1em;\\n}\\n\\n/* Model */\\n#parameter-image-plus-layout {\\n  -webkit-flex: 1;\\n  flex: 1;\\n}\\n\\n/* New CCA table styles */\\n#barplot-table {\\n  /*height: 250px;*/\\n  overflow: hidden;\\n}\\n.barplotHeader {\\n  /*overflow: hidden;*/\\n  white-space: nowrap;\\n}\\n.barplotHeaderColumns {\\n  /*outline: 1px solid blue;*/\\n  white-space: nowrap;\\n  display: inline-block;\\n}\\n.barplotHeaderColumn {\\n  text-align: right !important;\\n  display: inline-block;\\n  /*padding: 3px;*/\\n  cursor: pointer;\\n  /*outline: 1px solid red;*/\\n}\\n.wrapper {\\n  /*No longer using box-sizing since we are sizing cells based on an wrapper div inside them*/\\n/*  box-sizing: border-box;\\n  -moz-box-sizing: border-box;*/\\n}\\n.barplotHeaderColumn .wrapper {\\n  padding: 3px;\\n}\\n.mask\\n{\\n  background-color: white;\\n  position: relative; /* needed to get this cell to cover scrolling header row */\\n  z-index: 1;\\n}\\n.mask .wrapper {\\n  padding: 3px;\\n}\\n.barplotViewport {\\n\\n}\\n.barplotGroup {\\n  overflow: hidden;\\n  width: auto !important; /* Need to force auto width since jQuery Resizable Widget sets static width on resize, which then breaks horizontal expansion/contraction on pane resize */\\n}\\n.barplotColumn {\\n  float: left;\\n  clear: left;\\n}\\n.barplotGroup.inputs,\\n.barplotHeader,\\n.barplotColumn,\\n.mask,\\n.inputs .ui-resizable-s\\n{\\n  border-color: #C0C0C0;\\n  border-style: solid;\\n  border-width: 0;\\n}\\n/*.barplotGroup.inputs,*/\\n.barplotHeader\\n{\\n  border-bottom-width: 1px;\\n}\\n.barplotColumn,\\n.mask\\n{\\n  border-right-width: 1px;\\n}\\n.inputs .ui-resizable-s {\\n  bottom: 0;\\n  height: 3px;\\n  border-bottom-width: 1px;\\n  border-top-width: 1px;\\n  background-color: #DDDDCC;\\n}\\n.inputs .ui-resizable-s.ui-resizable-hover {\\n  background-color: #FFCC66;\\n}\\n.noVerticalResize .ui-resizable-s {\\n  display: none !important;\\n}\\n.toggle-control-s {\\n  width: 50px;\\n  height: 100%;\\n  margin: 0 auto;\\n  background-color: #CCCCBB;\\n}\\n.toggle-control-s.toggle-control-hover {\\n  cursor: pointer;\\n  background-color: #FFCC66;\\n}\\n/*.barplotGroup.inputs {\\n  border-bottom: 7px solid red;\\n}*/\\n.barplotColumn .barplotCell {\\n  display: block;\\n}\\n.barplotCanvas {\\n  /*overflow: auto;*/\\n  /*display: relative;*/ /* Only needed if using DOM's scrollIntoView() function instead of jQuery plugin */\\n  height: 100%;\\n}\\n.barplotCanvas.input {\\n  overflow-x: hidden;\\n  /*overflow-y: auto;*/\\n}\\n.barplotRow {\\n  white-space: nowrap;\\n}\\n.barplotCell {\\n  display: inline-block;\\n  text-align: right;\\n}\\n#rsquared-label sup {\\n  position: absolute;\\n  margin-top: -3px;\\n}\\n.rowInput,\\n.rowOutput\\n{\\n  cursor: pointer;\\n}\\n#barplot-table .inputLabel .wrapper,\\n#barplot-table .outputLabel .wrapper\\n{\\n  padding: 3px;\\n}\\n#barplot-table .inputLabel,\\n#barplot-table .outputLabel,\\n.barplotCell.col0,\\n.barplotHeaderColumn\\n{\\n  font-weight: bold;\\n  text-align: center;\\n}\\n#barplot-table .inputLabel\\n{\\n  background: #eeffe0;\\n}\\n#barplot-table .inputLabel.selected-variable,\\n#barplot-table .barplotRow.rowInput.selected-variable,\\n#barplot-table .barplotCell.rowInput.selected-variable\\n{\\n  background: #3ca654;\\n  color: white;\\n}\\n#barplot-table .outputLabel\\n{\\n  background: #eeeeff;\\n}\\n#barplot-table .outputLabel.selected-variable,\\n#barplot-table .barplotRow.rowOutput.selected-variable,\\n#barplot-table .barplotCell.rowOutput.selected-variable\\n{\\n  background: #7767b0;\\n  color: white;\\n}\\n.barplotHeaderColumnLabelWrapper,\\n.selectCCAComponent,\\n.wrapper,\\n.barplotCellValue,\\n.selected-component .spacer,\\n.negative,\\n.positive\\n{\\n  display: inline-block;\\n}\\n.barplotCellValue\\n{\\n  padding: 3px 23px 3px 18px;\\n  width: 40px;\\n}\\n.selected-component .barplotCellValue,\\n.barplotHeaderColumn.selected-component .barplotHeaderColumnLabelWrapper\\n{\\n  background-color: #DDDDDD;\\n  border-width: 0px 1px;\\n  border-style: solid;\\n  border-color: #808080;\\n  color: #666655;\\n}\\n.barplotHeaderColumn.selected-component .wrapper {\\n  padding: 0;\\n}\\n.barplotHeaderColumn.selected-component .barplotHeaderColumnLabelWrapper\\n{\\n  padding: 3px 3px 3px 3px;\\n  width: 75px;\\n}\\n.spacer\\n{\\n  width: 100px;\\n  display: none;\\n}\\n.negativeSpacer\\n{\\n  text-align: right;\\n}\\n.positiveSpacer\\n{\\n  text-align: left;\\n}\\n.negative,\\n.positive\\n{\\n  height: 12px;\\n}\\n.negative\\n{\\n  background-color: blue;\\n  border-top-left-radius: 2px;\\n  border-bottom-left-radius: 2px;\\n}\\n.positive\\n{\\n  background-color: red;\\n  border-top-right-radius: 2px;\\n  border-bottom-right-radius: 2px;\\n}\\n#barplot-table span.sortCCAComponent\\n{\\n  width: 15px;\\n  height: 15px;\\n  display: inline-block;\\n  border: 1px solid transparent;\\n  cursor: pointer;\\n  position: relative;\\n  top: 3px;\\n  margin-left: 3px;\\n}\\n.barplotHeaderColumn.mask.col0 {\\n  vertical-align: top;\\n}\\n.slick-header-column {\\n  padding-right: 41px !important;\\n}\\n.icon-sort-off {\\n  border: 1px solid transparent;\\n  background: transparent url(\" + escape(require(\"../../../img/sort-asc-light.png\")) + \") no-repeat center center;\\n}\\n.icon-sort-off:hover {\\n  border: 1px solid transparent !important;\\n  background: transparent url(\" + escape(require(\"../../../img/sort-asc-gray.png\")) + \") no-repeat center center !important;\\n}\\n.icon-sort-ascending:hover,\\n.icon-sort-descending:hover\\n{\\n  border: 1px solid transparent;\\n}\\n.slick-header-button,\\n.slick-header-column:hover > .slick-header-button\\n{\\n  width: 10px;\\n}\\n.slick-header-button.icon-image-on,\\n.slick-header-button.icon-image-off\\n{\\n  right: 16px;\\n  top: 4px;\\n}\\n.slick-header-button.icon-image-off {\\n  background: transparent url(\" + escape(require(\"../../../img/image-light.png\")) + \") no-repeat center center;\\n}\\n.slick-header-button.icon-image-on,\\n.slick-header-button.icon-image-off:hover\\n{\\n  background: transparent url(\" + escape(require(\"../../../img/image-gray.png\")) + \") no-repeat center center;\\n}\\n.slick-header-button.icon-y-on,\\n.slick-header-button.icon-y-off\\n{\\n  right: 16px;\\n  top: 4px;\\n}\\n.slick-header-button.icon-y-off {\\n  background: transparent url(\" + escape(require(\"../../../img/y-light.png\")) + \") no-repeat center center;\\n}\\n.slick-header-button.icon-y-on,\\n.slick-header-button.icon-y-off:hover\\n{\\n  background: transparent url(\" + escape(require(\"../../../img/y-gray.png\")) + \") no-repeat center center;\\n}\\n.slick-header-button.icon-x-on,\\n.slick-header-button.icon-x-off\\n{\\n  right: 26px;\\n  top: 4px;\\n}\\n.slick-header-button.icon-x-off {\\n  background: transparent url(\" + escape(require(\"../../../img/x-light.png\")) + \") no-repeat center center;\\n}\\n.slick-header-button.icon-x-on,\\n.slick-header-button.icon-x-off:hover\\n{\\n  background: transparent url(\" + escape(require(\"../../../img/x-gray.png\")) + \") no-repeat center center;\\n}\\n#page-title {\\n  padding-top: 5px;\\n  padding-bottom: 35px;\\n}\\n#controls-pane {\\n  \\n}\\n.center {\\n  text-align: center;\\n}\\n#color-switcher {\\n  margin: 0;\\n  float: none;\\n  display: inline-block;\\n}\\n#color-switcher .label {\\n  font-weight: bold;\\n}\\n#color-switcher .color {\\n  background-color: #DBD9EB;\\n  padding: 4px;\\n}\\n#color-switcher .color:hover {\\n  cursor: pointer;\\n}\\n#color-switcher .selected:hover {\\n  cursor: default;\\n}\\n#color-switcher .selected {\\n  background-color: #7767B0 !important;\\n  color: white;\\n}\\n#color-switcher,\\n#controls\\n{\\n  font-size: small;\\n}\\n#controls {\\n  display: inline-block;\\n  margin: 2px 0;\\n}\\n#controls label {\\n  font-weight: bold;\\n  margin-right: 5px;\\n}\\n#controls label.disabled,\\n#controls select:disabled\\n{\\n  color: gray;\\n}\\n#controls select:disabled {\\n\\n}\\n#controls select {\\n  margin-right: 10px;\\n  padding: 2px 4px;\\n}\\n#controls button,\\n#controls label[for=\\\"auto-scale-option\\\"]\\n{\\n  margin-right: 10px;\\n}\\n#scatterplot.resizing,\\n#scatterplot .resize-handle:hover {\\n  cursor: nwse-resize;\\n}\\n#scatterplot rect.outline:hover,\\n#scatterplot g.image-frame image.image\\n{\\n  cursor: move;\\n}\\n#scatterplot .close-button:hover,\\n#scatterplot .pin-button:hover {\\n  cursor: pointer;\\n}\\n#scatterplot g.open-image image.image {\\n\\n}\\n#scatterplot .close-button,\\n#scatterplot .resize-handle,\\n#scatterplot .pin-button\\n{\\n  visibility: hidden;\\n}\\n#scatterplot g.open-image:hover .close-button,\\n#scatterplot g.open-image.resizing .close-button,\\n#scatterplot g.hover-image .pin-button,\\n#scatterplot g.open-image:hover .pin-button,\\n#scatterplot g.image-frame:hover .resize-handle,\\n#scatterplot g.open-image.resizing .resize-handle\\n{\\n  visibility: visible;\\n}\\n#scatterplot g.legend:hover {\\n  cursor: move;\\n}\\n#scatterplot .image-frame rect.outline {\\n  shape-rendering: crispEdges;\\n}\\n.legend-axis path,\\n.legend-axis line\\n{\\n  fill: none;\\n  stroke: black;\\n  shape-rendering: crispEdges;\\n}\\n.dialogErrorMessage {\\n  color: red;\\n}\\n#scatterplot canvas {\\n  z-index: -1;\\n}\\n\\n/* dendrogram styles */\\n#dendrogram-pane #dendrogram-sort-control \\n{\\n  position: absolute;\\n  bottom: 0px;\\n  left: 0px;\\n  cursor: pointer;\\n  background: #DBD9EB url(\" + escape(require(\"../../../img/sort-dendrogram.png\")) + \") no-repeat center center;;\\n  padding: 4px;\\n  margin: 0 0 5px 18px;\\n  height: 17px;\\n  min-width: 17px;\\n}\\n\\n#dendrogram-pane #dendrogram-sort-control.selected\\n{\\n  background: #7767B0 url(\" + escape(require(\"../../../img/sort-dendrogram-selected.png\")) + \") no-repeat center center;\\n  color: #FFFFFF;\\n  cursor: default;\\n}\\n\\n#dendrogram-viewer .node .glyph circle\\n{\\n  stroke: grey;\\n}\\n\\n#dendrogram-viewer .node.selected .glyph circle\\n{\\n  fill: #7767b0 !important;\\n  stroke: black;\\n}\\n\\n#dendrogram-viewer .node .glyph text\\n{\\n  cursor: pointer;\\n}\\n\\n#dendrogram-viewer .node .subtree\\n{\\n  cursor: pointer;\\n}\\n\\n#dendrogram-viewer .node .subtree path\\n{\\n  stroke: none;\\n}\\n\\n/* Hiding the additional glyph initially */\\n#dendrogram-viewer .node .subtree path.filled-glyph\\n{\\n  display: none;\\n}\\n/* Showing it for selected nodes */\\n#dendrogram-viewer .node.selected .subtree path.filled-glyph\\n{\\n  display: inline;\\n}\\n\\n#dendrogram-viewer .node.selected .subtree text\\n{\\n  fill: white;\\n}\\n\\n#dendrogram-viewer .node .sparkline path\\n{\\n  fill: none;\\n  stroke: black;\\n}\\n\\n#dendrogram-viewer .link\\n{\\n  fill: none;\\n  stroke: #C9C9C9;\\n  shape-rendering: crispEdges;\\n}\\n#dendrogram-leaf-backdrop {\\n  height: 100%;\\n  width: 49px;\\n  position: absolute;\\n  right: 0;\\n  z-index: -1;\\n}\\n#dendrogram-viewer g.sparkline path {\\n  stroke-linecap: round;\\n}\\n#dendrogram-viewer g.sparkline path:hover,\\n#dendrogram-viewer g.sparkline path.highlight\\n{\\n  stroke-width: 4px;\\n}\\n#dendrogram-viewer g.sparkline path.highlight {\\n  \\n}\\n#dendrogram-viewer g.sparkline path.nullValue {\\n  stroke-dasharray: 2px, 2px;\\n}\\n#dendrogram-viewer g.sparkline path.highlight.nullValue {\\n  stroke-dasharray: 2px, 5px;\\n}\\n#dendrogram-viewer g.thumbnail rect.outline {\\n  stroke: unset;\\n}\\n#dendrogram-viewer g.thumbnail.highlight rect.outline {\\n  stroke: black;\\n}\\n#dendrogram-viewer g.square {\\n  shape-rendering: crispEdges;\\n}\\n\\n/* ui layout */\\n.ui-layout-resizer\\n{\\n  background: #ddc;\\n}\\n.ui-layout-resizer-hover\\n{\\n  background: #fc6;\\n}\\n.ui-layout-resizer-dragging\\n{\\n  background: #fc6;\\n}\\n.ui-layout-toggler\\n{\\n  background: #ccb;\\n}\\n.ui-layout-toggler-hover\\n{\\n  background: #fc6;\\n}\\n.ui-layout-pane, .ui-layout-container\\n{\\n  background: white;\\n  padding: 0;\\n  border: 0;\\n  margin: 0;\\n}\\n\\n/* Image Preview */\\n#scatterplot-pane #image-preview {\\n  position: absolute;\\n  top: 0;\\n  left: 0;\\n  width: 100%;\\n  height: 100%;\\n  background-color: white;\\n  display: none;\\n  text-align: center;\\n}\\n#scatterplot-pane #image-preview-image {\\n  max-height: 100%;\\n  max-width: 100%;\\n}\", \"\"]);\n\n// exports\n","/* Copyright (c) 2013, 2018 National Technology and Engineering Solutions of Sandia, LLC . Under the terms of Contract  DE-NA0003525 with National Technology and Engineering Solutions of Sandia, LLC, the U.S. Government  retains certain rights in this software. */\n\n//////////////////////////////////////////////////////////////////////////////////\n// d3js.org scatterplot visualization, for use with the parameter-image model.\n\nimport api_root from \"js/slycat-api-root\";\nimport d3 from \"js/d3.min\";\nimport URI from \"urijs\";\nimport * as remotes from \"js/slycat-remotes\";\nimport \"jquery-ui\";\nimport \"js/slycat-login-controls\";\nimport pin from '../img/pin.png';\n\n$.widget(\"parameter_image.scatterplot\",\n{\n  options:\n  {\n    width : 300,\n    height : 300,\n    pick_distance : 3,\n    drag_threshold : 3,\n    indices : [],\n    x_label : \"X Label\",\n    y_label : \"Y Label\",\n    v_label : \"V Label\",\n    x : [],\n    y : [],\n    v : [],\n    x_string : false,\n    y_string : false,\n    v_string : false,\n    images : [],\n    selection : [],\n    colorscale : d3.scale.linear().domain([-1, 0, 1]).range([\"blue\", \"white\", \"red\"]),\n    border : 25,\n    open_images : [],\n    gradient : null,\n    hidden_simulations : [],\n    filtered_indices : [],\n    filtered_selection : [],\n    filtered_x : [],\n    filtered_y : [],\n    filtered_v : [],\n    scale_x : [],\n    scale_y : [],\n    scale_v: [],\n    \"auto-scale\" : true,\n    canvas_square_size : 8,\n    canvas_square_border_size : 1,\n    canvas_selected_square_size : 16,\n    canvas_selected_square_border_size : 2,\n    pinned_width : 200,\n    pinned_height : 200,\n    hover_time : 250,\n    image_cache : {},\n    cache_references : [ {} ],\n    // image_cache needs to be shared between dendrogram and scatterplot, thus it is passed inside an array to keep it in sync.\n    // http://api.jqueryui.com/jquery.widget/\n    // All options passed on init are deep-copied to ensure the objects can be modified later without affecting the widget.\n    // Arrays are the only exception, they are referenced as-is.\n    // This exception is in place to support data-binding, where the data source has to be kept as a reference.\n    login_dialog : null,\n  },\n\n_create: function()\n{\n  var self = this;\n\n  this.remotes = remotes.create_pool();\n  self.login_open = false;\n\n  if(self.options[\"auto-scale\"])\n  {\n    self.options.filtered_x = self._filterValues(self.options.x);\n    self.options.filtered_y = self._filterValues(self.options.y);\n    self.options.filtered_v = self._filterValues(self.options.v);\n    self.options.scale_x = self.options.filtered_x;\n    self.options.scale_y = self.options.filtered_y;\n    self.options.scale_v = self.options.filtered_v;\n  }\n  else\n  {\n    self.options.scale_x = self.options.x;\n    self.options.scale_y = self.options.y;\n    self.options.scale_v = self.options.v;\n  }\n\n  self.hover_timer = null;\n  self.close_hover_timer = null;\n\n  self.hover_timer_canvas = null;\n\n  self.opening_image = null;\n  self.state = \"\";\n  self.start_drag = null;\n  self.current_drag = null;\n  self.end_drag = null;\n\n  // Setup the scatterplot ...\n  self.svg = d3.select(self.element.get(0)).append(\"svg\");\n  self.x_axis_layer = self.svg.append(\"g\").attr(\"class\", \"x-axis\");\n  self.y_axis_layer = self.svg.append(\"g\").attr(\"class\", \"y-axis\");\n  self.legend_layer = self.svg.append(\"g\").attr(\"class\", \"legend\");\n  self.legend_axis_layer = self.legend_layer.append(\"g\").attr(\"class\", \"legend-axis\");\n  self.datum_layer = self.svg.append(\"g\").attr(\"class\", \"datum-layer\");\n  self.selected_layer = self.svg.append(\"g\").attr(\"class\", \"selected-layer\");\n  self.canvas_datum = d3.select(self.element.get(0)).append(\"canvas\")\n    .style({'position':'absolute'}).node()\n    ;\n  self.canvas_datum_layer = self.canvas_datum.getContext(\"2d\");\n  self.canvas_selected = d3.select(self.element.get(0)).append(\"canvas\")\n    .style({'position':'absolute'}).node()\n    ;\n  self.canvas_selected_layer = self.canvas_selected.getContext(\"2d\");\n  self.selection_layer = self.svg.append(\"g\").attr(\"class\", \"selection-layer\");\n  self.image_layer = self.svg.append(\"g\").attr(\"class\", \"image-layer\");\n\n  self.options.image_cache = self.options.cache_references[0];\n\n  self.updates = {};\n  self.update_timer = null;\n  self._schedule_update({\n    update_indices:true,\n    update_width:true,\n    update_height:true,\n    update_x:true,\n    update_y:true,\n    update_x_label:true,\n    update_y_label:true,\n    render_data:true,\n    render_selection:true,\n    open_images:true,\n    render_legend:true,\n    update_legend_colors:true,\n    update_legend_position:true,\n    update_legend_axis:true,\n    update_v_label:true,\n  });\n\n  self.legend_layer\n    .call(\n      d3.behavior.drag()\n        .on('drag', function(){\n          // Make sure mouse is inside svg element\n          if( 0 <= d3.event.y && d3.event.y <= self.options.height && 0 <= d3.event.x && d3.event.x <= self.options.width ){\n            var theElement = d3.select(this);\n            var transx = Number(theElement.attr(\"data-transx\"));\n            var transy = Number(theElement.attr(\"data-transy\"));\n            transx += d3.event.dx;\n            transy += d3.event.dy;\n            theElement.attr(\"data-transx\", transx);\n            theElement.attr(\"data-transy\", transy);\n            theElement.attr('transform', \"translate(\" + transx + \", \" + transy + \")\");\n          }\n        })\n        .on(\"dragstart\", function() {\n          self.state = \"moving\";\n          d3.event.sourceEvent.stopPropagation(); // silence other listeners\n        })\n        .on(\"dragend\", function() {\n          self.state = \"\";\n          // self._sync_open_images();\n          d3.select(this).attr(\"data-status\", \"moved\");\n        })\n    )\n    ;\n\n  self.element.mousedown(function(e)\n  {\n    //console.log(\"#scatterplot mousedown\");\n    e.preventDefault();\n    self.start_drag = [self._offsetX(e), self._offsetY(e)];\n    self.end_drag = null;\n  });\n\n  self.element.mousemove(function(e)\n  {\n    if(self.start_drag === null)\n    {\n      // Only schedule a hover if user is hovering over svg, not over images, video, etc.\n      if(e.target.nodeName === \"svg\")\n      {\n        self._schedule_hover_canvas(e);\n      }\n    }\n    else if(self.start_drag) // Mouse is down ...\n    {\n      if(self.end_drag) // Already dragging ...\n      {\n        self.end_drag = [self._offsetX(e), self._offsetY(e)];\n\n        var width = self.element.width();\n        var height = self.element.height();\n\n        self.selection_layer.selectAll(\".rubberband\")\n            .attr(\"x\", Math.min(self.start_drag[0], self.end_drag[0]))\n            .attr(\"y\", Math.min(self.start_drag[1], self.end_drag[1]))\n            .attr(\"width\", Math.abs(self.start_drag[0] - self.end_drag[0]))\n            .attr(\"height\", Math.abs(self.start_drag[1] - self.end_drag[1]))\n          ;\n      }\n      else\n      {\n        if(Math.abs(self._offsetX(e) - self.start_drag[0]) > self.options.drag_threshold || Math.abs(self._offsetY(e) - self.start_drag[1]) > self.options.drag_threshold) // Start dragging ...\n        {\n          self.state = \"rubber-band-drag\";\n          self.end_drag = [self._offsetX(e), self._offsetY(e)];\n          self.selection_layer.append(\"rect\")\n            .attr(\"class\", \"rubberband\")\n            .attr(\"x\", Math.min(self.start_drag[0], self.end_drag[0]))\n            .attr(\"y\", Math.min(self.start_drag[1], self.end_drag[1]))\n            .attr(\"width\", Math.abs(self.start_drag[0] - self.end_drag[0]))\n            .attr(\"height\", Math.abs(self.start_drag[1] - self.end_drag[1]))\n            .attr(\"fill\", \"rgba(255, 255, 0, 0.3)\")\n            .attr(\"stroke\", \"rgb(255, 255, 0)\")\n            .attr(\"linewidth\", 2)\n            ;\n        }\n      }\n    }\n  });\n\n  self.element.mouseout(function(e){\n    self._cancel_hover_canvas();\n  });\n\n  self.element.mouseup(function(e)\n  {\n    if(self.state == \"resizing\" || self.state == \"moving\")\n      return;\n\n    //console.log(\"#scatterplot mouseup\");\n    if(!e.ctrlKey && !e.metaKey)\n    {\n      self.options.selection = [];\n      self.options.filtered_selection = [];\n    }\n\n    var x = self.options.x;\n    var y = self.options.y;\n    var count = x.length;\n    var x_coord, y_coord;\n\n    if(self.state == \"rubber-band-drag\") // Rubber-band selection ...\n    {\n      self.selection_layer.selectAll(\".rubberband\").remove();\n\n      if(self.start_drag && self.end_drag) {\n        var x1 = Math.min(self.start_drag[0], self.end_drag[0]);\n        var x2 = Math.max(self.start_drag[0], self.end_drag[0]);\n        var y1 = Math.min(self.start_drag[1], self.end_drag[1]);\n        var y2 = Math.max(self.start_drag[1], self.end_drag[1]);\n\n        for(var i = 0; i != count; ++i)\n        {\n          x_coord = self.x_scale(x[i]);\n          y_coord = self.y_scale(y[i]);\n          if(x1 <= x_coord && x_coord <= x2 && y1 <= y_coord && y_coord <= y2)\n          {\n            var index = self.options.selection.indexOf(self.options.indices[i]);\n            if(index == -1)\n              self.options.selection.push(self.options.indices[i]);\n          }\n        }\n      }\n    }\n    else // Pick selection ...\n    {\n      var x1 = self._offsetX(e) - self.options.pick_distance;\n      var x2 = self._offsetX(e) + self.options.pick_distance;\n      var y1 = self._offsetY(e) - self.options.pick_distance;\n      var y2 = self._offsetY(e) + self.options.pick_distance;\n\n      for(var i = count - 1; i > -1; i--)\n      {\n        x_coord = self.x_scale(x[i]);\n        y_coord = self.y_scale(y[i]);\n        if(x1 <= x_coord && x_coord <= x2 && y1 <= y_coord && y_coord <= y2)\n        {\n          // Update the list of selected points ...\n          var index = self.options.selection.indexOf(self.options.indices[i]);\n          if(index == -1)\n          {\n            // Selecting a new point.\n            self.options.selection.push(self.options.indices[i]);\n          }\n          else\n          {\n            // Deselecting an existing point.\n            self.options.selection.splice(index, 1);\n          }\n\n          break;\n        }\n      }\n    }\n\n    self.start_drag = null;\n    self.end_drag = null;\n    self.state = \"\";\n\n    self._filterIndices();\n    self.options.selection = self.options.filtered_selection.slice(0);\n    self._schedule_update({render_selection:true});\n    self.element.trigger(\"selection-changed\", [self.options.selection]);\n  });\n  self._filterIndices();\n},\n\n_filterIndices: function()\n{\n  var self = this;\n  var x = self.options.x;\n  var y = self.options.y;\n  var indices = self.options.indices;\n  var selection = self.options.selection;\n  var hidden_simulations = self.options.hidden_simulations;\n  var filtered_indices = self._cloneArrayBuffer(indices);\n  var filtered_selection = selection.slice(0);\n  var length = indices.length;\n\n  // Remove hidden simulations and NaNs and empty strings\n  for(var i=length-1; i>=0; i--){\n    var hidden = $.inArray(indices[i], hidden_simulations) > -1;\n\n    if(hidden || !self._validateValue(x[i]) || !self._validateValue(y[i])) {\n      filtered_indices.splice(i, 1);\n      var selectionIndex = $.inArray(indices[i], filtered_selection);\n      if( selectionIndex > -1 ) {\n        filtered_selection.splice(selectionIndex, 1);\n      }\n    }\n  }\n\n  self.options.filtered_indices = filtered_indices;\n  self.options.filtered_selection = filtered_selection;\n},\n\n// Filters source values by removing hidden_simulations\n_filterValues: function(source)\n{\n  var self = this;\n  var hidden_simulations = self.options.hidden_simulations.sort(d3.ascending);\n  var length = hidden_simulations.length;\n\n  var filtered = self._cloneArrayBuffer(source);\n\n  for(var i=length-1; i>=0; i--)\n  {\n    filtered.splice(hidden_simulations[i], 1);\n  }\n\n  return filtered;\n},\n\n// Clones an ArrayBuffer or Array\n_cloneArrayBuffer: function(source)\n{\n  // Array.apply method of turning an ArrayBuffer into a normal array is very fast (around 5ms for 250K) but doesn't work in WebKit with arrays longer than about 125K\n  // if(source.length > 1)\n  // {\n  //   return Array.apply( [], source );\n  // }\n  // else if(source.length == 1)\n  // {\n  //   return [source[0]];\n  // }\n  // return [];\n\n  // For loop method is much shower (around 300ms for 250K) but works in WebKit. Might be able to speed things up by using ArrayBuffer.subarray() method to make smallery arrays and then Array.apply those.\n  var clone = [];\n  for(var i = 0; i < source.length; i++)\n  {\n    clone.push(source[i]);\n  }\n  return clone;\n},\n\n_createScale: function(string, values, range, reverse)\n{\n  if(!string)\n  {\n    var domain = [d3.min(values), d3.max(values)];\n    if(reverse === true)\n    {\n      domain.reverse();\n    }\n    return d3.scale.linear()\n      .domain(domain)\n      .range(range)\n      ;\n  }\n  else\n  {\n    var uniqueValues = d3.set(values).values().sort();\n    if(reverse === true)\n    {\n      uniqueValues.reverse();\n    }\n    return d3.scale.ordinal()\n      .domain(uniqueValues)\n      .rangePoints(range)\n      ;\n  }\n},\n\n_getDefaultXPosition: function(imageIndex, imageWidth)\n{\n  // We force the image to the left or right side of the screen, based on the target point position.\n  var self = this;\n  var width = self.svg.attr(\"width\");\n  var range = self.x_scale.range();\n  var rangeLast = range.length - 1;\n  var relx = (self.x_scale(self.options.x[imageIndex]) - range[0]) / (range[rangeLast] - range[0]);\n  var x;\n\n  if(relx < 0.5)\n    x = relx * range[0];\n  else\n    x = width - ((width - range[rangeLast]) * (1.0 - relx)) - imageWidth;\n\n  return parseInt(x);\n},\n\n_getDefaultYPosition: function(imageIndex, imageHeight)\n{\n  var self = this;\n  var height = self.svg.attr(\"height\");\n  var target_y = self.y_scale(self.options.y[imageIndex]);\n  return parseInt((target_y / height) * (height - imageHeight));\n},\n\n_validateValue: function(value)\n{\n  var self = this;\n  if(typeof value == \"number\" && !isNaN(value))\n    return true;\n  if(typeof value == \"string\" && value.trim() != \"\")\n    return true;\n  return false;\n},\n\n_setOption: function(key, value)\n{\n  var self = this;\n\n  //console.log(\"parameter_image.scatterplot._setOption()\", key, value);\n  self.options[key] = value;\n\n  if(key == \"indices\")\n  {\n    self._filterIndices();\n    self._schedule_update({update_indices:true, render_selection:true});\n  }\n\n  else if(key == \"x_label\")\n  {\n    self._schedule_update({update_x_label:true});\n  }\n\n  else if(key == \"y_label\")\n  {\n    self._schedule_update({update_y_label:true});\n  }\n\n  else if(key == \"v_label\")\n  {\n    self._schedule_update({update_v_label:true});\n  }\n\n  else if(key == \"x\")\n  {\n    if(self.options[\"auto-scale\"])\n    {\n      self.options.filtered_x = self._filterValues(self.options.x);\n      self.options.scale_x = self.options.filtered_x;\n    }\n    else\n    {\n      self.options.scale_x = self.options.x;\n    }\n    self._filterIndices();\n    self._close_hidden_simulations();\n    self._schedule_update({update_x:true, update_leaders:true, render_data:true, render_selection:true});\n  }\n\n  else if(key == \"y\")\n  {\n    if(self.options[\"auto-scale\"])\n    {\n      self.options.filtered_y = self._filterValues(self.options.y);\n      self.options.scale_y = self.options.filtered_y;\n    }\n    else\n    {\n      self.options.scale_y = self.options.y;\n    }\n    self._filterIndices();\n    self._close_hidden_simulations();\n    self._schedule_update({update_y:true, update_leaders:true, render_data:true, render_selection:true});\n  }\n\n  else if(key == \"v\")\n  {\n    if(self.options[\"auto-scale\"])\n    {\n      self.options.filtered_v = self._filterValues(self.options.v);\n      self.options.scale_v = self.options.filtered_v;\n    }\n    else\n    {\n      self.options.scale_v = self.options.v;\n    }\n    self._schedule_update({render_data:true, render_selection:true, update_legend_axis:true});\n  }\n\n  else if(key == \"images\")\n  {\n  }\n\n  else if(key == \"selection\")\n  {\n    self._filterIndices();\n    self._schedule_update({render_selection:true});\n  }\n\n  else if(key == \"colorscale\")\n  {\n    self._schedule_update({render_data:true, render_selection:true});\n  }\n\n  else if(key == \"width\")\n  {\n    self._schedule_update({update_width:true, update_x_label:true, update_x:true, update_leaders:true, render_data:true, render_selection:true});\n  }\n\n  else if(key == \"height\")\n  {\n    self._schedule_update({update_height:true, update_y:true, update_y_label:true, update_leaders:true, render_data:true, render_selection:true, update_legend_position:true, update_legend_axis:true, update_v_label:true,});\n  }\n\n  else if(key == \"border\")\n  {\n    self._schedule_update({update_x:true, update_y:true, update_leaders:true, render_data:true, render_selection:true, update_legend_position:true, update_v_label:true,});\n  }\n\n  else if(key == \"gradient\")\n  {\n    self._schedule_update({update_legend_colors:true, });\n  }\n\n  else if(key == \"hidden_simulations\")\n  {\n    self._filterIndices();\n    if(self.options[\"auto-scale\"])\n    {\n      self.options.filtered_x = self._filterValues(self.options.x);\n      self.options.filtered_y = self._filterValues(self.options.y);\n      self.options.filtered_v = self._filterValues(self.options.v);\n      self.options.scale_x = self.options.filtered_x;\n      self.options.scale_y = self.options.filtered_y;\n      self.options.scale_v = self.options.filtered_v;\n    }\n    else\n    {\n      self.options.scale_x = self.options.x;\n      self.options.scale_y = self.options.y;\n      self.options.scale_v = self.options.v;\n    }\n    self._schedule_update({update_x:true, update_y:true, update_leaders:true, render_data:true, render_selection:true, update_legend_axis:true});\n    self._close_hidden_simulations();\n  }\n\n  else if(key == \"auto-scale\")\n  {\n    if(self.options[\"auto-scale\"])\n    {\n      self.options.filtered_x = self._filterValues(self.options.x);\n      self.options.filtered_y = self._filterValues(self.options.y);\n      self.options.filtered_v = self._filterValues(self.options.v);\n      self.options.scale_x = self.options.filtered_x;\n      self.options.scale_y = self.options.filtered_y;\n      self.options.scale_v = self.options.filtered_v;\n    }\n    else\n    {\n      self.options.scale_x = self.options.x;\n      self.options.scale_y = self.options.y;\n      self.options.scale_v = self.options.v;\n    }\n    self._schedule_update({update_x:true, update_y:true, update_leaders:true, render_data:true, render_selection:true, update_legend_axis:true});\n  }\n},\n\nupdate_color_scale_and_v: function(data)\n{\n  var self = this;\n  self.options.colorscale = data.colorscale;\n  self.options.v = data.v;\n  if(data.v_string !== undefined)\n  {\n    self.options.v_string = data.v_string;\n  }\n  if(self.options[\"auto-scale\"])\n  {\n    self.options.filtered_v = self._filterValues(self.options.v);\n    self.options.scale_v = self.options.filtered_v;\n  }\n  else\n  {\n    self.options.scale_v = self.options.v;\n  }\n  self._schedule_update({render_data:true, render_selection:true, update_legend_axis:true});\n},\n\n_schedule_update: function(updates)\n{\n  var self = this;\n\n  for(var key in updates)\n    self.updates[key] = updates[key];\n\n  if(self.update_timer)\n    return;\n\n  self.update_timer = window.setTimeout(function() { self._update(); }, 0);\n},\n\n_update: function()\n{\n  var self = this;\n\n  //console.log(\"parameter_image.scatterplot._update()\", self.updates);\n  self.update_timer = null;\n\n  var xoffset = 0;\n  var legend_width = 150;\n\n  if(self.updates[\"update_width\"])\n  {\n    self.element.attr(\"width\", self.options.width);\n    self.svg.attr(\"width\", self.options.width);\n\n    var total_width = self.options.width;\n    var total_height = self.options.height;\n    var width = Math.min(total_width, total_height);\n    var width_offset = (total_width - width) / 2;\n\n    d3.select(self.canvas_datum)\n      .style({\n        \"left\" : (width_offset + self.options.border - (self.options.canvas_square_size / 2)) + \"px\",\n      })\n      .attr(\"width\", (width - (2 * self.options.border)) - xoffset + self.options.canvas_square_size)\n      ;\n    d3.select(self.canvas_selected)\n      .style({\n        \"left\" : (width_offset + self.options.border - (self.options.canvas_selected_square_size / 2)) + \"px\",\n      })\n      .attr(\"width\", (width - (2 * self.options.border)) - xoffset + self.options.canvas_selected_square_size)\n      ;\n  }\n\n  if(self.updates[\"update_height\"])\n  {\n    self.element.attr(\"height\", self.options.height);\n    self.svg.attr(\"height\", self.options.height);\n\n    var total_width = self.options.width;\n    var total_height = self.options.height;\n    var height = Math.min(total_width, total_height);\n    var height_offset = (total_height - height) / 2;\n    d3.select(self.canvas_datum)\n      .style({\n        \"top\" : (height_offset + self.options.border - (self.options.canvas_square_size / 2)) + \"px\",\n      })\n      .attr(\"height\", (height - (2 * self.options.border)) - 40 + self.options.canvas_square_size)\n      ;\n    d3.select(self.canvas_selected)\n      .style({\n        \"top\" : (height_offset + self.options.border - (self.options.canvas_selected_square_size / 2)) + \"px\",\n      })\n      .attr(\"height\", (height - (2 * self.options.border)) - 40 + self.options.canvas_selected_square_size)\n      ;\n  }\n\n  if(self.updates[\"update_x\"])\n  {\n    var total_width = self.options.width;\n    var total_height = self.options.height;\n    var width = Math.min(self.options.width, self.options.height);\n    var width_offset = (total_width - width) / 2;\n\n    var range = [0 + width_offset + self.options.border, total_width - width_offset - self.options.border - xoffset];\n    var range_canvas = [0, width - (2 * self.options.border) - xoffset];\n\n    self.x_scale = self._createScale(self.options.x_string, self.options.scale_x, range, false);\n    self.x_scale_canvas = self._createScale(self.options.x_string, self.options.scale_x, range_canvas, false);\n    \n    var height = Math.min(self.options.width, self.options.height);\n    var height_offset = (total_height - height) / 2;\n    self.x_axis_offset = total_height - height_offset - self.options.border - 40;\n    self.x_axis = d3.svg.axis().scale(self.x_scale).orient(\"bottom\");\n    self.x_axis_layer\n      .attr(\"transform\", \"translate(0,\" + self.x_axis_offset + \")\")\n      .call(self.x_axis)\n      ;\n  }\n\n  if(self.updates[\"update_y\"])\n  {\n    var total_width = self.options.width;\n    var total_height = self.options.height;\n    var width = Math.min(self.options.width, self.options.height);\n    var height = Math.min(self.options.width, self.options.height);\n    var width_offset = (total_width - width) / 2\n    var height_offset = (total_height - height) / 2\n    var range = [total_height - height_offset - self.options.border - 40, 0 + height_offset + self.options.border];\n    var range_canvas = [height - (2 * self.options.border) - 40, 0];\n    self.y_axis_offset = 0 + width_offset + self.options.border;\n\n    self.y_scale = self._createScale(self.options.y_string, self.options.scale_y, range, false);\n    self.y_scale_canvas = self._createScale(self.options.y_string, self.options.scale_y, range_canvas, false);\n\n    self.y_axis = d3.svg.axis().scale(self.y_scale).orient(\"left\");\n    self.y_axis_layer\n      .attr(\"transform\", \"translate(\" + self.y_axis_offset + \",0)\")\n      .call(self.y_axis)\n      ;\n  }\n\n  if(self.updates[\"update_indices\"])\n  {\n    self.inverse_indices = {};\n    var count = self.options.indices.length;\n    for(var i = 0; i != count; ++i)\n      self.inverse_indices[self.options.indices[i]] = i;\n  }\n\n  if(self.updates[\"update_x_label\"])\n  {\n    var x = self.svg.attr(\"width\") / 2;\n    var y = 40;\n\n    self.x_axis_layer.selectAll(\".label\").remove()\n    self.x_axis_layer.append(\"text\")\n      .attr(\"class\", \"label\")\n      .attr(\"x\", x)\n      .attr(\"y\", y)\n      .style(\"text-anchor\", \"middle\")\n      .style(\"font-weight\", \"bold\")\n      .text(self.options.x_label)\n      ;\n  }\n\n  if(self.updates[\"update_y_label\"])\n  {\n    self.y_axis_layer.selectAll(\".label\").remove();\n\n    var y_axis_width = self.y_axis_layer.node().getBBox().width;\n    var x = -(y_axis_width+15);\n    var y = self.svg.attr(\"height\") / 2;\n\n    self.y_axis_layer.append(\"text\")\n      .attr(\"class\", \"label\")\n      .attr(\"x\", x)\n      .attr(\"y\", y)\n      .attr(\"transform\", \"rotate(-90,\" + x +\",\" + y + \")\")\n      .style(\"text-anchor\", \"middle\")\n      .style(\"font-weight\", \"bold\")\n      .text(self.options.y_label)\n      ;\n  }\n\n  if(self.updates[\"render_data\"])\n  {\n    var x = self.options.x,\n        y = self.options.y,\n        v = self.options.v,\n        filtered_indices = self.options.filtered_indices,\n        canvas = self.canvas_datum_layer,\n        i = -1, \n        n = filtered_indices.length, \n        cx, \n        cy,\n        color,\n        square_size = self.options.canvas_square_size,\n        border_width = self.options.canvas_square_border_size,\n        half_border_width = border_width / 2,\n        fillWidth = square_size - (2 * border_width),\n        fillHeight = fillWidth,\n        strokeWidth = square_size - border_width,\n        strokeHeight = strokeWidth;\n\n    // Draw points on canvas ...\n    var time = Date;\n    if(window.performance)\n      time = window.performance;\n    var start = time.now();\n    \n    canvas.clearRect(0, 0, self.canvas_datum.width, self.canvas_datum.height);\n    canvas.strokeStyle = \"black\";\n    canvas.lineWidth = border_width;\n\n    while (++i < n) {\n      var index = filtered_indices[i];\n      var value = v[index];\n      if(!self._validateValue(value))\n        color = $(\"#color-switcher\").colorswitcher(\"get_null_color\");\n      else\n        color = self.options.colorscale(value); \n      canvas.fillStyle = color;\n      cx = Math.round( self.x_scale_canvas( x[index] ) );\n      cy = Math.round( self.y_scale_canvas( y[index] ) );\n      canvas.fillRect(cx + border_width, cy + border_width, fillWidth, fillHeight);\n      canvas.strokeRect(cx + half_border_width, cy + half_border_width, strokeWidth, strokeHeight);\n    }\n    // Test point for checking position and border\n    // canvas.fillStyle = \"white\";\n    // canvas.fillRect(0 + 0.5, 0 + 0.5, width, height);\n    // canvas.strokeRect(0 + 0.5, 0 + 0.5, width, height);\n    var end = time.now();\n    console.log(\"Time to render \" + filtered_indices.length + \" canvas points: \" + (end-start) + \" milliseconds.\");\n\n    // Draw points on svg ...\n    // var start = performance.now();\n    // var circle = self.datum_layer.selectAll(\".datum\")\n    //   .data(filtered_indices, function(d, i){ \n    //     return d;\n    //   })\n    //   ;\n    // circle.exit()\n    //   .remove()\n    //   ;\n    // circle.enter()\n    //   .append(\"circle\")\n    //   .attr(\"class\", \"datum\")\n    //   .attr(\"r\", 4)\n    //   .attr(\"stroke\", \"black\")\n    //   .attr(\"linewidth\", 1)\n    //   .attr(\"data-index\", function(d, i) { return d; })\n    //   .on(\"mouseover\", function(d, i) { \n    //     self._schedule_hover(d);\n    //   })\n    //   .on(\"mouseout\", function(d, i) { \n    //     self._cancel_hover(); \n    //   })\n    //   ;\n    // circle\n    //   .attr(\"cx\", function(d, i) { return self.x_scale( x[d] ); })\n    //   .attr(\"cy\", function(d, i) { return self.y_scale( y[d] ); })\n    //   .attr(\"fill\", function(d, i) { \n    //     var value = v[d];\n    //     if(isNaN(value))\n    //       return $(\"#color-switcher\").colorswitcher(\"get_null_color\");\n    //     else\n    //       return self.options.color(value); \n    //   })\n    //   ;\n    // var end = performance.now();\n    // console.log(\"Time to render \" + filtered_indices.length + \" svg points: \" + (end-start) + \" milliseconds.\");\n  }\n\n  if(self.updates[\"render_selection\"])\n  {\n    var x = self.options.x,\n        y = self.options.y,\n        v = self.options.v,\n        filtered_selection = self.options.filtered_selection,\n        canvas = self.canvas_selected_layer,\n        i = -1,\n        n = filtered_selection.length,\n        cx, \n        cy,\n        color,\n        square_size = self.options.canvas_selected_square_size,\n        border_width = self.options.canvas_selected_square_border_size,\n        half_border_width = border_width / 2,\n        fillWidth = fillHeight = square_size - (2 * border_width),\n        strokeWidth = strokeHeight = square_size - border_width;\n    \n    canvas.clearRect(0, 0, self.canvas_selected.width, self.canvas_selected.height);\n    canvas.strokeStyle = \"black\";\n    canvas.lineWidth = border_width;\n\n    while (++i < n) {\n      var index = filtered_selection[i];\n      var value = v[index];\n      if(!self._validateValue(value))\n        color = $(\"#color-switcher\").colorswitcher(\"get_null_color\");\n      else\n        color = self.options.colorscale(value); \n      canvas.fillStyle = color;\n      cx = Math.round( self.x_scale_canvas( x[index] ) );\n      cy = Math.round( self.y_scale_canvas( y[index] ) );\n      canvas.fillRect(cx + border_width, cy + border_width, fillWidth, fillHeight);\n      canvas.strokeRect(cx + half_border_width, cy + half_border_width, strokeWidth, strokeHeight);\n    }\n\n    // var x_scale = self.x_scale;\n    // var y_scale = self.y_scale;\n\n    // self.selected_layer.selectAll(\".selection\").remove();\n\n    // var circle = self.selected_layer.selectAll(\".selection\")\n    //   .data(filtered_selection, function(d, i){\n    //     return d;\n    //   })\n    //   ;\n    // circle.enter()\n    //   .append(\"circle\")\n    //   .attr(\"class\", \"selection\")\n    //   .attr(\"r\", 8)\n    //   .attr(\"stroke\", \"black\")\n    //   .attr(\"linewidth\", 1)\n    //   .attr(\"data-index\", function(d, i) {\n    //     return d;\n    //   })\n    //   .on(\"mouseover\", function(d, i) {\n    //     self._schedule_hover(d);\n    //   })\n    //   .on(\"mouseout\", function(d, i) {\n    //     self._cancel_hover();\n    //   })\n    //   ;\n    // circle\n    //   .attr(\"cx\", function(d, i) {\n    //     return x_scale( x[d] );\n    //   })\n    //   .attr(\"cy\", function(d, i) {\n    //     return y_scale( y[d] );\n    //   })\n    //   .attr(\"fill\", function(d, i) {\n    //     var value = v[d];\n    //     if(isNaN(value))\n    //       return $(\"#color-switcher\").colorswitcher(\"get_null_color\");\n    //     else\n    //       return self.options.color(value);\n    //   })\n    //   ;\n  }\n\n  // Used to open an initial list of images at startup only\n  if(self.updates[\"open_images\"])\n  {\n    // This is just a convenience for testing - in practice, these parameters should always be part of the open image specification.\n    self.options.open_images.forEach(function(image)\n    {\n      if(image.uri === undefined)\n        image.uri = self.options.images[image.index];\n      if(image.width === undefined)\n        image.width = self.options.pinned_width;\n      if(image.height === undefined)\n        image.height = self.options.pinned_height;\n    });\n\n    // Transform the list of initial images so we can pass them to _open_images()\n    var width = Number(self.svg.attr(\"width\"));\n    var height = Number(self.svg.attr(\"height\"));\n\n    var images = [];\n    self.options.open_images.forEach(function(image, index)\n    {\n      images.push({\n        index : image.index,\n        uri : image.uri.trim(),\n        image_class : \"open-image\",\n        x : width * image.relx,\n        y : height * image.rely,\n        width : image.width,\n        height : image.height,\n        target_x : self.x_scale(self.options.x[image.index]),\n        target_y : self.y_scale(self.options.y[image.index]),\n        });\n    });\n    self._open_images(images);\n  }\n\n  // Update leader targets anytime we resize or change our axes ...\n  if(self.updates[\"update_leaders\"])\n  {\n    $(\".open-image\").each(function(index, frame)\n    {\n      var frame = $(frame);\n      var image_index = Number(frame.attr(\"data-index\"));\n      frame.find(\".leader\")\n        .attr(\"x2\", self.x_scale(self.options.x[image_index])-Number(frame.attr(\"data-transx\")) )\n        .attr(\"y2\", self.y_scale(self.options.y[image_index])-Number(frame.attr(\"data-transy\")) )\n        .attr(\"data-targetx\", self.x_scale(self.options.x[image_index]))\n        .attr(\"data-targety\", self.y_scale(self.options.y[image_index]))\n        ;\n    });\n  }\n\n  if(self.updates[\"render_legend\"])\n  {\n    var gradient = self.legend_layer.append(\"defs\").append(\"linearGradient\");\n    gradient.attr(\"id\", \"color-gradient\")\n      .attr(\"x1\", \"0%\").attr(\"y1\", \"0%\")\n      .attr(\"x2\", \"0%\").attr(\"y2\", \"100%\")\n      ;\n\n    var colorbar = self.legend_layer.append(\"rect\")\n      .classed(\"color\", true)\n      .attr(\"width\", 10)\n      .attr(\"height\", 200)\n      .attr(\"x\", 0)\n      .attr(\"y\", 0)\n      .style(\"fill\", \"url(#color-gradient)\")\n      ;\n  }\n\n  if(self.updates[\"update_legend_colors\"])\n  {\n    var gradient = self.legend_layer.select(\"#color-gradient\");\n    var stop = gradient.selectAll(\"stop\").data(self.options.gradient);\n    stop.exit().remove();\n    stop.enter().append(\"stop\");\n    stop\n      .attr(\"offset\", function(d) { return d.offset + \"%\"; })\n      .attr(\"stop-color\", function(d) { return d.color; })\n      ;\n  }\n\n  if(self.updates[\"update_legend_position\"])\n  {\n    var total_width = Number(self.options.width);\n    var total_height = Number(self.options.height);\n    var width = Math.min(self.options.width, self.options.height);\n    var height = Math.min(self.options.width, self.options.height);\n    var rectHeight = parseInt((height - self.options.border - 40)/2);\n    var y_axis_layer_width = self.y_axis_layer.node().getBBox().width;\n    var x_axis_layer_width = self.x_axis_layer.node().getBBox().width;\n    var width_offset = (total_width + x_axis_layer_width) / 2;\n\n    if( self.legend_layer.attr(\"data-status\") != \"moved\" )\n    {\n      var transx = parseInt(y_axis_layer_width + 10 + width_offset);\n      var transy = parseInt((total_height/2)-(rectHeight/2));\n       self.legend_layer\n        .attr(\"transform\", \"translate(\" + transx + \",\" + transy + \")\")\n        .attr(\"data-transx\", transx)\n        .attr(\"data-transy\", transy)\n        ;\n    }\n\n    self.legend_layer.select(\"rect.color\")\n      .attr(\"height\", rectHeight)\n      ;\n  }\n\n  if(self.updates[\"update_legend_axis\"])\n  {\n    var range = [0, parseInt(self.legend_layer.select(\"rect.color\").attr(\"height\"))];\n\n    self.legend_scale = self._createScale(self.options.v_string, self.options.scale_v, range, true);\n\n    self.legend_axis = d3.svg.axis().scale(self.legend_scale).orient(\"right\");\n    self.legend_axis_layer\n      .attr(\"transform\", \"translate(\" + parseInt(self.legend_layer.select(\"rect.color\").attr(\"width\")) + \",0)\")\n      .call(self.legend_axis)\n      ;\n  }\n\n  if(self.updates[\"update_v_label\"])\n  {\n    console.log(\"updating v label.\");\n    self.legend_layer.selectAll(\".label\").remove();\n\n    var rectHeight = parseInt(self.legend_layer.select(\"rect.color\").attr(\"height\"));\n    var x = -15;\n    var y = rectHeight/2;\n\n    self.legend_layer.append(\"text\")\n      .attr(\"class\", \"label\")\n      .attr(\"x\", x)\n      .attr(\"y\", y)\n      .attr(\"transform\", \"rotate(-90,\" + x +\",\" + y + \")\")\n      .style(\"text-anchor\", \"middle\")\n      .style(\"font-weight\", \"bold\")\n      .text(self.options.v_label)\n      ;\n  }\n\n  self.updates = {}\n},\n\n_sync_open_images: function()\n{\n  var self = this;\n\n  // Get the scatterplot width so we can convert absolute to relative coordinates.\n  var width = Number(self.svg.attr(\"width\"));\n  var height = Number(self.svg.attr(\"height\"));\n  var open_images = [];\n  $(\".open-image\").each(function(index, frame)\n  {\n    var frame = $(frame);\n    var image = frame.find(\"image.image\");\n    open_images.push({\n      index : Number(frame.attr(\"data-index\")),\n      uri : frame.attr(\"data-uri\"),\n      relx : Number(frame.attr(\"data-transx\")) / width,\n      rely : Number(frame.attr(\"data-transy\")) / height,\n      width : Number(image.attr(\"width\")),\n      height : Number(image.attr(\"height\")),\n      });\n  });\n  self.element.trigger(\"open-images-changed\", [open_images]);\n},\n\n_open_images: function(images)\n{\n  var self = this;\n\n  // If the list of images is empty, we're done.\n  if(images.length == 0)\n    return;\n\n  var image = images[0];\n\n  // Don't open images for hidden simulations\n  if($.inArray(image.index, self.options.hidden_simulations) != -1) {\n    self._open_images(images.slice(1));\n    return;\n  }\n\n  // // Don't open image if it's already open\n  // if($(\".open-image[data-uri='\" + image.uri + \"']\").size() > 0) {\n  //   self._open_images(images.slice(1));\n  //   return;\n  // }\n\n  // If image is hover and we are no longer loading this image, we're done.\n  if( image.image_class == \"hover-image\" &&\n      self.opening_image != image.index\n    )\n  {\n    return;\n  }\n\n  // Create scaffolding and status indicator if we already don't have one\n  if( self.image_layer.select(\"g.\" + image.image_class + \"[data-uri='\" + image.uri + \"']\").empty() ){\n\n    // Define a default size for every image.\n    if(image.width === undefined)\n      image.width = self.options.pinned_width;\n    if(image.height === undefined)\n      image.height = self.options.pinned_height;\n\n    // Define a default position for every image.\n    if(image.x === undefined)\n    {\n      image.x = self._getDefaultXPosition(image.index, image.width);\n    }\n    if(image.y === undefined)\n    {\n      image.y = self._getDefaultYPosition(image.index, image.height);\n    }\n\n    // Tag associated point with class\n    self.datum_layer.selectAll(\"circle[data-index='\" + image.index + \"']\")\n      .classed(\"openHover\", true)\n      ;\n\n    var frame = self.image_layer.append(\"g\")\n      .attr(\"data-uri\", image.uri)\n      .attr(\"data-transx\", image.x)\n      .attr(\"data-transy\", image.y)\n      .attr('transform', \"translate(\" + image.x + \", \" + image.y + \")\")\n      .attr(\"class\", image.image_class + \" image-frame\")\n      .attr(\"data-index\", image.index)\n      .attr(\"data-uri\", image.uri)\n      .call(\n        d3.behavior.drag()\n          .on('drag', function(){\n            //console.log(\"frame drag\");\n            // Make sure mouse is inside svg element\n            if( 0 <= d3.event.y && d3.event.y <= self.options.height && 0 <= d3.event.x && d3.event.x <= self.options.width ){\n              var theElement = d3.select(this);\n              var transx = Number(theElement.attr(\"data-transx\"));\n              var transy = Number(theElement.attr(\"data-transy\"));\n              transx += d3.event.dx;\n              transy += d3.event.dy;\n              theElement.attr(\"data-transx\", transx);\n              theElement.attr(\"data-transy\", transy);\n              theElement.attr('transform', \"translate(\" + transx + \", \" + transy + \")\");\n\n              var leader = theElement.select(\".leader\");\n              leader.attr(\"x2\", Number(leader.attr(\"data-targetx\")) - transx);\n              leader.attr(\"y2\", Number(leader.attr(\"data-targety\")) - transy);\n            }\n          })\n          .on(\"dragstart\", function() {\n            //console.log(\"frame dragstart\");\n            self.state = \"moving\";\n            // Verify source event target\n            var sourceEventTarget = d3.select(d3.event.sourceEvent.target);\n            if(sourceEventTarget.classed(\"outline\") || sourceEventTarget.classed(\"image\"))\n            {\n              d3.event.sourceEvent.stopPropagation(); // silence other listeners\n              // Reset tracking of hover image if we are starting to drag a hover image\n              var frame = d3.select(this);\n              if(frame.classed(\"hover-image\"))\n              {\n                self.opening_image = null;\n                if(self.close_hover_timer)\n                {\n                  window.clearTimeout(self.close_hover_timer);\n                  self.close_hover_timer = null;\n                }\n                frame.classed(\"hover-image\", false).classed(\"open-image\", true);\n                image.image_class = \"open-image\";\n                // Remove openHover class tag from any points that might have it\n                self.datum_layer.selectAll(\"circle.openHover\")\n                  .classed(\"openHover\", false)\n                  ;\n              }\n            }\n          })\n          .on(\"dragend\", function() {\n            //console.log(\"frame dragend\");\n            self.state = \"\";\n            self._sync_open_images();\n          })\n      )\n      .on(\"mousedown\", function(){\n        //console.log(\"frame mousedown\");\n        //d3.event.stopPropagation();\n        // Verify that click is on image, not something else like the close button\n        if(d3.event.target.classList.contains(\"image\"))\n        {\n          // Move this image to the top of the Z order ...\n          $(d3.event.target.parentNode).detach().appendTo(self.image_layer.node());\n        }\n      })\n      .on(\"mouseup\", function(){\n        //console.log(\"frame mouseup\");\n        //d3.event.stopPropagation();\n      })\n      ;\n\n    // Create the leader line ...\n    if(\"target_x\" in image && \"target_y\" in image)\n    {\n      frame.append(\"line\")\n        .attr(\"class\", \"leader\")\n        .attr(\"x1\", (image.width / 2))\n        .attr(\"y1\", (image.height / 2))\n        .attr(\"x2\", image.target_x - Number(frame.attr(\"data-transx\")))\n        .attr(\"y2\", image.target_y - Number(frame.attr(\"data-transy\")))\n        .attr(\"data-targetx\", image.target_x)\n        .attr(\"data-targety\", image.target_y)\n        .style(\"stroke\", \"black\")\n        .style(\"stroke-width\", 1.0)\n        ;\n    }\n\n    // Create an outline ...\n    var outline = frame.append(\"rect\")\n      .attr(\"class\", \"outline\")\n      .attr(\"x\", -0.5)\n      .attr(\"y\", -0.5)\n      .attr(\"width\", image.width + 1)\n      .attr(\"height\", image.height + 1)\n      .style(\"stroke\", \"black\")\n      .style(\"stroke-width\", \"1px\")\n      .style(\"fill\", \"white\")\n      ;\n\n    // // Create the loading image ...\n    // var timeout_image = frame.append(\"image\")\n    //   .attr(\"class\", \"loading-image\")\n    //   .attr(\"xlink:href\", \"/css/ajax-loader.gif\")\n    //   .attr(\"x\", (image.width / 2)-16)\n    //   .attr(\"y\", (image.height / 2)-16)\n    //   .attr(\"width\", 32)\n    //   .attr(\"height\", 32)\n    //   ;\n\n    // Schedule timeout for hover\n    self.close_hover_timer = window.setTimeout(function() {self._hover_timeout(image.index, 0);}, 1000);\n  }\n\n  // If the image is already in the cache, display it.\n  if(image.uri in self.options.image_cache)\n  {\n    console.log(\"Displaying image \" + image.uri + \" from cache\");\n    var url_creator = window.URL || window.webkitURL;\n    var image_url = url_creator.createObjectURL(self.options.image_cache[image.uri]);\n\n    // Define a default size for every image.\n    if(image.width === undefined)\n      image.width = self.options.pinned_width;\n    if(image.height === undefined)\n      image.height = self.options.pinned_height;\n\n    // Define a default position for every image.\n    if(image.x === undefined)\n    {\n      image.x = self._getDefaultXPosition(image.index, image.width);\n    }\n    if(image.y === undefined)\n    {\n      image.y = self._getDefaultYPosition(image.index, image.height);\n    }\n\n    var frame = self.image_layer.select(\"g.\" + image.image_class + \"[data-uri='\" + image.uri + \"']\");\n\n    // Create the image ...\n    var svgImage = frame.append(\"image\")\n      .attr(\"class\", \"image\")\n      .attr(\"xlink:href\", image_url)\n      .attr(\"x\", 0)\n      .attr(\"y\", 0)\n      .attr(\"width\", image.width)\n      .attr(\"height\", image.height)\n      .attr(\"data-ratio\", image.width / image.height)\n      ;\n\n    // Create a resize handle\n    var resize_handle = frame.append(\"g\")\n      .attr(\"class\", \"resize-handle\")\n      .attr('transform', \"translate(\" + (image.width-9) + \", \" + (image.height-9) + \")\")\n      .call(\n        d3.behavior.drag()\n          .on('drag', function(){\n            //console.log(\"resize drag\");\n            // Make sure mouse is inside svg element\n            if( 0 <= d3.event.y && d3.event.y <= self.options.height && 0 <= d3.event.x && d3.event.x <= self.options.width ){\n              var frame = d3.select(this.parentNode);\n              var theImage = frame.select(\"image.image\");\n              var width = Number(theImage.attr(\"width\"));\n              var height = Number(theImage.attr(\"height\"));\n              var theRectangle = frame.select(\"rect.outline\");\n              var theHandle = d3.select(this);\n              var theLine = frame.select(\"line.leader\");\n              var thePin = frame.select('.pin-button');\n              var ratio = Number(theImage.attr(\"data-ratio\"));\n              var newWidth, newHeight;\n              var x = d3.event.x;\n              var y = d3.event.y;\n              var min = 50;\n              if(x < min)\n                x = min;\n              if(y < min)\n                y = min;\n              newWidth = x;\n              newHeight = newWidth / ratio;\n              if(newHeight > y) {\n                newHeight = y;\n                newWidth = newHeight * ratio;\n              }\n              theImage.attr(\"width\", newWidth);\n              theImage.attr(\"height\", newHeight);\n              theRectangle.attr(\"width\", newWidth+1);\n              theRectangle.attr(\"height\", newHeight+1);\n              theHandle.attr('transform', \"translate(\" + (newWidth-9) + \", \" + (newHeight-9) + \")\");\n              thePin.attr('transform',  'translate(' + (newWidth-20) + ',0)');\n              theLine.attr(\"x1\", (newWidth / 2));\n              theLine.attr(\"y1\", (newHeight / 2));\n\n            }\n          })\n          .on(\"dragstart\", function() {\n            //console.log(\"resize dragstart\");\n            self.state = \"resizing\";\n            d3.selectAll([this.parentNode, d3.select(\"#scatterplot\").node()]).classed(\"resizing\", true);\n            d3.event.sourceEvent.stopPropagation(); // silence other listeners\n            // Reset tracking of hover image if we are starting to drag a hover image\n            var frame = d3.select(this.parentNode);\n            if(frame.classed(\"hover-image\"))\n            {\n              self.opening_image = null;\n              if(self.close_hover_timer)\n              {\n                window.clearTimeout(self.close_hover_timer);\n                self.close_hover_timer = null;\n              }\n              frame.classed(\"hover-image\", false).classed(\"open-image\", true);\n              image.image_class = \"open-image\";\n\n              // Remove openHover class tag from any points that might have it\n              self.datum_layer.selectAll(\"circle.openHover\")\n                .classed(\"openHover\", false)\n                ;\n            }\n          })\n          .on(\"dragend\", function() {\n            //console.log(\"resize dragend\");\n            d3.selectAll([this.parentNode, d3.select(\"#scatterplot\").node()]).classed(\"resizing\", false);\n            self.state = \"\";\n            self._sync_open_images();\n          })\n      )\n      .on(\"mousedown\", function(){\n        //console.log(\"resize mousedown\");\n        //d3.event.stopPropagation(); // silence other listeners\n      })\n      .on(\"mouseup\", function(){\n        //console.log(\"resize mouseup\");\n        //d3.event.stopPropagation(); // silence other listeners\n      })\n      ;\n\n    resize_handle.append(\"path\")\n      .attr(\"d\", \"M0,8 L8,0 M4,8 L8,4\")\n      .style(\"stroke\", \"#878787\")\n      .style(\"stroke-width\", 1)\n      .style(\"pointer-events\", \"none\")\n      ;\n\n    resize_handle.append(\"rect\")\n      .attr(\"class\", \"resize-handle-mousetarget\")\n      .attr(\"width\", 10)\n      .attr(\"height\", 10)\n      .attr(\"fill\", \"transparent\")\n      ;\n\n    // Create a close button ...\n    var close_button = frame.append(\"g\")\n      .attr(\"class\", \"close-button\");\n    close_button.append(\"rect\")\n      .attr(\"x\", 5)\n      .attr(\"y\", 5)\n      .attr(\"width\", 16)\n      .attr(\"height\", 16)\n      .attr(\"rx\", 2)\n      .attr(\"ry\", 2)\n      .style(\"fill\", \"rgba(0%,0%,0%,0.2)\")\n      .on(\"mousedown\", function(){\n        //console.log(\"close button mousedown\");\n        d3.event.stopPropagation(); // silence other listeners\n      })\n      .on(\"mouseup\", function(){\n        //console.log(\"close button mouseup\");\n        d3.event.stopPropagation(); // silence other listeners\n      })\n      .on(\"click\", function()\n      {\n        //console.log(\"close button click\");\n        d3.event.stopPropagation(); // silence other listeners\n        var frame = d3.select(d3.event.target.parentNode.parentNode);\n        frame.remove();\n        self._sync_open_images();\n      })\n      ;\n\n    close_button.append(\"path\")\n      .attr(\"d\", \"M\" + (8) + \" \" + (8) + \" l10 10 m0 -10 l-10 10\")\n      .style(\"stroke\", \"rgba(100%,100%,100%, 0.8)\")\n      .style(\"stroke-width\", 3)\n      .style(\"pointer-events\", \"none\")\n      ;\n\n    // Create a pin button ...\n    var pin_button = frame.append(\"g\")\n      .attr('class', 'pin-button')\n      .attr('transform', \"translate(\" + (image.width-20) + \",0)\");\n\n    pin_button.append(\"image\")\n      .attr(\"class\", \"pin-icon\")\n      .attr(\"x\", 2)\n      .attr(\"y\", 2)\n      .attr(\"width\", 16)\n      .attr(\"height\", 16)\n      .attr(\"xlink:href\", pin)\n      .on(\"mousedown\", function(){\n        //console.log(\"pin button mousedown\");\n        d3.event.stopPropagation(); // silence other listeners\n      })\n      .on(\"mouseup\", function(){\n        //console.log(\"pin button mouseup\");\n        d3.event.stopPropagation(); // silence other listeners\n      })\n      .on(\"click\", function()\n      {\n        d3.event.stopPropagation(); // silence other listeners\n        // Reset tracking of hover image\n        self.opening_image = null;\n        if(self.close_hover_timer)\n        {\n          window.clearTimeout(self.close_hover_timer);\n          self.close_hover_timer = null;\n        }\n\n        // Remove openHover class tag from any points that might have it\n        self.datum_layer.selectAll(\"circle.openHover\")\n          .classed(\"openHover\", false)\n          ;\n\n        var frame = d3.select(d3.event.target.parentNode.parentNode);\n        var theImage = frame.select(\"image.image\");\n        var theRectangle = frame.select(\"rect.outline\");\n        var theHandle = frame.select(\"g.resize-handle\");\n        var theLine = frame.select(\"line.leader\");\n        var thePin = frame.select('.pin-button');\n        frame.classed(\"hover-image\", false)\n          .classed(\"open-image\", true)\n          ;\n\n        // Adjust image position\n        var imageWidth = self.options.pinned_width;\n        var imageHeight = self.options.pinned_height;\n\n        var x = self._getDefaultXPosition(image.index, imageWidth);\n        var y = self._getDefaultYPosition(image.index, imageHeight);\n\n        frame\n          .attr(\"data-transx\", x)\n          .attr(\"data-transy\", y)\n          .attr('transform', \"translate(\" + x + \", \" + y + \")\")\n          ;\n\n        // Adjust image size\n        theImage.attr(\"width\", imageWidth);\n        theImage.attr(\"height\", imageHeight);\n        theRectangle.attr(\"width\", imageWidth+1);\n        theRectangle.attr(\"height\", imageHeight+1);\n        theHandle.attr('transform', \"translate(\" + (imageWidth-9) + \", \" + (imageHeight-9) + \")\");\n        thePin.attr('transform', 'translate(' + (imageWidth-20) + ',0)');\n\n        // Adjust line\n        theLine\n          .attr(\"x1\", (imageWidth / 2))\n          .attr(\"y1\", (imageHeight / 2))\n          .attr(\"x2\", image.target_x - Number(frame.attr(\"data-transx\")))\n          .attr(\"y2\", image.target_y - Number(frame.attr(\"data-transy\")))\n          ;\n\n        self._sync_open_images();\n      })\n      ;\n\n    if(!image.no_sync)\n      self._sync_open_images();\n    self._open_images(images.slice(1));\n    return;\n  }\n\n  if(!self.login_open)\n  {\n    self.login_open = true;\n    var uri = URI(image.uri);\n    self.remotes.get_remote({\n      hostname: uri.hostname(),\n      title: \"Login to \" + uri.hostname(),\n      message: \"Loading \" + uri.pathname(),\n      cancel: function() {\n        self.login_open = false;\n      },\n      success: function(hostname) {\n        var xhr = new XMLHttpRequest();\n        var api = \"/file\";\n\n        xhr.image = image;\n        //Double encode to avoid cherrypy's auto unencode in the controller\n        xhr.open(\"GET\", api_root + \"remotes/\" + hostname + api + uri.pathname(), true);\n        xhr.responseType = \"arraybuffer\";\n        xhr.onload = function(e) {\n          // If we get 404, the remote session no longer exists because it timed-out.\n          // If we get 500, there was an internal error communicating to the remote host.\n          // Either way, delete the cached session and create a new one.\n          if(this.status == 404 || this.status == 500) {\n            self.remotes.delete_remote(uri.hostname());\n            self._open_images(images);\n            return;\n          }\n          // If we get 400, it means that the session is good and we're\n          // communicating with the remote host, but something else went wrong\n          // (probably file permissions issues).\n          if(this.status == 400) {\n            console.log(this);\n            console.log(this.getAllResponseHeaders());\n            var message = this.getResponseHeader(\"slycat-message\");\n            var hint = this.getResponseHeader(\"slycat-hint\");\n\n            if(message && hint)\n            {\n              window.alert(message + \"\\n\\n\" + hint);\n            }\n            else if(message)\n            {\n              window.alert(message);\n            }\n            else\n            {\n              window.alert(\"Error loading image \" + this.image.uri + \": \" + this.statusText);\n            }\n            return;\n          } else {\n            // We received the image, so put it in the cache and start-over.\n            var array_buffer_view = new Uint8Array(this.response);\n            var blob = new Blob([array_buffer_view], {type:this.getResponseHeader('content-type')});\n            self.options.image_cache[image.uri] = blob;\n            self._open_images(images);\n            return;\n          }\n        }\n\n        xhr.send();\n        self.login_open = false;\n      },\n    })\n  }\n},\n\n_close_hidden_simulations: function()\n{\n  var self = this;\n  $(\"g.image-frame\")\n    .filter(function(){\n      return $.inArray($(this).data(\"index\"), self.options.filtered_indices) == -1\n    })\n    .remove()\n    ;\n},\n\n_schedule_hover_canvas: function(e)\n{\n  var self = this;\n  self._cancel_hover_canvas();\n\n  // Disable hovering whenever anything else is going on ...\n  if(self.state != \"\")\n    return;\n\n  self.hover_timer_canvas = window.setTimeout( function(){ self._open_hover_canvas(e) }, self.options.hover_time );\n},\n\n_open_hover_canvas: function(e)\n{\n  var self = this;\n\n  // Disable hovering whenever anything else is going on ...\n  if(self.state != \"\")\n    return;\n\n  var x = self._offsetX(e),\n      y = self._offsetY(e),\n      filtered_indices = self.options.filtered_indices,\n      filtered_selection = self.options.filtered_selection,\n      square_size = self.options.canvas_square_size,\n      shift = (square_size / 2),\n      selected_square_size = self.options.canvas_selected_square_size,\n      selected_shift = (selected_square_size / 2),\n      index;\n\n  var selected_match = self._open_first_match(x, y, filtered_selection, selected_shift, selected_square_size);\n  if(!selected_match)\n    self._open_first_match(x, y, filtered_indices, shift, square_size);\n},\n\n_open_first_match: function(x, y, indices, shift, size)\n{\n  var self = this,\n      xvalues = self.options.x,\n      yvalues = self.options.y;\n  for(var i = indices.length-1; i > -1; i-- )\n  {\n    var index = indices[i];\n    var x1 = Math.round( self.x_scale( xvalues[index] ) ) - shift;\n    var y1 = Math.round( self.y_scale( yvalues[index] ) ) - shift;\n    var x2 = x1 + size;\n    var y2 = y1 + size;\n\n    if(x >= x1 && x <= x2 && y >= y1 && y <= y2)\n    {\n      // Disable hovering when there is no uri\n      if(self.options.images[index].trim() != \"\")\n      {\n        self._open_hover(index);\n      }\n\n      return true;\n    }\n  }\n  return false;\n},\n\n_cancel_hover_canvas: function()\n{\n  var self = this;\n\n  if(self.hover_timer_canvas)\n  {\n    window.clearTimeout(self.hover_timer_canvas);\n    self.hover_timer_canvas = null;\n  }\n},\n\n_schedule_hover: function(image_index)\n{\n  var self = this;\n\n  // Disable hovering whenever anything else is going on ...\n  if(self.state != \"\")\n    return;\n\n  // Disable hovering when there are no image columns\n  if(self.options.images == null || self.options.images.length == 0)\n    return;\n\n  // Disable hovering when there is no uri\n  if(self.options.images[self.options.indices[image_index]].trim() == \"\")\n    return;\n\n  // // Disable hovering on points that already have open imges ...\n  // var uri = self.options.images[self.options.indices[image_index]];\n  // if($(\".open-image[data-uri='\" + uri + \"']\").size() != 0)\n  //   return;\n\n  // Cancel any pending hover ...\n  self._cancel_hover();\n\n  // Start the timer for the new hover ...\n  self.hover_timer = window.setTimeout(function() { self._open_hover(image_index); }, self.options.hover_time);\n},\n\n_cancel_hover: function()\n{\n  var self = this;\n  if(self.hover_timer)\n  {\n    window.clearTimeout(self.hover_timer);\n    self.hover_timer = null;\n  }\n},\n\n_open_hover: function(image_index)\n{\n  var self = this;\n\n  // Verify that we don't already have an open hover for the associated point\n  if( self.datum_layer.select(\"circle.openHover[data-index='\" + image_index + \"']\").empty() )\n  {\n    self._close_hover();\n    self.opening_image = image_index;\n\n    var width = self.svg.attr(\"width\");\n    var height = self.svg.attr(\"height\");\n    var hover_width = Math.min(width, height) * 0.85;\n    var hover_height = Math.min(width, height) * 0.85;\n\n    self._open_images([{\n      index : self.options.indices[image_index],\n      uri : self.options.images[self.options.indices[image_index]].trim(),\n      image_class : \"hover-image\",\n      x : Math.min(self.x_scale(self.options.x[image_index]) + 10, width  - hover_width  - self.options.border - 10),\n      y : Math.min(self.y_scale(self.options.y[image_index]) + 10, height - hover_height - self.options.border - 10),\n      width : hover_width,\n      height : hover_height,\n      target_x : self.x_scale(self.options.x[image_index]),\n      target_y : self.y_scale(self.options.y[image_index]),\n      no_sync : true,\n    }]);\n\n    // self.close_hover_timer = window.setTimeout(function() {self._hover_timeout(image_index, 0);}, 1000);\n  }\n},\n\n_hover_timeout: function(image_index, time)\n{\n  var self = this;\n  var checkInterval = 50;\n  var cutoff = 1000;\n\n  if(time > cutoff)\n  {\n    self._close_hover();\n    return;\n  }\n  else if(self._is_hovering(image_index))\n  {\n    self.close_hover_timer = window.setTimeout(function(){self._hover_timeout(image_index, 0);}, checkInterval);\n  }\n  else\n  {\n    self.close_hover_timer = window.setTimeout(function(){self._hover_timeout(image_index, time+checkInterval);}, checkInterval);\n  }\n},\n\n_is_hovering: function(image_index)\n{\n  var self = this;\n  var hoverEmpty = self.image_layer.selectAll(\".hover-image[data-index='\" + image_index + \"']:hover\").empty();\n  var circleEmpty = self.datum_layer.selectAll(\"circle[data-index='\" + image_index + \"']:hover\").empty();\n  var selectedCircleEmpty = self.selected_layer.selectAll(\"circle[data-index='\" + image_index + \"']:hover\").empty();\n\n  return !(hoverEmpty && circleEmpty && selectedCircleEmpty);\n},\n\n_close_hover: function()\n{\n  var self = this;\n\n  self.opening_image = null;\n\n  if(self.close_hover_timer)\n  {\n    window.clearTimeout(self.close_hover_timer);\n    self.close_hover_timer = null;\n  }\n\n  // Cancel any pending hover ...\n  self._cancel_hover();\n\n  // Close any current hover images ...\n  self.image_layer.selectAll(\".hover-image\").remove();\n\n  // Remove openHover class tag from any points that might have it\n  self.datum_layer.selectAll(\"circle.openHover\")\n    .classed(\"openHover\", false)\n    ;\n},\n\n_offsetX: function(e)\n{\n  return e.pageX - e.currentTarget.getBoundingClientRect().left - $(document).scrollLeft();\n},\n\n_offsetY: function(e)\n{\n  return e.pageY - e.currentTarget.getBoundingClientRect().top - $(document).scrollTop();\n},\n\npin: function(simulations)\n{\n  var self = this;\n\n  // Set default image size\n  var imageWidth = self.options.pinned_width;\n  var imageHeight = self.options.pinned_height;\n\n  var images = [];\n  simulations.forEach(function(image_index, loop_index)\n  {\n    images.push({\n      index : self.options.indices[image_index],\n      uri : self.options.images[self.options.indices[image_index]].trim(),\n      image_class : \"open-image\",\n      x : self._getDefaultXPosition(image_index, imageWidth),\n      y : self._getDefaultYPosition(image_index, imageHeight),\n      width : imageWidth,\n      height : imageHeight,\n      target_x : self.x_scale(self.options.x[image_index]),\n      target_y : self.y_scale(self.options.y[image_index]),\n      });\n  });\n  self._open_images(images);\n},\n});","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABmJLR0QA/wD/AP+gvaeTAAAAs0lEQVQ4jdXRsWoCQRgE4A9RLMRCsFHsrO2jb5E6PoaIZTpLa/FZrJJ30IT0gaSwsBBB0OLu4LLe6WllBqbZf2b+2V3+Ewao3Wvu44B31G81d/CJY8y3IiFNPOEV3ylzwmUiLGeYv9C9suDn0nCcsTHhHs/X6sMoJ2BSxAwVfATmHRqhsJQTMEUVs9TZGptQmPWIL2ihhy1WmIt+4wxhQDtuNYxrw0J0pd+ctn9QLSJ6LJwAXgcqz7/uBCYAAAAASUVORK5CYII=\"","/* Copyright (c) 2013, 2018 National Technology and Engineering Solutions of Sandia, LLC . Under the terms of Contract  DE-NA0003525 with National Technology and Engineering Solutions of Sandia, LLC, the U.S. Government  retains certain rights in this software. */\n\nimport api_root from \"js/slycat-api-root\";\nimport * as dialog from \"js/slycat-dialog\";\nimport \"jquery-ui\";\n\n$.widget(\"parameter_image.controls\",\n{\n  options:\n  {\n    mid : null,\n    model_name : null,\n    aid : null,\n    metadata : null,\n    // cluster_index : null,\n    \"x-variable\" : null,\n    \"y-variable\" : null,\n    \"image-variable\" : null,\n    \"color-variable\" : null,\n    \"auto-scale\" : true,\n    // clusters : [],\n    x_variables : [],\n    y_variables : [],\n    image_variables : [],\n    color_variables : [],\n    rating_variables : [],\n    category_variables : [],\n    selection : [],\n    hidden_simulations : [],\n    indices : [],\n  },\n\n  _create: function()\n  {\n    var self = this;\n\n    // if(self.options.clusters.length > 0)\n    // {\n    //   this.cluster_label = $(\"<label for='cluster-switcher'>Cluster:</label>\")\n    //     .appendTo(this.element)\n    //     ;\n    //   this.cluster_select = $(\"<select id='cluster-switcher' name='cluster-switcher' />\")\n    //     .change(function(){\n    //       self.element.trigger(\"cluster-selection-changed\", this.value);\n    //     })\n    //     .appendTo(this.element)\n    //     ;\n    // }\n\n    this.x_label = $(\"<label for='x-axis-switcher'>X Axis:</label>\")\n      .appendTo(this.element)\n      ;\n    this.x_select = $(\"<select id='x-axis-switcher' name='x-axis-switcher' />\")\n      .change(function(){\n        self.element.trigger(\"x-selection-changed\", this.value);\n      })\n      .appendTo(this.element)\n      ;\n\n    this.y_label = $(\"<label for='y-axis-switcher'>Y Axis:</label>\")\n      .appendTo(this.element)\n      ;\n    this.y_select = $(\"<select id='y-axis-switcher' name='y-axis-switcher' />\")\n      .change(function(){\n        self.element.trigger(\"y-selection-changed\", this.value);\n      })\n      .appendTo(this.element)\n      ;\n\n    if(this.options.image_variables != null && this.options.image_variables.length > 0)\n    {\n      this.images_label = $(\"<label for='images-switcher'>Image Set:</label>\")\n        .appendTo(this.element)\n        ;\n      this.images_select = $(\"<select id='images-switcher' name='images-switcher' />\")\n        .change(function(){\n          self.element.trigger(\"images-selection-changed\", this.value);\n        })\n        .appendTo(this.element)\n        ;\n    }\n\n    this.color_label = $(\"<label for='color-variable-switcher'>Point Color:</label>\")\n      .appendTo(this.element)\n      ;\n    this.color_select = $(\"<select id='color-variable-switcher' name='color-variable-switcher' />\")\n      .change(function(){\n        self.element.trigger(\"color-selection-changed\", this.value);\n      })\n      .appendTo(this.element)\n      ;\n\n    this.selection_label = $(\"<label for='selection-control'>Selection:</label>\")\n      .appendTo(this.element)\n      ;\n    this.selection_select = $(\"<select id='selection-control' name='selection-control' />\")\n      .change(function(){\n\n        var selectedOption = $('option:selected', this);\n        var label = selectedOption.attr(\"label\");\n        var text = selectedOption.text();\n        var value = this.value;\n        if(label == 'set' || label == 'clear')\n        {\n          var variableLabel = selectedOption.parent().attr('label');\n          if(label == 'set')\n          {\n            openSetValueDialog(variableLabel, value);\n          }\n          else if(label == 'clear')\n          {\n            openClearValueDialog(variableLabel, value);\n          }\n\n        }\n        else if(value == 'hide')\n        {\n          self.element.trigger(\"hide-selection\", self.options.selection);\n        }\n        else if(value == 'show')\n        {\n          self.element.trigger(\"show-selection\", self.options.selection);\n        }\n        else if(value == 'pin')\n        {\n          self.element.trigger(\"pin-selection\", self.options.selection);\n        }\n        this.selectedIndex = 0;\n      })\n      .appendTo(this.element)\n      ;\n\n    this.show_all_button = $(\"<button>Show All</button>\")\n      .click(function(){\n        self.element.trigger(\"show-all\");\n      })\n      .appendTo(this.element)\n      ;\n    \n    this.auto_scale = $(\"<input id='auto-scale-option' name='auto-scale-option' value='auto-scale' type='checkbox' checked='true'>\")\n      .change(function(){\n        self.element.trigger(\"auto-scale\", this.checked);\n      })\n      .appendTo(this.element)\n      ;\n\n    this.auto_scale_label = $(\"<label for='auto-scale-option'>Auto Scale</label>\")\n      .appendTo(this.element)\n      ;\n\n    this.csv_button = $(\"<button>Download Data Table</button>\")\n    \t.click(function(){\n        if (self.options.selection.length == 0 && self.options.hidden_simulations.length == 0) {\n    \t    self._write_data_table();\n    \t  } else {\n          openCSVSaveChoiceDialog();\n        }\n    \t})\n    \t.appendTo(this.element)\n    \t;\n\n    $('#set-value-form').dialog({\n      modal: true,\n      autoOpen: false,\n      buttons: {\n        'Apply': function() {\n          //$('#mainForm input#target').val( $(this).find('#widgetName').val() );\n          var variableIndex = $('input#variable-index', this).val();\n          var value = $('input#value', this).val().trim();\n          var numeric = self.options.metadata[\"column-types\"][variableIndex] != \"string\";\n          var valueValid = value.length > 0;\n          if( valueValid && numeric && isNaN(Number(value)) ) {\n            valueValid = false;\n          }\n          if(valueValid) {\n            self.element.trigger(\"set-value\", {\n              selection : self.options.selection, \n              variable : variableIndex, \n              value : numeric ? value : '\"' + value + '\"',\n            });\n            $(this).dialog('close');\n          } else {\n            var message = \"Please enter a value.\";\n            if(numeric)\n              message = \"Please enter a numeric value.\";\n            $('.dialogErrorMessage', this).text(message);\n          }\n          \n        },\n        'Cancel': function() {\n          $(this).dialog('close');\n        },\n      },\n    });\n\n    $('#clear-value-form').dialog({\n      modal: true,\n      autoOpen: false,\n      buttons: {\n        'Clear': function() {\n          var variableIndex = $('input#variable-index', this).val();\n          self.element.trigger(\"set-value\", {selection : self.options.selection, variable : variableIndex, value : NaN});\n          $(this).dialog('close');\n        },\n        'Cancel': function() {\n          $(this).dialog('close');\n        },\n      },\n    });\n\n    self.save_choice_buttons = {\n      'Save The Whole Table': function() {\n         self._write_data_table();\n        //$(this)._write_data_table();  //what's the diff with above?\n        $(this).dialog('close');\n      },\n      'Save Visible Rows': function() {\n         self._write_data_table( self._filterIndices() );\n        //$(this)._write_data_table();  //what's the diff with above?\n        $(this).dialog('close');\n      },\n      'Save Selected Rows': function() {\n        self._write_data_table( self.options.selection );\n        $(this).dialog('close');\n      },\n      'Cancel': function() {\n        $(this).dialog('close');\n      },\n    };\n\n    $('#csv-save-choice-form').dialog({\n      modal: true,\n      autoOpen: false,\n      buttons: self.save_choice_buttons,\n    });\n\n\n    function openSetValueDialog(variable, variableIndex){\n      $(\"#set-value-form #set-value-form-variable\").text(variable);\n      $(\"#set-value-form input\").attr('value','');\n      $(\"#set-value-form input#variable-index\").attr('value', variableIndex);\n      $(\"#set-value-form .dialogErrorMessage\").empty();\n      $(\"#set-value-form\").dialog(\"open\");\n    }\n    function openClearValueDialog(variable, variableIndex){\n      $(\"#clear-value-form #clear-value-form-variable\").text(variable);\n      $(\"#set-value-form input\").attr('value','');\n      $(\"#clear-value-form input#variable-index\").attr('value', variableIndex);\n      $(\"#clear-value-form\").dialog(\"open\");\n    }\n    function openCSVSaveChoiceDialog(){\n      var txt = \"\";\n\n      if(self.options.selection.length > 0)\n      {\n        txt += \"You have \" + self.options.selection.length + \" rows selected. \";\n      }\n      if(self.options.hidden_simulations.length > 0)\n      {\n        var visibleRows = self.options.metadata['row-count'] - self.options.hidden_simulations.length;\n        txt += \"You have \" + visibleRows + \" rows visible. \";\n      }\n\n      txt += \"What would you like to do?\";\n      $(\"#csv-save-choice-form #csv-save-choice-label\").text(txt);\n\n      var buttons = $.extend({}, self.save_choice_buttons);\n      if(self.options.selection.length == 0)\n      {\n        delete buttons[\"Save Selected Rows\"];\n      }\n      if(self.options.hidden_simulations.length == 0)\n      {\n        delete buttons[\"Save Visible Rows\"];\n      }\n      $(\"#csv-save-choice-form\").dialog(\"option\", \"buttons\", buttons);\n\n      $(\"#csv-save-choice-form\").dialog(\"open\");\n    }\n\n    // if(self.options.clusters.length > 0)\n    // {\n    //   self._set_clusters();\n    // }\n    self._set_x_variables();\n    self._set_y_variables();\n    self._set_image_variables();\n    self._set_color_variables();\n    self._set_auto_scale();\n    self._set_selection_control();\n    self._set_show_all();\n  },\n\n\n  _write_data_table: function(selectionList)\n  {\n    var self = this;\n    $.ajax(\n    {\n      type : \"POST\",\n      url : api_root + \"models/\" + self.options.mid + \"/arraysets/\" + self.options.aid + \"/data\",\n      data: JSON.stringify({\"hyperchunks\": \"0/.../...\"}),\n      contentType: \"application/json\",\n      success : function(result)\n      {\n        self._write_csv( self._convert_to_csv(result, selectionList), self.options.model_name + \"_data_table.csv\" );\n      },\n      error: function(request, status, reason_phrase)\n      {\n        window.alert(\"Error retrieving data table: \" + reason_phrase);\n      }\n    });\n  },\n\n  _write_csv: function(csvData, defaultFilename)\n  {\n    var self = this;\n    var D = document;\n    var a = D.createElement(\"a\");\n    var strMimeType = \"text/plain\";\n    var defaultFilename = defaultFilename || \"slycatDataTable.csv\";\n\n    //build download link:\n    a.href = \"data:\" + strMimeType + \";charset=utf-8,\" + encodeURIComponent(csvData);  //encodeURIComponent() handles all special chars\n\n    if ('download' in a) { //FF20, CH19\n      a.setAttribute(\"download\", defaultFilename);\n      a.innerHTML = \"downloading...\";\n      D.body.appendChild(a);\n      setTimeout(function() {\n        var e = D.createEvent(\"MouseEvent\");\n\te.initMouseEvent(\"click\", true, false, window, 0, 0, 0, 0, 0, false, false, false, false, 0, null);\n\ta.dispatchEvent(e);\n\tD.body.removeChild(a);\n      }, 66);\n      return true;\n    } else {   // end if('download' in a)\n      console.log(\"++ firefox/chrome detect failed\");\n    }\n/*\n    if (window.MSBlobBuilder) { // IE10\n      console.log( \"doing the IE10 stuff\" );\n      var bb = new MSBlobBuilder();\n      bb.append(strData);\n      return navigator.msSaveBlob(bb, strFileName);\n    }\n\n    //do iframe dataURL download: (older W3)\n    console.log( \"doing the older W3 stuff\" );\n    var f = D.createElement(\"iframe\");\n    D.body.appendChild(f);\n    f.src = \"data:\" + (A[2] ? A[2] : \"application/octet-stream\") + (window.btoa ? \";base64\" : \"\") + \",\" + (window.btoa ? window.btoa : escape)(strData);\n    setTimeout(function() {\n      D.body.removeChild(f);\n    }, 333);\n    return true;\n*/\n  },\n\n  _convert_to_csv: function(array, sl)\n  {\n    // Note that array.data is column-major:  array.data[0][*] is the first column\n    var self = this;\n    var selectionList = sl || [];\n    var numRows = array[0].length;\n    var numCols = array.length;\n    var rowMajorOutput = \"\";\n    var r, c, value;\n    // add the headers\n    for(c=0; c<numCols; c++) {\n      rowMajorOutput += self.options.metadata[\"column-names\"][c] + \",\";\n    }\n    rowMajorOutput = rowMajorOutput.slice(0, -1); //rmv last comma\n    rowMajorOutput += \"\\n\";\n    // add the data\n    for(r=0; r<numRows; r++) {\n      if(selectionList.length == 0 || selectionList.indexOf(r) > -1)\n      {\n        for(c=0; c<numCols; c++) {\n          value = array[c][r];\n          if(value === null)\n          {\n            value = NaN;\n          }\n          rowMajorOutput += value + \",\";\n        }\n        rowMajorOutput = rowMajorOutput.slice(0, -1); //rmv last comma\n        rowMajorOutput += \"\\n\";\n      }\n    }\n    return rowMajorOutput;\n  },\n\n  // _set_clusters: function()\n  // { \n  //   var self = this;\n  //   this.cluster_select.empty();\n  //   for(var i = 0; i < this.options.clusters.length; i++) {\n  //     $(\"<option />\")\n  //       .text(this.options.clusters[i])\n  //       .attr(\"value\", i)\n  //       .attr(\"selected\", function(){\n  //         return self.options.cluster_index == i ? \"selected\" : false;\n  //       })\n  //       .appendTo(this.cluster_select)\n  //       ;\n  //   }\n  // },\n\n  _set_x_variables: function()\n  { \n    var self = this;\n    this.x_select.empty();\n    for(var i = 0; i < this.options.x_variables.length; i++) {\n      $(\"<option />\")\n        .text(this.options.metadata['column-names'][this.options.x_variables[i]])\n        .attr(\"value\", this.options.x_variables[i])\n        .attr(\"selected\", function(){\n          return self.options[\"x-variable\"] == self.options.x_variables[i] ? \"selected\" : false;\n        })\n        .appendTo(this.x_select)\n        ;\n    }\n  },\n\n  _set_y_variables: function()\n  { \n    var self = this;\n    this.y_select.empty();\n    for(var i = 0; i < this.options.y_variables.length; i++) {\n      $(\"<option />\")\n        .text(this.options.metadata['column-names'][this.options.y_variables[i]])\n        .attr(\"value\", this.options.y_variables[i])\n        .attr(\"selected\", function(){\n          return self.options[\"y-variable\"] == self.options.y_variables[i] ? \"selected\" : false;\n        })\n        .appendTo(this.y_select)\n        ;\n    }\n  },\n\n  _set_image_variables: function()\n  { \n    var self = this;\n    if(this.options.image_variables != null && this.options.image_variables.length > 0)\n    {\n      this.images_select.empty();\n      for(var i = 0; i < this.options.image_variables.length; i++) {\n        $(\"<option />\")\n          .text(this.options.metadata['column-names'][this.options.image_variables[i]])\n          .attr(\"value\", this.options.image_variables[i])\n          .attr(\"selected\", function(){\n            return self.options[\"image-variable\"] == self.options.image_variables[i] ? \"selected\" : false;\n          })\n          .appendTo(this.images_select)\n          ;\n      }\n    }\n    \n  },\n\n  _set_color_variables: function()\n  { \n    var self = this;\n    this.color_select.empty();\n    for(var i = 0; i < this.options.color_variables.length; i++) {\n      $(\"<option />\")\n        .text(this.options.metadata['column-names'][this.options.color_variables[i]])\n        .attr(\"value\", this.options.color_variables[i])\n        .attr(\"selected\", function(){\n          return self.options[\"color-variable\"] == self.options.color_variables[i] ? \"selected\" : false;\n        })\n        .appendTo(this.color_select)\n        ;\n    }\n  },\n\n  _set_auto_scale: function()\n  { \n    var self = this;\n    this.auto_scale.prop(\"checked\", self.options[\"auto-scale\"]);\n  },\n\n  _set_selection_control: function()\n  { \n    var self = this;\n    this.selection_select.empty();\n    // Start with empty option\n    $(\"<option />\")\n      .text(\"Pick Action\")\n      .appendTo(this.selection_select)\n      ;\n\n    // Add options for ratings and categories\n    for(var i = 0; i < this.options.rating_variables.length; i++)\n    {\n      var optgroup = $(\"<optgroup />\")\n        .attr(\"label\", this.options.metadata['column-names'][this.options.rating_variables[i]])\n        .appendTo(this.selection_select)\n        ;\n      $(\"<option />\")\n        .text(\"Set\")\n        .attr(\"value\", this.options.rating_variables[i])\n        .attr(\"label\", \"set\")\n        .appendTo(optgroup)\n        ;\n      // Disabling clear functionality for ratings since it causes problems with nulls\n      // $(\"<option />\")\n      //   .text(\"Clear\")\n      //   .attr(\"value\", this.options.rating_variables[i])\n      //   .attr(\"label\", \"clear\")\n      //   .appendTo(optgroup)\n      //   ;\n    }\n\n    for(var i = 0; i < this.options.category_variables.length; i++)\n    {\n      var optgroup = $(\"<optgroup />\")\n        .attr(\"label\", this.options.metadata['column-names'][this.options.category_variables[i]])\n        .appendTo(this.selection_select)\n        ;\n      $(\"<option />\")\n        .text(\"Set\")\n        .attr(\"value\", this.options.category_variables[i])\n        .attr(\"label\", \"set\")\n        .appendTo(optgroup)\n        ;\n      $(\"<option />\")\n        .text(\"Clear\")\n        .attr(\"value\", this.options.category_variables[i])\n        .attr(\"label\", \"clear\")\n        .appendTo(optgroup)\n        ;\n    }\n      \n    // Finish with global actions\n    var scatterplotOptgroup = $(\"<optgroup />\")\n      .attr(\"label\", \"Scatterplot Points\")\n      .appendTo(this.selection_select)\n      ;\n    $(\"<option />\")\n      .text(\"Hide\")\n      .attr(\"value\", \"hide\")\n      .appendTo(scatterplotOptgroup)\n      ;\n    $(\"<option />\")\n      .text(\"Show\")\n      .attr(\"value\", \"show\")\n      .appendTo(scatterplotOptgroup)\n      ;\n    $(\"<option />\")\n      .text(\"Pin\")\n      .attr(\"value\", \"pin\")\n      .appendTo(scatterplotOptgroup)\n      ;\n\n    // var imagesOptgroup = $(\"<optgroup />\")\n    //   .attr(\"label\", \"Images\")\n    //   .appendTo(this.selection_select)\n    //   ;\n    // $(\"<option />\")\n    //   .text(\"Open\")\n    //   .attr(\"value\", \"open\")\n    //   .appendTo(imagesOptgroup)\n    //   ;\n    // $(\"<option />\")\n    //   .text(\"Close\")\n    //   .attr(\"value\", \"close\")\n    //   .appendTo(imagesOptgroup)\n    //   ;\n    \n\n    // Set state\n    self._set_selection();\n  },\n\n  // _set_selected_cluster: function()\n  // {\n  //   var self = this;\n  //   this.cluster_select.val(self.options.cluster_index);\n  // },\n\n  _set_selected_x: function()\n  {\n    var self = this;\n    this.x_select.val(self.options[\"x-variable\"]);\n  },\n\n  _set_selected_y: function()\n  {\n    var self = this;\n    this.y_select.val(self.options[\"y-variable\"]);\n  },\n\n  _set_selected_image: function()\n  {\n    var self = this;\n    if(self.options[\"image-variable\"] != null && self.options.image_variables.length > 0)\n    {\n      this.images_select.val(self.options[\"image-variable\"]);\n    }\n  },\n\n  _set_selected_color: function()\n  {\n    var self = this;\n    this.color_select.val(self.options[\"color-variable\"]);\n  },\n\n  _set_selection: function()\n  {\n    var self = this;\n    this.selection_select.prop(\"disabled\", this.options.selection.length == 0);\n    this.selection_label.toggleClass(\"disabled\", this.options.selection.length == 0);\n  },\n\n  _set_show_all: function()\n  {\n    var self = this,\n        noneHidden = this.options.hidden_simulations.length == 0;\n    var titleText = 'Show All Hidden Scatterplot Points';\n    if(noneHidden) {\n      titleText = 'There are currently no hidden scatterplot points to show.';\n    }\n    this.show_all_button.prop(\"disabled\", noneHidden);\n    this.show_all_button.attr(\"title\", titleText);\n  },\n\n  // Remove hidden_simulations from indices\n  _filterIndices: function()\n  {\n    var self = this;\n    var indices = self.options.indices;\n    var hidden_simulations = self.options.hidden_simulations;\n    var filtered_indices = self._cloneArrayBuffer(indices);\n    var length = indices.length;\n\n    // Remove hidden simulations and NaNs and empty strings\n    for(var i=length-1; i>=0; i--){\n      var hidden = $.inArray(indices[i], hidden_simulations) > -1;\n      if(hidden) {\n        filtered_indices.splice(i, 1);\n      }\n    }\n\n    return filtered_indices;\n  },\n\n  // Clones an ArrayBuffer or Array\n  _cloneArrayBuffer: function(source)\n  {\n    // Array.apply method of turning an ArrayBuffer into a normal array is very fast (around 5ms for 250K) but doesn't work in WebKit with arrays longer than about 125K\n    // if(source.length > 1)\n    // {\n    //   return Array.apply( [], source );\n    // }\n    // else if(source.length == 1)\n    // {\n    //   return [source[0]];\n    // }\n    // return [];\n\n    // For loop method is much shower (around 300ms for 250K) but works in WebKit. Might be able to speed things up by using ArrayBuffer.subarray() method to make smallery arrays and then Array.apply those.\n    var clone = [];\n    for(var i = 0; i < source.length; i++)\n    {\n      clone.push(source[i]);\n    }\n    return clone;\n  },\n\n  _setOption: function(key, value)\n  {\n    var self = this;\n\n    //console.log(\"sparameter_image.variableswitcher._setOption()\", key, value);\n    this.options[key] = value;\n\n    // if(key == \"cluster_index\")\n    // {\n    //   self._set_selected_cluster();\n    // }\n    if(key == \"x-variable\")\n    {\n      self._set_selected_x();\n    }\n    else if(key == \"y-variable\")\n    {\n      self._set_selected_y();\n    }\n    else if(key == \"image-variable\")\n    {\n      self._set_selected_image();\n    }\n    else if(key == \"color-variable\")\n    {\n      self._set_selected_color();\n    }\n    else if(key == \"image_variables\")\n    {\n      self._set_image_variables();\n    }\n    else if(key == 'x_variables')\n    {\n      self._set_x_variables();\n    }\n    else if(key == 'y_variables')\n    {\n      self._set_y_variables();\n    }\n    else if(key == 'color_variables')\n    {\n      self._set_color_variables();\n    }\n    else if(key == 'selection')\n    {\n      self._set_selection();\n    }\n    else if(key == 'hidden_simulations')\n    {\n      self._set_show_all();\n    }\n  },\n\n});\n","/* Copyright (c) 2013, 2018 National Technology and Engineering Solutions of Sandia, LLC . Under the terms of Contract  DE-NA0003525 with National Technology and Engineering Solutions of Sandia, LLC, the U.S. Government  retains certain rights in this software. */\n\n///////////////////////////////////////////////////////////////////////////////////////////\n// HTML5 DOM dendrogram control, for use with the parameter-image model.\n\nimport api_root from \"js/slycat-api-root\";\nimport d3 from \"js/d3.min\";\nimport * as remotes from \"js/slycat-remotes\";\nimport URI from \"urijs\";\n\n$.widget(\"parameter_image.dendrogram\",\n{\n  options:\n  {\n    clusters:[],\n    cluster: 0,\n    cluster_data:null,\n    collapsed_nodes:null,\n    expanded_nodes:null,\n    selected_nodes:null,\n    color_array: null,\n    colorscale: null,\n    data_table_index_array: null,\n    dendrogram_sort_order: true,\n    highlight: [],\n    hidden_simulations: [],\n    images : [],\n    square_size : 8,\n    square_border_size : 1,\n    selected_square_size : 16,\n    selected_square_border_size : 2,\n    hover_timeout : 1000,\n    image_cache : {},\n    cache_references : [ {} ],\n    // image_cache needs to be shared between dendrogram and scatterplot, thus it is passed inside an array to keep it in sync.\n    // http://api.jqueryui.com/jquery.widget/\n    // All options passed on init are deep-copied to ensure the objects can be modified later without affecting the widget. \n    // Arrays are the only exception, they are referenced as-is. \n    // This exception is in place to support data-binding, where the data source has to be kept as a reference.\n    login_dialog : null,\n  },\n\n  _create: function()\n  {\n    var self = this;\n\n    this.remotes = remotes.create_pool();\n    self.login_open = false;\n\n    self.options.image_cache = self.options.cache_references[0];\n\n    self.preview = $(\"<div id='image-preview'>\")\n      .on(\"mouseover\", function(){\n        self._clear_hover_timer();\n      })\n      .on(\"mouseout\", function(d) {\n        self._close_preview();\n      })\n      .on(\"click\", function(d) {\n        self._close_preview(true);\n      })\n      .appendTo( $(\"#scatterplot-pane\") )\n      ;\n\n    self.preview_image = $(\"<img id='image-preview-image' />\")\n      .appendTo(self.preview)\n      ;\n\n    this._set_cluster();\n  },\n\n  _set_cluster: function()\n  {\n    var self = this;\n    self.container = d3.select(\"#dendrogram-viewer\");\n\n    var cluster_data = this.options.cluster_data;\n    var collapsed_nodes = this.options.collapsed_nodes;\n    var expanded_nodes = this.options.expanded_nodes;\n    var selected_nodes = this.options.selected_nodes;\n\n    var linkage = cluster_data[\"linkage\"];\n    var input_indices = cluster_data[\"input-indices\"];\n    var exemplars = cluster_data[\"exemplars\"];\n    var subtrees = [];\n\n    for(var i=0; i<input_indices.length; i++){\n      subtrees.push({\"node-index\":subtrees.length, leaves:1, exemplar:exemplars[i], selected: false, \"image-index\" : i, \"data-table-index\" : input_indices[i]});\n    }\n    for(var i=0; i<linkage.length; i++){\n      subtrees.push({\"node-index\":subtrees.length, children:[subtrees[linkage[i][0]], subtrees[linkage[i][1]]], leaves:linkage[i][3], exemplar:exemplars[i + input_indices.length], selected: false, \"image-index\" : null, \"data-table-index\" : null});\n    }\n\n    var padding = 20;\n    var diagram_width = this.element.parent().width() - padding - padding - 30;\n    var diagram_height = this.element.parent().height() - padding - padding;\n\n    var layout = d3.layout.cluster()\n      .size([diagram_height, diagram_width]) // Width and height are transposed here because the layout defaults top-to-buttom.\n      .separation(function() { return 1; })\n      ;\n\n    self.container.selectAll(\"g\").remove();\n\n    self.sortControl = $('<div id=\"dendrogram-sort-control\"></div>')\n      .appendTo('#dendrogram-pane')\n      .click(function() {\n        if(!$(this).hasClass(\"selected\")){\n          self.options.dendrogram_sort_order = true;\n          self._set_dendrogram_sort_order_state();\n          self.element.trigger(\"sort-by-dendrogram-order\");\n        }\n      })\n      ;\n    this._set_dendrogram_sort_order_state();\n\n    var vis = self.container.append(\"svg:g\")\n      .attr(\"transform\", \"translate(\" + padding + \",\" + padding + \")\")\n      ;\n\n    var root = subtrees[subtrees.length - 1];\n    self.root = root;\n    root.x0 = diagram_height / 2;\n    root.y0 = 0;\n\n    // Compute the layout once for the entire tree so we can capture the max depth ...\n    var nodes = layout.nodes(root).reverse();\n    var max_depth = -1;\n    nodes.forEach(function(d) { max_depth = Math.max(max_depth, d.depth); });\n\n    // We have collapse/expand/selected node data. Let's go ahead and apply it.\n    if( (collapsed_nodes!=null) || (expanded_nodes!=null) || (selected_nodes!=null) )\n    {\n      nodes.forEach(function(d) { \n        if(selected_nodes != null && selected_nodes.length>0) {\n          if( selected_nodes.indexOf(d[\"node-index\"]) > -1 ) {\n            d.selected = true;\n          }\n        }\n        if( collapsed_nodes && (collapsed_nodes.indexOf(d[\"node-index\"]) > -1) && d.children ) {\n          toggle(d);\n        }\n        else if ( expanded_nodes && (expanded_nodes.indexOf(d[\"node-index\"]) > -1) && d._children ) {\n          toggle(d);\n        }\n      });\n    }\n    // We have no data on expanded / collapsed nodes. Let's go ahead and just show the top four levels.\n    if( (expanded_nodes==null) && (collapsed_nodes==null) ) \n    {\n      // Start showing the top four levels of the tree ...\n      nodes.forEach(function(d, index) { \n        if(d.depth == 3) \n        {\n          toggle(d);\n        }\n      });\n    }\n    // We have no selected node data. Let's select the root node.\n    if(selected_nodes == null)\n    {\n      select_node(self, root, true);\n    } \n    else \n    {\n      // We had selected node data, so let's style them and trigger the node-selection-changed event\n      self._style_selected_nodes();\n      self._color_links();\n      // Find all selected nodes\n      var selection = [];\n      find_selected_nodes(root, selection);\n      self.element.trigger(\"node-selection-changed\", {node:null, skip_bookmarking:true, selection:selection});\n    }\n\n    // Initial update for the diagram ...\n    update_subtree(root, true);\n\n    // Helper function that draws dendrogram links with right-angles.\n    function path(d, i)\n    {\n      if(d.target._children) {\n        return \"M\" + d.source.y + \",\" + d.source.x + \"V\" + d.target.x + \"H\" + (diagram_width);\n      }\n      return \"M\" + d.source.y + \",\" + d.source.x + \"V\" + d.target.x + \"H\" + d.target.y;\n    }\n\n    function find_selected_nodes(d, selection)\n    {\n      if(d.selected)\n        selection.push({\"node-index\" : d[\"node-index\"], \"image-index\" : d[\"image-index\"], \"data-table-index\" : d[\"data-table-index\"]});\n      if(d.children)\n        for(var i=0; i<d.children.length; i++)\n          find_selected_nodes(d.children[i], selection);\n      if(d._children)\n        for(var i=0; i<d._children.length; i++)\n          find_selected_nodes(d._children[i], selection);\n    }\n\n    // Keeping track of already selected nodes becomes too complicated with multi selection\n    //var last_selected_node = null;\n    function select_node(context, d, skip_bookmarking)\n    {\n      // Keeping track of already selected nodes becomes too complicated with multi selection\n      // if(last_selected_node === d)\n      //   return;\n      // last_selected_node = d;\n\n      function select_subtree(d)\n      {\n        d.selected = true;\n        if(d.children)\n          for(var i=0; i<d.children.length; i++)\n            select_subtree(d.children[i]);\n        if(d._children)\n          for(var i=0; i<d._children.length; i++)\n            select_subtree(d._children[i]);\n      }\n\n      // Mark this node and all its children as selected\n      select_subtree(d);\n\n      // Sets the \"selected\" class on all selected nodes, thus coloring the circles in blue\n      context._style_selected_nodes();\n\n      // Colors the lines between the nodes to show what's selected\n      context._color_links();\n\n      // Find all selected nodes\n      var selection = [];\n      find_selected_nodes(root, selection);\n      context.options.selected_nodes = context._getNodeIndexes(selection);\n      \n      context.element.trigger(\"node-selection-changed\", {node:d, skip_bookmarking:skip_bookmarking, selection:selection});\n    }\n\n    function unselect_node(context, d, skip_bookmarking)\n    {\n      function unselect_subtree(d)\n      {\n        d.selected = false;\n        if(d.children)\n          for(var i=0; i<d.children.length; i++)\n            unselect_subtree(d.children[i]);\n        if(d._children)\n          for(var i=0; i<d._children.length; i++)\n            unselect_subtree(d._children[i]);\n      }\n\n      // Mark this node and all its children as unselected\n      unselect_subtree(d);\n\n      // Prunes selected nodes that have been orphaned\n      prune_tree(root);\n\n      // Sets the \"selected\" class on all selected nodes, thus coloring the circles in blue\n      context._style_selected_nodes();\n\n      // Colors the lines between the nodes to show what's selected\n      context._color_links();\n\n      // Find all selected nodes\n      var selection = [];\n      find_selected_nodes(root, selection);\n      context.options.selected_nodes = context._getNodeIndexes(selection);\n\n      context.element.trigger(\"node-selection-changed\", {node:d, skip_bookmarking:skip_bookmarking, selection:selection});\n    }\n\n    function prune_tree(d){\n      if(d.children || d._children) {\n        // This is a branch node\n        if(!d.selected){\n          // Branch node is unselected, so just process its children\n          if(d.children)\n            $.each(d.children,  function(index, subtree) { prune_tree(subtree); })\n          if(d._children)\n            $.each(d._children, function(index, subtree) { prune_tree(subtree); })\n          return false;\n        }\n        else {\n          //Branch node is selected, so process its children and set its selected state accordingly\n          var selected_state = false;\n          var child_selected_state = false;\n          if(d.children)\n            $.each(d.children,  function(index, subtree) { \n              child_selected_state = prune_tree(subtree);\n              selected_state = selected_state || child_selected_state; \n            })\n          if(d._children)\n            $.each(d._children, function(index, subtree) { \n              child_selected_state = prune_tree(subtree);\n              selected_state = selected_state || child_selected_state; \n            })\n          d.selected = selected_state;\n          return selected_state;\n        }\n      }\n      else {\n        // This is a leaf node\n        if(d.selected)\n          return true;\n        else\n          return false;\n      }\n    }\n\n    function update_subtree(source, skip_bookmarking)\n    {\n      var duration = d3.event && d3.event.altKey ? 5000 : 500;\n\n      // Compute the new layout.\n      var nodes = layout.nodes(root).reverse();\n\n      // Normalize for fixed-depth.\n      nodes.forEach(function(d) { if(d.children || d._children) d.y = d.depth * (diagram_width / max_depth); });\n\n      // Update the nodes.\n      var node = vis.selectAll(\"g.node\")\n        .data(nodes, function(d) { return d[\"node-index\"]; })\n        ;\n\n      // Expand all child nodes up to a certain level, collapse all child when level is rached\n      function expandUpToLevel(d, level) {\n        if(d.children) {\n          for(var i = 0; i < d.children.length; i++) {\n            // If this child is at the correct depth and it is expanded, we collapse it\n            if(d.children[i].depth == level && d.children[i].children) {\n              toggle(d.children[i]);\n            } \n            // If this child is above the correct depth and it is collapsed, we expand it and process its children\n            else if(d.children[i].depth < level && d.children[i]._children) {\n              toggle(d.children[i]);\n              expandUpToLevel(d.children[i], level);\n            }\n            // If this child is above the correct depth and it is expanded, we just process its children\n            else if(d.children[i].depth < level && d.children[i].children) {\n              expandUpToLevel(d.children[i], level);\n            }\n          }\n        } \n        // If d has no children, we do nothing\n        else {\n          return;\n        }\n      }\n\n      // Create new nodes at the parent's previous position.\n      var node_enter = node.enter().append(\"svg:g\")\n        .attr(\"class\", \"node\")\n        .classed(\"selected\", function(d) { return d.selected; })\n        .attr(\"transform\", function(d) { return \"translate(\" + source.y0 + \",\" + source.x0 + \")\"; })\n        .style(\"opacity\", 1e-6)\n        ;\n\n      // Triangle\n      var node_subtree = node_enter.append(\"svg:g\")\n        .attr(\"class\", \"subtree\")\n        .style(\"opacity\", 1e-6)\n        .style(\"display\", function(d) { return d.leaves > 1 ? \"inline\" : \"none\"; })\n        .on(\"click\", function(d) {\n          self._close_preview(true);\n          toggle(d); \n          // Change expandThisFar to however deep below the target node you want to expand\n          var expandThisFar = 9999;\n          expandUpToLevel(d, d.depth + expandThisFar);\n          update_subtree(d);\n        })\n        ;\n\n      node_subtree.append(\"svg:path\")\n        .attr(\"class\", \"subtree-glyph\")\n        .attr(\"title\", \"Expand all\")\n        .attr(\"alt\", \"Expand all\")\n        .attr(\"d\", \"M 0 0 L 40 -13 L 40 13 Z\")\n        .style(\"fill\", \"url(#subtree-gradient)\")\n        ;\n\n      // Due to a bug in Firefox, we cannot use css to change the fill style on path.subtree-glyph from above.\n      // Instead we'll use css to display and hide this path.filled-glyph\n      node_subtree.append(\"svg:path\")\n        .attr(\"class\", \"filled-glyph\")\n        .attr(\"title\", \"Expand all\")\n        .attr(\"alt\", \"Expand all\")\n        .attr(\"d\", \"M 0 0 L 40 -13 L 40 13 Z\")\n        .style(\"fill\", \"#7767b0\")\n        ;\n\n      node_subtree.append(\"svg:text\")\n        .attr(\"x\", 28)\n        .attr(\"dy\", \".4em\")\n        .attr(\"text-anchor\", \"middle\")\n        .attr(\"title\", \"Expand all\")\n        .attr(\"alt\", \"Expand all\")\n        .text(function(d) { return d.leaves; })\n        ;\n\n      node_subtree.append(\"svg:text\")\n        .attr(\"x\", -9)\n        .attr(\"dy\", -5)\n        .attr(\"text-anchor\", \"middle\")\n        .text(\"+\")\n        .style(\"fill\", \"black\")\n        .on(\"click\", function(d) {\n          self._close_preview(true);\n          toggle(d);\n          // Change expandThisFar to however deep below the target node you want to expand\n          var expandThisFar = 2;\n          expandUpToLevel(d, d.depth + expandThisFar);\n          update_subtree(d);\n          d3.event.stopPropagation();\n        })\n        ;\n\n      // Circle\n      var node_glyph = node_enter.append(\"svg:g\")\n        .attr(\"class\", \"glyph\")\n        .on(\"click\", function(d) {\n          self._close_preview(true);\n          if(d3.event.ctrlKey || d3.event.metaKey) {\n            if(d.selected) {\n              unselect_node(self, d);\n            } else {\n              select_node(self, d);\n            }\n          } else {\n            // Clear previous selection if user didn't Ctrl+click\n            $.each(subtrees, function(index, subtree) { subtree.selected = false; });\n            select_node(self, d);\n          }\n        })\n        ;\n\n      node_glyph.append(\"svg:circle\")\n        .attr(\"r\", 4.5)\n        .style(\"cursor\", \"pointer\")\n        .style(\"fill\", function(d) { return d.children || d._children ? \"#dbd9eb\" : \"white\"; })\n        ;\n\n      node_glyph.append(\"svg:text\")\n        .attr(\"x\", -9)\n        .attr(\"dy\", 13)\n        .attr(\"text-anchor\", \"middle\")\n        .text(\"–\")\n        .style(\"fill\", \"black\")\n        .style(\"display\", function(d) { return d._children || (!d.children && !d._children) ? \"none\" : \"inline\"; })\n        .on(\"click\", function(d) {\n          self._close_preview(true);\n          toggle(d);\n          update_subtree(d);\n          d3.event.stopPropagation();\n        })\n        ;\n\n      // Square\n      var vertical_lift = - (self.options.square_size / 2) - self.options.square_border_size ;\n      var selected_vertical_lift = - (self.options.selected_square_size / 2) - self.options.selected_square_border_size;\n      var trans_endpoint = \"translate(25, 0)\";\n      var trans_notendpoint = \"translate(65, 0)\";\n\n      var node_square = node_enter.append(\"svg:g\")\n        .attr(\"class\", \"square\")\n        .attr(\"transform\", function(d) { return d.leaves > 1 ? trans_notendpoint : trans_endpoint; }) // Move to the right according to whether it's an endpoint\n        .style(\"opacity\", 1e-6)\n        .style(\"display\", \"none\")\n        ;\n\n      var node_square_rect = node_square.append(\"svg:rect\")\n        .style(\"stroke\", \"black\")\n        .style(\"fill\", function(d, i){\n          if(self.options.colorscale !== null && self.options.color_array != null){\n            var index = d[\"data-table-index\"];\n            if(index != null) {\n              var value = self.options.color_array[index];\n              if(value != null)\n                return self.options.colorscale(value);\n              else\n                return $(\"#color-switcher\").colorswitcher(\"get_null_color\");\n            }\n            else\n              return \"black\";\n          } else {\n            return \"black\";\n          }\n        })\n        .classed(\"nullValue\", function(d, i){\n          if (d[\"data-table-index\"] == null || (d[\"data-table-index\"] != null && self.options.color_array[d[\"data-table-index\"]] !== null))\n            return false;\n          else\n            return true;\n        })\n        .on(\"click\", function(d){\n          self._close_preview(true);\n          self._handle_highlight(d, d3.event, this);\n        })\n        ;\n\n      self._set_highlight();\n\n      // Transition new nodes to their final position.\n      var node_update = node.transition()\n        .duration(duration)\n        .attr(\"transform\", function(d) { \n          return \"translate(\" + (d._children ? (diagram_width - 39) : d.y + 1) + \",\" + d.x + \")\"; // Draws extended horizontal lines for collapsed nodes\n        })\n        .style(\"opacity\", 1.0)\n        ;\n\n      node.classed(\"leaf\", function(d) { return d._children || (!d.children && !d._children); });\n      node.filter(\".leaf\")\n        .on(\"mouseover\", function(d) {\n          self._open_preview(d);\n        })\n        .on(\"mouseout\", function(d) {\n          self._close_preview();\n        })\n        ;\n\n      node_update.select(\".subtree\")\n        .style(\"opacity\", function(d) { return d._children ? 1.0 : 1e-6; })\n        .style(\"display\", function(d) { return d._children ? \"inline\" : \"none\"; })\n        ;\n\n      // Need to re-assign fill style to get around this firefox bug: https://bugzilla.mozilla.org/show_bug.cgi?id=652991\n      // It only seems to affect fill gradients and only when the URI changes, like it does for us with bookmarking.\n      node_update.select(\".subtree-glyph\")\n        .style(\"fill\", \"url(#subtree-gradient)\")\n        ;\n\n      node_update.select(\".square\")\n        .style(\"opacity\", function(d) { return d._children || (!d.children && !d._children) ? 1.0 : 1e-6; })\n        .each(\"end\", function() { d3.select(this).style(\"display\", function(d) { return d._children || (!d.children && !d._children) ? \"inline\" : \"none\"; }); })\n        ;\n\n      node_update.select(\".glyph text\")\n        .style(\"display\", function(d) { return d._children || (!d.children && !d._children) ? \"none\" : \"inline\"; })\n        ;\n      \n      // Transition exiting nodes to the parent's new position.\n      var node_exit = node.exit().transition()\n        .duration(duration)\n        .attr(\"transform\", function(d) { return \"translate(\" + source.y + \",\" + source.x + \")\"; })\n        .style(\"opacity\", 1e-6)\n        .remove()\n        ;\n\n      node_exit.select(\".square\")\n        .each(\"start\", function() { d3.select(this).style(\"display\", \"none\"); })\n        ;\n      \n      // Update the links.\n      var link = vis.selectAll(\"path.link\")\n        .data(layout.links(nodes), function(d) { return d.target[\"node-index\"]; });\n\n      // Enter any new links at the parent's previous position.\n      link.enter().insert(\"svg:path\", \"g\")\n        .attr(\"class\", \"link\")\n        .attr(\"d\", function(d)\n        {\n          var o = {x: source.x0, y: source.y0};\n          return path({source: o, target: o});\n        })\n      .transition()\n        .duration(duration)\n        .attr(\"d\", path);\n\n      // Transition new links to their new position.\n      link.transition()\n        .duration(duration)\n        .attr(\"d\", path);\n\n      // Transition exiting links to the parent's new position.\n      link.exit().transition()\n        .duration(duration)\n        .attr(\"d\", function(d)\n        {\n          var o = {x: source.x, y: source.y};\n          return path({source: o, target: o});\n        })\n        .remove()\n        ;\n\n      self._color_links();\n\n      // Stash the old positions for transition.\n      nodes.forEach(function(d)\n      {\n        d.x0 = d.x;\n        d.y0 = d.y;\n      });\n\n      // Bookmark expanded and collapsed nodes\n      if(!skip_bookmarking){\n        var expanded = [];\n        var collapsed = [];\n        function findExpandedAndCollapsedNodes(d){\n          // If this node is expanded, add its node-index to the expanded array\n          if(d.children) {\n            expanded.push(d[\"node-index\"]);\n            // Recursively call this function for each child to capture any collapsed and expanded ones\n            for(var i = 0; i < d.children.length; i++) {\n              findExpandedAndCollapsedNodes(d.children[i]);\n            }\n          }\n          // Otherwise if this node is collapsed, add its node-index to the collapsed array\n          else if(d._children) {\n            collapsed.push(d[\"node-index\"]);\n          }\n        }\n        findExpandedAndCollapsedNodes(root);\n        self.options.expanded_nodes = expanded;\n        self.options.collapsed_nodes = collapsed;\n        self.element.trigger(\"expanded-collapsed-nodes-changed\", {expanded:expanded, collapsed:collapsed});\n      }\n    }\n\n    // Toggle children.\n    function toggle(d)\n    {\n      if(d.children)\n      {\n        d._children = d.children;\n        d.children = null;\n      }\n      else\n      {\n        d.children = d._children;\n        d._children = null;\n      }\n\n      self.element.trigger(\"node-toggled\", d);\n    }\n  },\n\n  _clear_hover_timer: function()\n  {\n    var self = this;\n    if(self.hover_timer)\n    {\n      window.clearTimeout(self.hover_timer);\n      self.hover_timer = null;\n    }\n  },\n\n  _open_preview: function(image)\n  {\n    var self = this;\n\n    // Do nothing if we don't have an exemplar to show\n    if(image.exemplar == undefined)\n    {\n      return;\n    }\n\n    self._clear_hover_timer();\n\n    var image_uri = self.options.images[image.exemplar];\n\n    // Open new preview only if we are not showing it already\n    if(self.target_image != image_uri)\n    {\n      self.target_image = image_uri;\n      self.preview_image.hide();\n      self.preview.show();\n      self._display_image(image_uri);\n    }\n\n  },\n\n  _display_image: function(image_uri)\n  {\n    var self = this;\n\n    // If the image is in the cache, display it\n    if(image_uri in self.options.image_cache)\n    {\n      var url_creator = window.URL || window.webkitURL;\n      var image_url = url_creator.createObjectURL(self.options.image_cache[image_uri]);\n      self.preview_image.attr('src', image_url);\n      self.preview_image.show();\n      return;\n    }\n\n    if(!self.login_open)\n    {\n      self.login_open = true;\n      var uri = URI(image_uri);\n      self.remotes.get_remote({\n        hostname: uri.hostname(),\n        title: \"Login to \" + uri.hostname(),\n        message: \"Loading \" + uri.pathname(),\n        cancel: function() {\n          self.login_open = false;\n        },\n        success: function(hostname) {\n          var xhr = new XMLHttpRequest();\n          var api = \"/file\";\n\n          // xhr.image = image;\n          //Double encode to avoid cherrypy's auto unencode in the controller\n          xhr.open(\"GET\", api_root + \"remotes/\" + hostname + api + uri.pathname(), true);\n          xhr.responseType = \"arraybuffer\";\n          xhr.onload = function(e) {\n            // If we get 404, the remote session no longer exists because it timed-out.\n            // If we get 500, there was an internal error communicating to the remote host.\n            // Either way, delete the cached session and create a new one.\n            if(this.status == 404 || this.status == 500) {\n              self.remotes.delete_remote(uri.hostname());\n              self._open_images(images);\n              return;\n            }\n            // If we get 400, it means that the session is good and we're\n            // communicating with the remote host, but something else went wrong\n            // (probably file permissions issues).\n            if(this.status == 400) {\n              console.log(this);\n              console.log(this.getAllResponseHeaders());\n              var message = this.getResponseHeader(\"slycat-message\");\n              var hint = this.getResponseHeader(\"slycat-hint\");\n\n              if(message && hint)\n              {\n                window.alert(message + \"\\n\\n\" + hint);\n              }\n              else if(message)\n              {\n                window.alert(message);\n              }\n              else\n              {\n                window.alert(\"Error loading image \" + this.image_uri + \": \" + this.statusText);\n              }\n              return;\n            } else {\n              // We received the image, so put it in the cache and start-over.\n              var array_buffer_view = new Uint8Array(this.response);\n              var blob = new Blob([array_buffer_view], {type:this.getResponseHeader('content-type')});\n              self.options.image_cache[image_uri] = blob;\n              self._display_image(image_uri);\n              return;\n            }\n          }\n\n          xhr.send();\n          self.login_open = false;\n        },\n      })\n    }\n  },\n\n  _close_preview: function(immediate)\n  {\n    var self = this;\n\n    if(immediate)\n    {\n      close_preview();\n    }\n    else\n    {\n      self.hover_timer = window.setTimeout( \n        function(){ \n          close_preview();\n        }, \n        self.options.hover_timeout \n      );\n    }\n\n    function close_preview(){\n      self.target_image = null;\n      self.preview.hide();\n      self.preview_image.hide();\n    }\n\n  },\n\n  _set_color: function()\n  {\n    var self = this;\n\n    this.container.selectAll(\"g.square rect\")\n      .style(\"fill\", function(d, i){\n        var index = d[\"data-table-index\"];\n        if(index != null) {\n          var value = self.options.color_array[index];\n          if(value != null)\n            return self.options.colorscale(value);\n          else\n            return $(\"#color-switcher\").colorswitcher(\"get_null_color\");\n        }\n        else\n          return \"black\";\n      })\n      .classed(\"nullValue\", function(d, i){\n        if (d[\"data-table-index\"] == null || (d[\"data-table-index\"] != null && self.options.color_array[d[\"data-table-index\"]] !== null))\n          return false;\n        else\n          return true;\n      })\n      ;\n  },\n\n  _set_highlight: function()\n  {\n    var self = this;\n\n    var offset = - (self.options.square_size / 2) - (self.options.square_border_size  / 2);\n    var selected_offset = - (self.options.selected_square_size / 2) - (self.options.selected_square_border_size / 2);\n    var trans = \"translate(\" + offset + \", \" + offset + \")\";\n    var trans_selected = \"translate(\" + selected_offset + \", \" + selected_offset + \")\";\n\n    checkChildren(self.root);\n\n    this.container.selectAll(\"g.square\")\n      .classed(\"highlight\", function(d, i){\n        if(d.highlight)\n          return true;\n        else\n          return false;\n      })\n      ;\n\n    this.container.selectAll(\"g.square rect\")\n      .attr(\"width\", function(d){\n        return d.highlight ? self.options.selected_square_size : self.options.square_size;\n      })\n      .attr(\"height\", function(d){\n        return d.highlight ? self.options.selected_square_size : self.options.square_size;\n      })\n      .style(\"stroke-width\", function(d){\n        return d.highlight ? self.options.selected_square_border_size : self.options.square_border_size;\n      })\n      .attr(\"transform\", function(d) { \n        return d.highlight ? trans_selected : trans;  // Move up according to selected or not\n      })\n      ;\n\n    // Checks if target or any of its children are highlighted\n    function checkChildren(target){\n      var highlight = false;\n      if(target.children){\n        for(var i=0; i<target.children.length; i++){\n          if(checkChildren(target.children[i])){\n            highlight = true;\n          }\n        }\n        target.highlight = highlight;\n      }\n      else if(target._children){\n        for(var i=0; i<target._children.length; i++){\n          if(checkChildren(target._children[i])){\n            highlight = true;\n          }\n        }\n        target.highlight = highlight;\n      }\n      else if((target[\"data-table-index\"] != null) && (self.options.highlight.indexOf(target[\"data-table-index\"]) > -1)){\n        target.highlight = true;\n        highlight = true;\n      }\n      else {\n        target.highlight = false;\n        highlight = false;\n      }\n      return highlight;\n    }\n  },\n\n  _handle_highlight: function(d, event, element)\n  {\n    var self = this;\n    var data_table_indexes = getDataTableIndexesFromChildren(d);\n\n    if(!event.ctrlKey && !d3.event.metaKey){\n      self.options.highlight = data_table_indexes;\n    }\n    else {\n      if(d.highlight){\n        for(var i=0; i < data_table_indexes.length; i++){\n          var index = self.options.highlight.indexOf(data_table_indexes[i]);\n          if (index > -1) {\n            self.options.highlight.splice(index, 1);\n          }\n        }\n      }\n      else {\n        for(var i=0; i < data_table_indexes.length; i++){\n          if(self.options.highlight.indexOf(data_table_indexes[i]) == -1)\n            self.options.highlight.push(data_table_indexes[i]);\n        }\n      }\n    }\n    self._set_highlight();\n    self.element.trigger(\"selection-changed\", [self.options.highlight]);\n\n    function getDataTableIndexesFromChildren(target){\n      var data_table_indexes = [];\n      if(target.children){\n        for(var i=0; i<target.children.length; i++){\n          if(target.children[i][\"data-table-index\"] != null)\n            data_table_indexes.push(target.children[i][\"data-table-index\"]);\n          else\n            data_table_indexes = data_table_indexes.concat(getDataTableIndexesFromChildren(target.children[i]));\n        }\n      }\n      else if(target._children){\n        for(var i=0; i<target._children.length; i++){\n          if(target._children[i][\"data-table-index\"] != null)\n            data_table_indexes.push(target._children[i][\"data-table-index\"]);\n          else\n            data_table_indexes = data_table_indexes.concat(getDataTableIndexesFromChildren(target._children[i]));\n        }\n      }\n      else if(target[\"data-table-index\"] != null)\n        data_table_indexes.push(target[\"data-table-index\"]);\n\n      return data_table_indexes;\n    }\n  },\n\n  _set_dendrogram_sort_order_state: function()\n  {\n    var self = this;\n    self.sortControl\n      .attr(\"title\", function(index, attr){return self.options.dendrogram_sort_order ? \"Inputs are sorted in dendrogram order\" : \"Sort inputs in dendrogram order\"})\n      .toggleClass(\"selected\", self.options.dendrogram_sort_order)\n      ;\n  },\n\n  _set_hidden_simulations: function()\n  {\n    //console.log(\"setting hidden simulations in dendrogram\");\n    var self = this;\n\n    var selection = [];\n    \n    update_selected_nodes(self.root, selection);\n    \n    self.options.selected_nodes = self._getNodeIndexes(selection);\n\n    self._style_selected_nodes();\n    self._color_links();\n\n    self.element.trigger(\"node-selection-changed\", {node:null, skip_bookmarking:false, selection:selection});\n\n    function update_selected_nodes(d, selection)\n    {\n      var image_index = d[\"image-index\"];\n      if(image_index != null)\n      {\n        if(self.options.hidden_simulations.indexOf(image_index) > -1)\n        {\n          d.selected = false;\n        }\n        else\n        {\n          d.selected = true;\n          selection.push({\"node-index\" : d[\"node-index\"], \"image-index\" : d[\"image-index\"], \"data-table-index\" : d[\"data-table-index\"]});\n        }\n      }\n      if(d.children)\n        for(var i=0; i<d.children.length; i++)\n          update_selected_nodes(d.children[i], selection);\n      if(d._children)\n        for(var i=0; i<d._children.length; i++)\n          update_selected_nodes(d._children[i], selection);\n    }\n  },\n\n  _style_selected_nodes: function()\n  {\n    var self = this;\n    self.container.selectAll(\".node\")\n      .classed(\"selected\", function(d) { return d.selected; })\n      ;\n\n\n  },\n\n  _color_links: function()\n  {\n    var self = this;\n    self.container.selectAll(\"path.link\").attr(\"style\", function(d){\n      if(checkChildren(d.target)){\n        if(d.source.selected)\n          return \"stroke: black;\"\n        else\n          return \"stroke: #646464;\"\n      }\n    });\n\n    // Checks if target or any of its children are selected\n    function checkChildren(target){\n      if(target.selected)\n        return true;\n      else if(target.children){\n        for(var i=0; i<target.children.length; i++){\n          if(checkChildren(target.children[i]))\n            return true\n        }\n      }\n      else if(target._children){\n        for(var i=0; i<target._children.length; i++){\n          if(checkChildren(target._children[i]))\n            return true\n        }\n      }\n      return false;\n    }\n  },\n\n  _getNodeIndexes: function(nodes)\n  {\n    var node_indexes = [];\n    var node_index = null;\n\n    for(var i=0; i<nodes.length; i++)\n    {\n      node_index = nodes[i][\"node-index\"];\n      if(node_index != null)\n        node_indexes.push(node_index);\n    }\n\n    return node_indexes;\n  },\n\n  resize_canvas: function()\n  {\n    this._set_cluster();\n  },\n\n  _setOption: function(key, value)\n  {\n    //console.log(\"timeseries.dendrogram._setOption()\", key, value);\n    this.options[key] = value;\n\n    if(key == \"cluster_data\")\n    {\n      this._set_cluster();\n    }\n    else if(key == \"color-options\")\n    {\n      this.options.color_array = value.color_array;\n      this.options.colorscale = value.colorscale;\n      this._set_color();\n    }\n    else if(key == \"colorscale\")\n    {\n      this._set_color();\n    }\n    else if(key == \"dendrogram_sort_order\")\n    {\n      this._set_dendrogram_sort_order_state();\n    }\n    else if(key == \"highlight\")\n    {\n      if(value == undefined)\n        this.options.highlight = [];\n      this._set_highlight();\n    }\n    else if(key == \"hidden_simulations\")\n    {\n      this._set_hidden_simulations();\n    }\n    else if(key == \"images\")\n    {\n      // We don't need to do anything when images are updated, because they are always followed by cluster_data, which triggers a refresh\n    }\n  },\n});","/* Copyright (c) 2013, 2018 National Technology and Engineering Solutions of Sandia, LLC . Under the terms of Contract  DE-NA0003525 with National Technology and Engineering Solutions of Sandia, LLC, the U.S. Government  retains certain rights in this software. */\n\n////////////////////////////////////////////////////////////////////////////////////////\n// Slickgrid-based data table widget, for use with the CCA model.\n\nimport api_root from \"js/slycat-api-root\";\nimport d3 from \"js/d3.min\";\nimport \"jquery-ui\";\nimport \"js/jquery.event.drag-2.2\";\nimport \"js/slick.core\";\nimport \"js/slick.grid\";\nimport \"js/slick.rowselectionmodel\";\nimport \"js/slick.headerbuttons\";\nimport \"js/slick.autotooltips\";\nimport * as chunker from \"js/chunker\";\n\n$.widget(\"parameter_image.table\",\n{\n  options:\n  {\n    mid : null,\n    aid : null,\n    metadata : null,\n    statistics : null,\n    inputs : [],\n    outputs : [],\n    others : [],\n    images : [],\n    ratings : [],\n    categories : [],\n    \"row-selection\" : [],\n    \"variable-selection\": [],\n    \"sort-variable\" : null,\n    \"sort-order\" : null,\n    \"image-variable\" : null,\n    \"x-variable\" : null,\n    \"y-variable\" : null,\n    colorscale : null,\n    hidden_simulations : [],\n  },\n\n  _create: function()\n  {\n    var self = this;\n\n    function value_formatter(value)\n    {\n      return value == null ? \"&nbsp;\" : (value + \"\").replace(/&/g,\"&amp;\").replace(/</g,\"&lt;\").replace(/>/g,\"&gt;\");\n    }\n\n    function cell_formatter(row, cell, value, columnDef, dataContext)\n    {\n      if(columnDef.colorscale)\n        return \"<div class='highlightWrapper\" + (value==null ? \" null\" : \"\") + ( d3.hcl(columnDef.colorscale(value)).l > 50 ? \" light\" : \" dark\") + \"' style='background:\" + columnDef.colorscale(value) + \"'>\" + value_formatter(value) + \"</div>\";\n      else if(value==null)\n        return \"<div class='highlightWrapper\" + (value==null ? \" null\" : \"\") + \"'>\" + value_formatter(value) + \"</div>\";\n      return value_formatter(value);\n    }\n\n    function editable_cell_formatter(row, cell, value, columnDef, dataContext)\n    {\n      if(columnDef.colorscale)\n        return \"<div class='highlightWrapper\" + (value==null ? \" null\" : \"\") + ( d3.hcl(columnDef.colorscale(value)).l > 50 ? \" light\" : \" dark\") + \"' style='background:\" + columnDef.colorscale(value) + \"'>\" + value_formatter(value) + \"</div>\";\n      else if(value==null)\n        return \"<div class='highlightWrapper\" + (value==null ? \" null\" : \"\") + \"'>\" + value_formatter(value) + \"</div>\";\n      return value_formatter(value);\n    }\n\n    function set_sort(column, order)\n    {\n      self.data.set_sort(column, order);\n      self.data.get_indices(\"sorted\", self.options[\"row-selection\"], function(sorted_rows)\n      {\n        self.grid.invalidate();\n        self.trigger_row_selection = false;\n        self.grid.setSelectedRows(sorted_rows);\n        self.grid.resetActiveCell();\n        if(sorted_rows.length)\n          self.grid.scrollRowToTop(Math.min.apply(Math, sorted_rows));\n        self.element.trigger(\"variable-sort-changed\", [column, order]);\n      });\n    }\n\n    function make_column(column_index, header_class, cell_class, formatter)\n    {\n      var column = {\n        id : column_index,\n        field : column_index,\n        name : self.options.metadata[\"column-names\"][column_index],\n        toolTip : self.options.metadata[\"column-names\"][column_index],\n        sortable : false,\n        headerCssClass : header_class,\n        cssClass : cell_class,\n        formatter : formatter,\n        width: 100,\n        header :\n        {\n          buttons :\n          [\n            {\n              cssClass : self.options[\"sort-variable\"] == column_index ? (self.options[\"sort-order\"] == \"ascending\" ? \"icon-sort-ascending\" : \"icon-sort-descending\") : \"icon-sort-off\",\n              tooltip : self.options[\"sort-variable\"] == column_index ? (self.options[\"sort-order\"] == \"ascending\" ? \"Sort descending\" : \"Sort ascending\") : \"Sort ascending\",\n              command : self.options[\"sort-variable\"] == column_index ? (self.options[\"sort-order\"] == \"ascending\" ? \"sort-descending\" : \"sort-ascending\") : \"sort-ascending\",\n            },\n          ]\n        }\n      };\n      // Special options for image columns\n      if( self.options.images.indexOf(column_index) > -1 ) {\n        column.headerCssClass += \" headerImage\";\n        column.header.buttons.push(\n          {\n            cssClass : self.options[\"image-variable\"] == column_index ? \"icon-image-on\" : \"icon-image-off\",\n            tooltip :  self.options[\"image-variable\"] == column_index ? \"Current image variable\" : \"Set as image variable\",\n            command :  self.options[\"image-variable\"] == column_index ? \"\" : \"image-on\",\n          }\n        );\n      }\n      // Special options for non-image and non-index columns\n      else if( self.options.metadata[\"column-count\"]-1 != column_index ) {\n        column.headerCssClass += \" headerNumeric\";\n        column.header.buttons.push(\n          {\n            cssClass : self.options[\"x-variable\"] == column_index ? \"icon-x-on\" : \"icon-x-off\",\n            tooltip :  self.options[\"x-variable\"] == column_index ? \"Current x variable\" : \"Set as x variable\",\n            command :  self.options[\"x-variable\"] == column_index ? \"\" : \"x-on\",\n          },\n          {\n            cssClass : self.options[\"y-variable\"] == column_index ? \"icon-y-on\" : \"icon-y-off\",\n            tooltip :  self.options[\"y-variable\"] == column_index ? \"Current y variable\" : \"Set as y variable\",\n            command :  self.options[\"y-variable\"] == column_index ? \"\" : \"y-on\",\n          }\n        );\n      }\n      return column;\n    }\n\n    self.columns = [];\n    \n    self.columns.push(make_column(self.options.metadata[\"column-count\"]-1, \"headerSimId\", \"rowSimId\", cell_formatter));\n    for(var i in self.options.inputs)\n      self.columns.push(make_column(self.options.inputs[i], \"headerInput\", \"rowInput\", cell_formatter));\n    for(var i in self.options.outputs)\n      self.columns.push(make_column(self.options.outputs[i], \"headerOutput\", \"rowOutput\", cell_formatter));\n    for(var i in self.options.ratings)\n      self.columns.push(make_column(self.options.ratings[i], \"headerRating\", \"rowRating\", editable_cell_formatter));\n    for(var i in self.options.categories)\n      self.columns.push(make_column(self.options.categories[i], \"headerCategory\", \"rowCategory\", editable_cell_formatter));\n    for(var i in self.options.others)\n      self.columns.push(make_column(self.options.others[i], \"headerOther\", \"rowOther\", cell_formatter));\n\n    self.data = new self._data_provider({\n      mid : self.options.mid,\n      aid : self.options.aid,\n      metadata : self.options.metadata,\n      sort_column : self.options[\"sort-variable\"],\n      sort_order : self.options[\"sort-order\"],\n      inputs : self.options.inputs,\n      outputs : self.options.outputs,\n      indexOfIndex : self.options.metadata[\"column-count\"]-1,\n      hidden_simulations : self.options.hidden_simulations,\n      });\n\n    self.trigger_row_selection = true;\n\n    self.grid = new Slick.Grid(self.element, self.data, self.columns, {\n      explicitInitialization : true, \n      enableColumnReorder : false, \n      editable : true, \n      editCommandHandler : self._editCommandHandler,\n    });\n\n    self.data.onDataLoaded.subscribe(function (e, args) {\n      for (var i = args.from; i <= args.to; i++) {\n        self.grid.invalidateRow(i);\n      }\n      self.grid.render();\n    });\n\n    var header_buttons = new Slick.Plugins.HeaderButtons();\n    header_buttons.onCommand.subscribe(function(e, args)\n    {\n      var column = args.column;\n      var button = args.button;\n      var command = args.command;\n      var grid = args.grid;\n\n      if(command == \"sort-ascending\" || command == \"sort-descending\"){\n        for(var i in self.columns)\n        {\n          self.columns[i].header.buttons[0].cssClass = \"icon-sort-off\";\n          self.columns[i].header.buttons[0].tooltip = \"Sort ascending\";\n          self.columns[i].header.buttons[0].command = \"sort-ascending\";\n          grid.updateColumnHeader(self.columns[i].id);\n        }\n      }\n\n      if(command == \"sort-ascending\")\n      {\n        button.cssClass = 'icon-sort-ascending';\n        button.command = 'sort-descending';\n        button.tooltip = 'Sort descending';\n        set_sort(column.id, \"ascending\");\n      }\n      else if(command == \"sort-descending\")\n      {\n        button.cssClass = 'icon-sort-descending';\n        button.command = 'sort-ascending';\n        button.tooltip = 'Sort ascending';\n        set_sort(column.id, \"descending\");\n      }\n      else if(command == \"image-on\")\n      {\n        for(var i=0; i < self.options.images.length; i++)\n        {\n          var index = grid.getColumnIndex(self.options.images[i]);\n          self.columns[index].header.buttons[1].cssClass = \"icon-image-off\";\n          self.columns[index].header.buttons[1].tooltip = \"Set as image variable\";\n          self.columns[index].header.buttons[1].command = \"image-on\";\n          grid.updateColumnHeader(self.columns[index].id);\n        }\n        button.cssClass = 'icon-image-on';\n        button.command = '';\n        button.tooltip = 'Current image variable';\n        self.element.trigger(\"images-selection-changed\", column.id);\n      }\n      else if(command == \"x-on\")\n      {\n        for(var i in self.columns)\n        {\n          if(self.options.images.indexOf(self.columns[i].id) == -1 && self.options.metadata[\"column-count\"]-1 != self.columns[i].id){\n            self.columns[i].header.buttons[1].cssClass = \"icon-x-off\";\n            self.columns[i].header.buttons[1].tooltip = \"Set as x variable\";\n            self.columns[i].header.buttons[1].command = \"x-on\";\n            grid.updateColumnHeader(self.columns[i].id);\n          }\n        }\n        button.cssClass = 'icon-x-on';\n        button.command = '';\n        button.tooltip = 'Current x variable';\n        self.element.trigger(\"x-selection-changed\", column.id);\n      }\n      else if(command == \"y-on\")\n      {\n        for(var i in self.columns)\n        {\n          if(self.options.images.indexOf(self.columns[i].id) == -1 && self.options.metadata[\"column-count\"]-1 != self.columns[i].id){\n            self.columns[i].header.buttons[2].cssClass = \"icon-y-off\";\n            self.columns[i].header.buttons[2].tooltip = \"Set as y variable\";\n            self.columns[i].header.buttons[2].command = \"y-on\";\n            grid.updateColumnHeader(self.columns[i].id);\n          }\n        }\n        button.cssClass = 'icon-y-on';\n        button.command = '';\n        button.tooltip = 'Current y variable';\n        self.element.trigger(\"y-selection-changed\", column.id);\n      }\n    });\n\n    self.grid.registerPlugin(header_buttons);\n    self.grid.registerPlugin(new Slick.AutoTooltips({enableForHeaderCells:true}));\n\n    self.grid.setSelectionModel(new Slick.RowSelectionModel());\n    self.grid.onSelectedRowsChanged.subscribe(function(e, selection)\n    {\n      // Don't trigger a selection event unless the selection was changed by user interaction (i.e. not outside callers or changing the sort order).\n      if(self.trigger_row_selection)\n      {\n        self.data.get_indices(\"unsorted\", selection.rows, function(unsorted_rows)\n        {\n          self.options[\"row-selection\"] = unsorted_rows;\n          self.element.trigger(\"row-selection-changed\", [unsorted_rows]);\n        });\n      }\n      self.trigger_row_selection = true;\n    });\n    self.grid.onHeaderClick.subscribe(function (e, args)\n    {\n      if( !self._array_equal([args.column.field], self.options[\"variable-selection\"]) && \n          self.options.images.indexOf(args.column.field) == -1\n        )\n      {\n        self.options[\"variable-selection\"] = [args.column.field];\n        self.element.trigger(\"variable-selection-changed\", [self.options[\"variable-selection\"]]);\n      }\n    });\n\n    self._color_variables(self.options[\"variable-selection\"]);\n\n    self.grid.init();\n\n    self.data.get_indices(\"sorted\", self.options[\"row-selection\"], function(sorted_rows)\n    {\n      self.trigger_row_selection = false;\n      self.grid.setSelectedRows(sorted_rows);\n      self.grid.resetActiveCell();\n      if(sorted_rows.length)\n        self.grid.scrollRowToTop(Math.min.apply(Math, sorted_rows));\n    });\n  },\n\n  resize_canvas: function()\n  {\n    var self = this;\n    self.grid.resizeCanvas();\n  },\n\n  update_data: function()\n  {\n    var self = this;\n    self.data.invalidate();\n    self.grid.invalidate();\n    self.data.get_indices(\"sorted\", self.options[\"row-selection\"], function(sorted_rows)\n    {\n      self.trigger_row_selection = false;\n      self.grid.setSelectedRows(sorted_rows);\n      self.grid.resetActiveCell();\n      if(sorted_rows.length)\n        self.grid.scrollRowToTop(Math.min.apply(Math, sorted_rows));\n    });\n  },\n\n  _setOption: function(key, value)\n  {\n    var self = this;\n\n    if(key == \"row-selection\")\n    {\n      // Unexpectedly at this point self.options[key] has already been set to value, so this always returns even when the row-selection is unique\n      // if(self._array_equal(self.options[key], value))\n      //   return;\n\n      self.options[key] = value;\n      self.data.get_indices(\"sorted\", value, function(sorted_rows)\n      {\n        self.trigger_row_selection = false;\n        self.grid.setSelectedRows(sorted_rows);\n        self.grid.resetActiveCell();\n        if(sorted_rows.length)\n          self.grid.scrollRowToTop(Math.min.apply(Math, sorted_rows));\n      });\n    }\n    else if(key == \"variable-selection\")\n    {\n      if(self._array_equal(self.options[key], value))\n        return;\n\n      self.options[key] = value;\n      self._color_variables(value);\n    }\n    else if(key == \"colorscale\")\n    {\n      self.options[key] = value;\n      self._color_variables(self.options[\"variable-selection\"]);\n    }\n    else if(key == \"x-variable\")\n    {\n      self.options[key] = value;\n      self._set_selected_x();\n    }\n    else if(key == \"y-variable\")\n    {\n      self.options[key] = value;\n      self._set_selected_y();\n    }\n    else if(key == \"image-variable\")\n    {\n      self.options[key] = value;\n      self._set_selected_image();\n    }\n    else if(key == \"metadata\")\n    {\n      self.options[key] = value;\n      self._color_variables(self.options[\"variable-selection\"]);\n    }\n    else if(key == \"statistics\")\n    {\n      self.options[key] = value;\n      self._color_variables(self.options[\"variable-selection\"]);\n    }\n    else if(key == \"hidden_simulations\")\n    {\n      self.options[key] = value;\n      self.data.invalidate();\n      self.grid.invalidate();\n    }\n  },\n\n  _set_selected_x: function()\n  {\n    var self = this;\n    for(var i in self.columns)\n    {\n      if(self.options.images.indexOf(self.columns[i].id) == -1 && self.options.metadata[\"column-count\"]-1 != self.columns[i].id){\n        if( self.columns[i].id == self.options[\"x-variable\"]){\n          self.columns[i].header.buttons[1].cssClass = \"icon-x-on\";\n          self.columns[i].header.buttons[1].tooltip = \"Current x variable\";\n          self.columns[i].header.buttons[1].command = \"\";\n        } else {\n          self.columns[i].header.buttons[1].cssClass = \"icon-x-off\";\n          self.columns[i].header.buttons[1].tooltip = \"Set as x variable\";\n          self.columns[i].header.buttons[1].command = \"x-on\";\n        }\n        self.grid.updateColumnHeader(self.columns[i].id);\n      }\n    }\n  },\n\n  _set_selected_y: function()\n  {\n    var self = this;\n    for(var i in self.columns)\n    {\n      if(self.options.images.indexOf(self.columns[i].id) == -1 && self.options.metadata[\"column-count\"]-1 != self.columns[i].id){\n        if( self.columns[i].id == self.options[\"y-variable\"]){\n          self.columns[i].header.buttons[2].cssClass = \"icon-y-on\";\n          self.columns[i].header.buttons[2].tooltip = \"Current y variable\";\n          self.columns[i].header.buttons[2].command = \"\";\n        } else {\n          self.columns[i].header.buttons[2].cssClass = \"icon-y-off\";\n          self.columns[i].header.buttons[2].tooltip = \"Set as y variable\";\n          self.columns[i].header.buttons[2].command = \"y-on\";\n        }\n        self.grid.updateColumnHeader(self.columns[i].id);\n      }\n    }\n  },\n\n  _set_selected_image: function()\n  {\n    var self = this;\n    for(var i=0; i < self.options.images.length; i++)\n    {\n      var index = self.grid.getColumnIndex(self.options.images[i]);\n      if(self.columns[index].id == self.options[\"image-variable\"]){\n        self.columns[index].header.buttons[1].cssClass = \"icon-image-on\";\n        self.columns[index].header.buttons[1].tooltip = \"Current image variable\";\n        self.columns[index].header.buttons[1].command = \"\";\n      } else {\n        self.columns[index].header.buttons[1].cssClass = \"icon-image-off\";\n        self.columns[index].header.buttons[1].tooltip = \"Set as image variable\";\n        self.columns[index].header.buttons[1].command = \"image-on\";\n      }\n      self.grid.updateColumnHeader(self.columns[index].id);\n    }\n  },\n\n  _color_variables: function(variables)\n  {\n    var self = this;\n\n    var columns = self.grid.getColumns();\n    for(var i in columns)\n    {\n      var column = columns[i];\n      if(self.options.colorscale !== null && $.inArray(column.id, variables) != -1)\n      {\n        column.colorscale = self.options.colorscale;\n        column.cssClass = column.cssClass.split(\" \")[0] + \" highlight\";\n      }\n      else\n      {\n        column.colorscale = null;\n        column.cssClass = column.cssClass.split(\" \")[0];\n      }\n    }\n    self.grid.invalidate();\n  },\n\n  _editCommandHandler: function (item,column,editCommand) {\n    console.log(\"editCommandHandler called\");\n    editCommand.execute();\n    // To Do: Attempt to save edit and undo it if Ajax call returns error\n    //editCommand.undo();\n  },\n\n  _data_provider: function(parameters)\n  {\n    var self = this;\n\n    self.mid = parameters.mid;\n    self.aid = parameters.aid;\n    self.metadata = parameters.metadata;\n    self.sort_column = parameters.sort_column;\n    self.sort_order = parameters.sort_order;\n    self.inputs = parameters.inputs;\n    self.outputs = parameters.outputs;\n    self.analysis_columns = self.inputs.concat(self.outputs);\n    self.indexOfIndex = parameters.indexOfIndex;\n    self.hidden_simulations = parameters.hidden_simulations;\n    self.ranked_indices = {};\n\n    self.pages = {};\n    self.pages_in_progress = {};\n    self.page_size = 50;\n\n    self.onDataLoaded = new Slick.Event();\n\n    self.getLength = function()\n    {\n      return self.metadata[\"row-count\"];\n    }\n\n    self.getItem = function(index)\n    {\n      var column_begin = 0;\n      var column_end = self.metadata[\"column-count\"];\n      var page = Math.floor(index / self.page_size);\n      var page_begin = page * self.page_size;\n\n      if(self.pages_in_progress[page])\n      {\n        return null;\n      }\n\n      if(!(page in self.pages))\n      {\n        self.pages_in_progress[page] = true;\n        var row_begin = page_begin;\n        var row_end = (page + 1) * self.page_size;\n\n        var sort = \"\";\n        if(self.sort_column !== null && self.sort_order !== null)\n        {\n          var sort_column = \"a\" + self.sort_column;\n          var sort_order = self.sort_order;\n          if(sort_order == 'ascending')\n          {\n            sort_order = 'asc';\n          }\n          else if(sort_order == 'descending')\n          {\n            sort_order = 'desc';\n          }\n          if(self.sort_column == self.metadata[\"column-count\"]-1)\n            sort_column = \"index(0)\";\n          sort = \"/order: rank(\" + sort_column + ', \"' + sort_order + '\")';\n        }\n\n        $.ajax(\n        {\n          type : \"GET\",\n          url : api_root + \"models/\" + self.mid + \"/arraysets/\" + self.aid + \"/data?hyperchunks=0/\" + column_begin + \":\" + (column_end - 1) + \"|index(0)\" + sort + \"/\" + row_begin + \":\" + row_end,\n          success : function(data)\n          {\n            self.pages[page] = [];\n            for(var i=0; i < data[0].length; i++)\n            {\n              var result = {};\n              for(var j = column_begin; j != column_end; ++j)\n              {\n                result[j] = data[j][i];\n              }\n              self.pages[page].push(result);\n            }\n            self.pages_in_progress[page] = false;\n            self.onDataLoaded.notify({from: row_begin, to: row_end});\n          },\n          error: function(request, status, reason_phrase)\n          {\n            console.log(\"error\", request, status, reason_phrase);\n          }\n        });\n        return null;\n      }\n\n      return self.pages[page][index - page_begin];\n    }\n\n    self.getItemMetadata = function(index)\n    {\n      var page = Math.floor(index / self.page_size);\n      if((self.pages_in_progress[page]) || !(page in self.pages))\n      {\n        return null;\n      }\n\n      var row = this.getItem(index);\n      var column_end = self.analysis_columns.length;\n      var cssClasses = \"\";\n      for(var i=0; i != column_end; i++) {\n        if(row[ self.analysis_columns[i] ]==null) {\n          cssClasses += \"nullRow \";\n        }\n      }\n      if( $.inArray( row[self.indexOfIndex], self.hidden_simulations ) != -1 ) {\n        cssClasses += \"hiddenRow \";\n      }\n      if(cssClasses != \"\")\n        return {\"cssClasses\" : cssClasses};\n      return null;\n    }\n\n    self.set_sort = function(column, order)\n    {\n      if(column == self.sort_column && order == self.sort_order)\n        return;\n      self.sort_column = column;\n      self.sort_order = order;\n      self.pages = {};\n    }\n\n    self.get_indices = function(direction, rows, callback)\n    {\n      if(rows.length == 0)\n      {\n        callback([]);\n        return;\n      }\n      // We have no sort column or order, so just returning the same rows as were asked for since they're in the same order\n      if(self.sort_column == null || self.sort_order == null)\n      {\n        callback(rows);\n      }\n      else\n      {\n        if(self.ranked_indices[self.sort_column])\n        {\n          // we have data for this column, so figure out what to return\n          var indices = self.ranked_indices[self.sort_column];\n          // Reverse response indexes for descending sort order\n          if(self.sort_order == 'descending')\n          {\n            var plain_array = [];\n            for(var i=0; i<indices.length; i++)\n            {\n              plain_array.push(indices[i]);\n            }\n            indices = plain_array.reverse();\n          }\n          var response = []; \n          for(var i=0; i<rows.length; i++)\n          {\n            if(direction == \"unsorted\")\n            {\n              response.push( indices[ rows[i] ] );\n            }\n            else if(direction == \"sorted\")\n            {\n              response.push( indices.indexOf(rows[i]) );\n            }\n          }\n          callback(new Int32Array(response));\n        }\n        else\n        {\n          if( self.sort_column == self.metadata[\"column-count\"]-1 )\n          {\n            // we are sorting by the index column, so we can just make the data we need.\n            self.ranked_indices[self.sort_column] = new Int32Array( d3.range(self.metadata[\"row-count\"]) );\n            self.get_indices(direction, rows, callback);\n          }\n          else\n          {\n            // we have no data for this column, so go retrieve it and call this function again.\n            var request = new XMLHttpRequest();\n            request.open(\"GET\", api_root + \"models/\" + self.mid + \"/arraysets/data-table/data?hyperchunks=0/rank(a\" + self.sort_column + ',\"asc\")/...&byteorder=' + (chunker.is_little_endian() ? \"little\" : \"big\") );\n            request.responseType = \"arraybuffer\";\n            request.direction = direction;\n            request.rows = rows;\n            request.callback = callback;\n            request.onload = function(e)\n            {\n              var indices = [];\n              var data = new Int32Array(this.response);\n              // Filtering out every other element in the reponse array, because it's full of extraneous 0 (zeros) for some reason.\n              // Need to figure out why, but this is a fix for now.\n              for(var i=0; i<data.length; i=i+2)\n              {\n                indices.push(data[i]);\n              }\n              self.ranked_indices[self.sort_column] = new Int32Array(indices);\n              self.get_indices(this.direction, this.rows, this.callback);\n            }\n            request.send();\n          }\n        }\n      }\n    }\n\n    self.invalidate = function()\n    {\n      self.pages = {};\n\n    }\n  },\n\n  _array_equal: function(a, b)\n  {\n    return $(a).not(b).length == 0 && $(b).not(a).length == 0;\n  },\n});","/* Copyright (c) 2013, 2018 National Technology and Engineering Solutions of Sandia, LLC . Under the terms of Contract  DE-NA0003525 with National Technology and Engineering Solutions of Sandia, LLC, the U.S. Government  retains certain rights in this software. */\n\nimport d3 from \"js/d3.min\";\nimport \"jquery-ui\";\n\n$.widget(\"slycat.colorswitcher\",\n{\n  options:\n  {\n    colormap : \"day\",\n  },\n\n  _create: function()\n  {\n    var self = this;\n\n    this.color_maps =\n    {\n      \"night\":\n      {\n        \"label\": \"Night\",\n        \"background\": d3.rgb(128, 128, 128),\n        \"null_color\": \"rgb(75,75,75)\",\n        \"opacity\": \"0.5\",\n        \"colors\":\n        [\n          d3.rgb( 59,  76, 192),\n          d3.rgb( 68,  90, 204),\n          d3.rgb( 77, 104, 215),\n          d3.rgb( 87, 117, 225),\n          d3.rgb( 98, 130, 234),\n          d3.rgb(108, 142, 241),\n          d3.rgb(119, 154, 247),\n          d3.rgb(130, 165, 251),\n          d3.rgb(141, 176, 254),\n          d3.rgb(152, 185, 255),\n          d3.rgb(163, 194, 255),\n          d3.rgb(174, 201, 253),\n          d3.rgb(184, 208, 249),\n          d3.rgb(194, 213, 244),\n          d3.rgb(204, 217, 238),\n          d3.rgb(213, 219, 230),\n          d3.rgb(221, 221, 221),\n          d3.rgb(229, 216, 209),\n          d3.rgb(236, 211, 197),\n          d3.rgb(241, 204, 185),\n          d3.rgb(245, 196, 173),\n          d3.rgb(247, 187, 160),\n          d3.rgb(247, 177, 148),\n          d3.rgb(247, 166, 135),\n          d3.rgb(244, 154, 123),\n          d3.rgb(241, 141, 111),\n          d3.rgb(236, 127,  99),\n          d3.rgb(229, 112,  88),\n          d3.rgb(222,  96,  77),\n          d3.rgb(213,  80,  66),\n          d3.rgb(203,  62,  56),\n          d3.rgb(192,  40,  47),\n          d3.rgb(180,   4,  38),\n        ]\n      },\n    \"day\":\n      {\n        \"label\": \"Day\",\n        \"background\": d3.rgb(255, 255, 255),\n        \"null_color\": \"gray\",\n        \"opacity\": \"0.7\",\n        \"colors\":\n        [\n          d3.rgb(100, 108, 234),\n          d3.rgb(115, 118, 240),\n          d3.rgb(128, 128, 244),\n          d3.rgb(140, 138, 248),\n          d3.rgb(151, 147, 250),\n          d3.rgb(161, 155, 251),\n          d3.rgb(169, 163, 251),\n          d3.rgb(177, 170, 250),\n          d3.rgb(184, 177, 248),\n          d3.rgb(189, 182, 245),\n          d3.rgb(193, 187, 241),\n          d3.rgb(197, 191, 236),\n          d3.rgb(199, 194, 230),\n          d3.rgb(200, 196, 224),\n          d3.rgb(201, 198, 216),\n          d3.rgb(200, 199, 208),\n          d3.rgb(198, 198, 198),\n          d3.rgb(210, 197, 195),\n          d3.rgb(220, 194, 192),\n          d3.rgb(229, 191, 187),\n          d3.rgb(236, 186, 181),\n          d3.rgb(243, 181, 175),\n          d3.rgb(248, 175, 168),\n          d3.rgb(251, 168, 160),\n          d3.rgb(254, 159, 152),\n          d3.rgb(255, 150, 143),\n          d3.rgb(255, 140, 133),\n          d3.rgb(253, 129, 123),\n          d3.rgb(250, 117, 112),\n          d3.rgb(246, 105, 101),\n          d3.rgb(240,  91,  90),\n          d3.rgb(233,  75,  78),\n          d3.rgb(225,  57,  66),\n        ]\n      },\n    \"rainbow\":\n      {\n        \"label\": \"Rainbow Night\",\n        \"background\": d3.rgb(128, 128, 128),\n        \"null_color\": \"rgb(75,75,75)\",\n        \"opacity\": \"0.6\",\n        \"colors\":\n        [\n          d3.rgb(0, 0, 255),\n          d3.rgb(0, 255, 255),\n          d3.rgb(255, 255, 0),\n          d3.rgb(255, 0, 0),\n        ]\n      },\n    \"rainbow_day\":\n      {\n        \"label\": \"Rainbow Day\",\n        \"background\": d3.rgb(255, 255, 255),\n        \"null_color\": \"gray\",\n        \"opacity\": \"0.7\",\n        \"colors\":\n        [\n          d3.rgb(0, 0, 255),\n          d3.rgb(0, 255, 255),\n          d3.rgb(255, 255, 0),\n          d3.rgb(255, 0, 0),\n        ]\n      },\n    };\n\n    this.container = $(\"<div>\")\n      .appendTo(this.element)\n      .append('<span class=\"label\">Colors: </span>')\n      ;\n    $.each(this.color_maps, function(key, value)\n    {\n      var button = $(\"<span>\")\n        .addClass(\"color\")\n        .toggleClass(\"selected\", key == self.options.colormap)\n        .appendTo(self.container)\n        .attr(\"data-colormap\", key)\n        .html(value.label)\n        .click(function()\n        {\n          if($(this).hasClass(\"selected\"))\n            return;\n\n          self.options.colormap = this.getAttribute(\"data-colormap\");\n          self.container.find(\".color\").removeClass(\"selected\");\n          $(this).addClass(\"selected\");\n\n          self.element.trigger(\"colormap-changed\", [self.options.colormap]);\n        })\n        ;\n    });\n  },\n\n  _setOption: function(key, value)\n  {\n    //console.log(\"slycat.colorswitcher._setOption()\", key, value);\n    this.options[key] = value;\n\n    if(key == \"colormap\")\n    {\n      this.container.find(\".color\").removeClass(\"selected\");\n      this.container.find(\"[data-colormap='\" + this.options.colormap + \"']\").addClass(\"selected\");\n    }\n  },\n\n  // Return a d3 rgb object with the suggested background color for the given color map.\n  get_background: function(name)\n  {\n    if(name === undefined)\n      name = this.options.colormap;\n    return this.color_maps[name].background;\n  },\n\n  // Return the null color value for the given color map.\n  get_null_color: function(name)\n  {\n    if(name === undefined)\n      name = this.options.colormap;\n    return this.color_maps[name][\"null_color\"];\n  },\n\n  // Return the suggested opacity value for the given color map.\n  get_opacity: function(name)\n  {\n    if(name === undefined)\n      name = this.options.colormap;\n    return this.color_maps[name].opacity;\n  },\n\n  // Return a d3 linear color scale with the current color map for the domain [0, 1].\n  // Callers should modify the domain by passing a min and max to suit their own needs.  \n  get_color_scale: function(name, min, max)\n  {\n    if(name === undefined)\n      name = this.options.colormap;\n    if(min === undefined)\n      min = 0.0;\n    if(max === undefined)\n      max = 1.0;\n    var domain = []\n    var domain_scale = d3.scale.linear()\n      .domain([0, this.color_maps[name].colors.length-1])\n      .range([min, max]);\n    for(var i in this.color_maps[name].colors)\n      domain.push(domain_scale(i));\n    return d3.scale.linear().domain(domain).range(this.color_maps[name].colors);\n  },\n\n  // Deprecated\n  get_color_map: function(name, min, max)\n  {\n    return this.get_color_scale(name, min, max);\n  },\n\n  // Return a d3 ordinal color scale with the current color map for the domain [0, 1].\n  // Callers should modify the domain by passing an array of values to suit their own needs. \n  get_color_scale_ordinal: function(name, values)\n  {\n    if(name === undefined)\n      name = this.options.colormap;\n    if(values === undefined)\n      values = [0, 1];\n\n    var tempOrdinal = d3.scale.ordinal().domain(values).rangePoints([0, 100], 0);\n    var tempColorscale = this.get_color_scale(name, 0, 100);\n    var rgbRange = [];\n    for(var i=0; i<values.length; i++)\n    {\n      rgbRange.push( tempColorscale( tempOrdinal(values[i]) ) );\n    }\n    return d3.scale.ordinal().domain(values).range(rgbRange);\n  },\n\n  // Deprecated\n  get_color_map_ordinal: function(name, values)\n  {\n    return this.get_color_scale_ordinal(name, values);\n  },\n\n  get_gradient_data: function(name)\n  {\n    var self = this;\n\n    if(name === undefined)\n      name = this.options.colormap;\n\n    var colors = self.color_maps[name][\"colors\"];\n    var length = colors.length;\n    var data = [];\n    for(var i=0; i < length; i++){\n      data.push({offset: i*(100/(length-1)), color: colors[length-1-i],});\n    }\n    return data;\n  },\n\n  setUpColorMapsForAllColumns: function(name, columns)\n  {\n    for(var j = 0; j != columns.length; ++j)\n    {\n      columns[j].colorMap = this.get_color_scale(name, columns[j].columnMin, columns[j].columnMax);\n    }\n  }\n});"],"sourceRoot":""}