<div class="bootstrap-styles" style="-webkit-flex:1;flex:1;display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;-webkit-justify-content:center;justify-content:center;padding:12px;">
  <div class="form-group">
    <input type="file" id="file"></input>
    <button class="btn btn-default" id="upload">Upload</button>
  </div>

  <script type="text/javascript">
    require(["slycat-web-client"], function(client)
    {
      function create_project()
      {
        client.post_projects({
          name: "Multipart Upload Demo",
          success: function(pid)
          {
            console.log("Project created.");
            create_model(pid);
          }
        });
      }

      function create_model(pid)
      {
        client.post_project_models({
          name: "Multipart Upload Demo",
          type: "generic",
          pid: pid,
          success: function(mid)
          {
            console.log("Model created.");
            start_upload(pid, mid);
          }
        });
      }

      function start_upload(pid, mid)
      {
        client.post_uploads({
          mid: mid,
          input: true,
          parser: "slycat-blob-parser",
          aids: ["foo"],
          success: function(uid)
          {
            console.log("Upload session created.");
            upload_file(pid, mid, uid);
          }
        });
      }

      function upload_file(pid, mid, uid)
      {
        file = document.getElementById("file").files[0];
        console.log("Upload file", file);
        client.put_upload_file_part({
          uid: uid,
          fid: 0,
          pid: 0,
          file: file,
          success: function()
          {
            finish_upload(pid, mid, uid);
          }
        });
      }

      function finish_upload(pid, mid, uid)
      {
        client.delete_upload({
          uid: uid,
          success: function()
          {
            console.log("Upload session deleted.");
            delete_project(pid);
          }
        });
      }

      function delete_project(pid)
      {
        client.delete_project({
          pid: pid,
          success: function()
          {
            console.log("Project deleted.");
          }
        });
      }

      document.getElementById("upload").addEventListener("click", create_project, false);

    });
  </script>
</div>
